(function(){var e=this,t=e._,n={},i=Array.prototype,s=Object.prototype,o=Function.prototype,r=i.push,a=i.slice,l=i.concat,c=s.toString,d=s.hasOwnProperty,u=i.forEach,h=i.map,p=i.reduce,f=i.reduceRight,v=i.filter,m=i.every,g=i.some,b=i.indexOf,y=i.lastIndexOf,w=Array.isArray,_=Object.keys,x=o.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.6.0";var S=k.each=k.forEach=function(e,t,i){if(null==e)return e;if(u&&e.forEach===u)e.forEach(t,i);else if(e.length===+e.length){for(var s=0,o=e.length;o>s;s++)if(t.call(i,e[s],s,e)===n)return}else for(var r=k.keys(e),s=0,o=r.length;o>s;s++)if(t.call(i,e[r[s]],r[s],e)===n)return;return e};k.map=k.collect=function(e,t,n){var i=[];return null==e?i:h&&e.map===h?e.map(t,n):(S(e,function(e,s,o){i.push(t.call(n,e,s,o))}),i)};var C="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,n,i){var s=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return i&&(t=k.bind(t,i)),s?e.reduce(t,n):e.reduce(t);if(S(e,function(e,o,r){s?n=t.call(i,n,e,o,r):(n=e,s=!0)}),!s)throw new TypeError(C);return n},k.reduceRight=k.foldr=function(e,t,n,i){var s=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=k.bind(t,i)),s?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var r=k.keys(e);o=r.length}if(S(e,function(a,l,c){l=r?r[--o]:--o,s?n=t.call(i,n,e[l],l,c):(n=e[l],s=!0)}),!s)throw new TypeError(C);return n},k.find=k.detect=function(e,t,n){var i;return T(e,function(e,s,o){return t.call(n,e,s,o)?(i=e,!0):void 0}),i},k.filter=k.select=function(e,t,n){var i=[];return null==e?i:v&&e.filter===v?e.filter(t,n):(S(e,function(e,s,o){t.call(n,e,s,o)&&i.push(e)}),i)},k.reject=function(e,t,n){return k.filter(e,function(e,i,s){return!t.call(n,e,i,s)},n)},k.every=k.all=function(e,t,i){t||(t=k.identity);var s=!0;return null==e?s:m&&e.every===m?e.every(t,i):(S(e,function(e,o,r){return(s=s&&t.call(i,e,o,r))?void 0:n}),!!s)};var T=k.some=k.any=function(e,t,i){t||(t=k.identity);var s=!1;return null==e?s:g&&e.some===g?e.some(t,i):(S(e,function(e,o,r){return s||(s=t.call(i,e,o,r))?n:void 0}),!!s)};k.contains=k.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):T(e,function(e){return e===t})},k.invoke=function(e,t){var n=a.call(arguments,2),i=k.isFunction(t);return k.map(e,function(e){return(i?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,k.property(t))},k.where=function(e,t){return k.filter(e,k.matches(t))},k.findWhere=function(e,t){return k.find(e,k.matches(t))},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var i=-1/0,s=-1/0;return S(e,function(e,o,r){var a=t?t.call(n,e,o,r):e;a>s&&(i=e,s=a)}),i},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var i=1/0,s=1/0;return S(e,function(e,o,r){var a=t?t.call(n,e,o,r):e;s>a&&(i=e,s=a)}),i},k.shuffle=function(e){var t,n=0,i=[];return S(e,function(e){t=k.random(n++),i[n-1]=i[t],i[t]=e}),i},k.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=k.values(e)),e[k.random(e.length-1)]):k.shuffle(e).slice(0,Math.max(0,t))};var E=function(e){return null==e?k.identity:k.isFunction(e)?e:k.property(e)};k.sortBy=function(e,t,n){return t=E(t),k.pluck(k.map(e,function(e,i,s){return{value:e,index:i,criteria:t.call(n,e,i,s)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var A=function(e){return function(t,n,i){var s={};return n=E(n),S(t,function(o,r){var a=n.call(i,o,r,t);e(s,a,o)}),s}};k.groupBy=A(function(e,t,n){k.has(e,t)?e[t].push(n):e[t]=[n]}),k.indexBy=A(function(e,t,n){e[t]=n}),k.countBy=A(function(e,t){k.has(e,t)?e[t]++:e[t]=1}),k.sortedIndex=function(e,t,n,i){n=E(n);for(var s=n.call(i,t),o=0,r=e.length;r>o;){var a=o+r>>>1;n.call(i,e[a])<s?o=a+1:r=a}return o},k.toArray=function(e){return e?k.isArray(e)?a.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:a.call(e,0,t)},k.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var F=function(e,t,n){return t&&k.every(e,k.isArray)?l.apply(n,e):(S(e,function(e){k.isArray(e)||k.isArguments(e)?t?r.apply(n,e):F(e,t,n):n.push(e)}),n)};k.flatten=function(e,t){return F(e,t,[])},k.without=function(e){return k.difference(e,a.call(arguments,1))},k.partition=function(e,t,n){t=E(t);var i=[],s=[];return S(e,function(e){(t.call(n,e)?i:s).push(e)}),[i,s]},k.uniq=k.unique=function(e,t,n,i){k.isFunction(t)&&(i=n,n=t,t=!1);var s=n?k.map(e,n,i):e,o=[],r=[];return S(s,function(n,i){(t?i&&r[r.length-1]===n:k.contains(r,n))||(r.push(n),o.push(e[i]))}),o},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(e){var t=a.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.contains(t,e)})})},k.difference=function(e){var t=l.apply(i,a.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=k.max(k.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=k.pluck(arguments,""+n);return t},k.object=function(e,t){if(null==e)return{};for(var n={},i=0,s=e.length;s>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var i=0,s=e.length;if(n){if("number"!=typeof n)return i=k.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,s+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;s>i;i++)if(e[i]===t)return i;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(y&&e.lastIndexOf===y)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var s=i?n:e.length;s--;)if(e[s]===t)return s;return-1},k.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),s=0,o=new Array(i);i>s;)o[s++]=e,e+=n;return o};var N=function(){};k.bind=function(e,t){var n,i;if(x&&e.bind===x)return x.apply(e,a.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(a.call(arguments)));N.prototype=e.prototype;var s=new N;N.prototype=null;var o=e.apply(s,n.concat(a.call(arguments)));return Object(o)===o?o:s}},k.partial=function(e){var t=a.call(arguments,1);return function(){for(var n=0,i=t.slice(),s=0,o=i.length;o>s;s++)i[s]===k&&(i[s]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return e.apply(this,i)}},k.bindAll=function(e){var t=a.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return S(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var i=t.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},k.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(a.call(arguments,1)))},k.throttle=function(e,t,n){var i,s,o,r=null,a=0;n||(n={});var l=function(){a=n.leading===!1?0:k.now(),r=null,o=e.apply(i,s),i=s=null};return function(){var c=k.now();a||n.leading!==!1||(a=c);var d=t-(c-a);return i=this,s=arguments,0>=d?(clearTimeout(r),r=null,a=c,o=e.apply(i,s),i=s=null):r||n.trailing===!1||(r=setTimeout(l,d)),o}},k.debounce=function(e,t,n){var i,s,o,r,a,l=function(){var c=k.now()-r;t>c?i=setTimeout(l,t-c):(i=null,n||(a=e.apply(o,s),o=s=null))};return function(){o=this,s=arguments,r=k.now();var c=n&&!i;return i||(i=setTimeout(l,t)),c&&(a=e.apply(o,s),o=s=null),a}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return k.partial(t,e)},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=function(e){if(!k.isObject(e))return[];if(_)return _(e);var t=[];for(var n in e)k.has(e,n)&&t.push(n);return t},k.values=function(e){for(var t=k.keys(e),n=t.length,i=new Array(n),s=0;n>s;s++)i[s]=e[t[s]];return i},k.pairs=function(e){for(var t=k.keys(e),n=t.length,i=new Array(n),s=0;n>s;s++)i[s]=[t[s],e[t[s]]];return i},k.invert=function(e){for(var t={},n=k.keys(e),i=0,s=n.length;s>i;i++)t[e[n[i]]]=n[i];return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return S(a.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=l.apply(i,a.call(arguments,1));return S(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=l.apply(i,a.call(arguments,1));for(var s in e)k.contains(n,s)||(t[s]=e[s]);return t},k.defaults=function(e){return S(a.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var M=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var s=c.call(e);if(s!=c.call(t))return!1;switch(s){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return i[o]==t;var r=e.constructor,a=t.constructor;if(r!==a&&!(k.isFunction(r)&&r instanceof r&&k.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),i.push(t);var l=0,d=!0;if("[object Array]"==s){if(l=e.length,d=l==t.length)for(;l--&&(d=M(e[l],t[l],n,i)););}else{for(var u in e)if(k.has(e,u)&&(l++,!(d=k.has(t,u)&&M(e[u],t[u],n,i))))break;if(d){for(u in t)if(k.has(t,u)&&!l--)break;d=!l}}return n.pop(),i.pop(),d};k.isEqual=function(e,t){return M(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=w||function(e){return"[object Array]"==c.call(e)},k.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return d.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.constant=function(e){return function(){return e}},k.property=function(e){return function(t){return t[e]}},k.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},k.times=function(e,t,n){for(var i=Array(Math.max(0,e)),s=0;e>s;s++)i[s]=t.call(n,s);return i},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},k.now=Date.now||function(){return(new Date).getTime()};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};$.unescape=k.invert($.escape);var P={escape:new RegExp("["+k.keys($.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys($.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(P[e],function(t){return $[e][t]})}}),k.result=function(e,t){if(null==e)return void 0;var n=e[t];return k.isFunction(n)?n.call(e):n},k.mixin=function(e){S(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),j.call(this,n.apply(k,e))}})};var L=0;k.uniqueId=function(e){var t=++L+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){var i;n=k.defaults({},n,k.templateSettings);var s=new RegExp([(n.escape||O).source,(n.interpolate||O).source,(n.evaluate||O).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(s,function(t,n,i,s,a){return r+=e.slice(o,a).replace(D,function(e){return"\\"+B[e]}),n&&(r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(r+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),s&&(r+="';\n"+s+"\n__p+='"),o=a+t.length,t}),r+="';\n",n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{i=new Function(n.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(t)return i(t,k);var l=function(e){return i.call(this,e,k)};return l.source="function("+(n.variable||"obj")+"){\n"+r+"}",l},k.chain=function(e){return k(e).chain()};var j=function(e){return this._chain?k(e).chain():e};k.mixin(k),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],j.call(this,n)}}),S(["concat","join","slice"],function(e){var t=i[e];k.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return k})}).call(this),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=e.length,n=ot.type(e);return"function"===n||ot.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,n){if(ot.isFunction(t))return ot.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return ot.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(pt.test(t))return ot.filter(t,e,n);t=ot.filter(t,e)}return ot.grep(e,function(e){return ot.inArray(e,t)>=0!==n})}function s(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function o(e){var t=_t[e]={};return ot.each(e.match(wt)||[],function(e,n){t[n]=!0}),t}function r(){vt.addEventListener?(vt.removeEventListener("DOMContentLoaded",a,!1),e.removeEventListener("load",a,!1)):(vt.detachEvent("onreadystatechange",a),e.detachEvent("onload",a))}function a(){(vt.addEventListener||"load"===event.type||"complete"===vt.readyState)&&(r(),ot.ready())}function l(e,t,n){if(void 0===n&&1===e.nodeType){var i="data-"+t.replace(Tt,"-$1").toLowerCase();if(n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Ct.test(n)?ot.parseJSON(n):n}catch(s){}ot.data(e,t,n)}else n=void 0}return n}function c(e){var t;for(t in e)if(("data"!==t||!ot.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function d(e,t,n,i){if(ot.acceptData(e)){var s,o,r=ot.expando,a=e.nodeType,l=a?ot.cache:e,c=a?e[r]:e[r]&&r;if(c&&l[c]&&(i||l[c].data)||void 0!==n||"string"!=typeof t)return c||(c=a?e[r]=Y.pop()||ot.guid++:r),l[c]||(l[c]=a?{}:{toJSON:ot.noop}),("object"==typeof t||"function"==typeof t)&&(i?l[c]=ot.extend(l[c],t):l[c].data=ot.extend(l[c].data,t)),o=l[c],i||(o.data||(o.data={}),o=o.data),void 0!==n&&(o[ot.camelCase(t)]=n),"string"==typeof t?(s=o[t],null==s&&(s=o[ot.camelCase(t)])):s=o,s}}function u(e,t,n){if(ot.acceptData(e)){var i,s,o=e.nodeType,r=o?ot.cache:e,a=o?e[ot.expando]:ot.expando;if(r[a]){if(t&&(i=n?r[a]:r[a].data)){ot.isArray(t)?t=t.concat(ot.map(t,ot.camelCase)):t in i?t=[t]:(t=ot.camelCase(t),t=t in i?[t]:t.split(" ")),s=t.length;for(;s--;)delete i[t[s]];if(n?!c(i):!ot.isEmptyObject(i))return}(n||(delete r[a].data,c(r[a])))&&(o?ot.cleanData([e],!0):it.deleteExpando||r!=r.window?delete r[a]:r[a]=null)}}}function h(){return!0}function p(){return!1}function f(){try{return vt.activeElement}catch(e){}}function v(e){var t=Dt.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function m(e,t){var n,i,s=0,o=typeof e.getElementsByTagName!==St?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==St?e.querySelectorAll(t||"*"):void 0;if(!o)for(o=[],n=e.childNodes||e;null!=(i=n[s]);s++)!t||ot.nodeName(i,t)?o.push(i):ot.merge(o,m(i,t));return void 0===t||t&&ot.nodeName(e,t)?ot.merge([e],o):o}function g(e){Mt.test(e.type)&&(e.defaultChecked=e.checked)}function b(e,t){return ot.nodeName(e,"table")&&ot.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function y(e){return e.type=(null!==ot.find.attr(e,"type"))+"/"+e.type,e}function w(e){var t=Yt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _(e,t){for(var n,i=0;null!=(n=e[i]);i++)ot._data(n,"globalEval",!t||ot._data(t[i],"globalEval"))}function x(e,t){if(1===t.nodeType&&ot.hasData(e)){var n,i,s,o=ot._data(e),r=ot._data(t,o),a=o.events;if(a){delete r.handle,r.events={};for(n in a)for(i=0,s=a[n].length;s>i;i++)ot.event.add(t,n,a[n][i])}r.data&&(r.data=ot.extend({},r.data))}}function k(e,t){var n,i,s;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!it.noCloneEvent&&t[ot.expando]){s=ot._data(t);for(i in s.events)ot.removeEvent(t,i,s.handle);t.removeAttribute(ot.expando)}"script"===n&&t.text!==e.text?(y(t).text=e.text,w(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),it.html5Clone&&e.innerHTML&&!ot.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Mt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function S(t,n){var i=ot(n.createElement(t)).appendTo(n.body),s=e.getDefaultComputedStyle?e.getDefaultComputedStyle(i[0]).display:ot.css(i[0],"display");return i.detach(),s}function C(e){var t=vt,n=en[e];return n||(n=S(e,t),"none"!==n&&n||(Zt=(Zt||ot("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Zt[0].contentWindow||Zt[0].contentDocument).document,t.write(),t.close(),n=S(e,t),Zt.detach()),en[e]=n),n}function T(e,t){return{get:function(){var n=e();return null!=n?n?void delete this.get:(this.get=t).apply(this,arguments):void 0}}}function E(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,s=fn.length;s--;)if(t=fn[s]+n,t in e)return t;return i}function A(e,t){for(var n,i,s,o=[],r=0,a=e.length;a>r;r++)i=e[r],i.style&&(o[r]=ot._data(i,"olddisplay"),n=i.style.display,t?(o[r]||"none"!==n||(i.style.display=""),""===i.style.display&&Ft(i)&&(o[r]=ot._data(i,"olddisplay",C(i.nodeName)))):o[r]||(s=Ft(i),(n&&"none"!==n||!s)&&ot._data(i,"olddisplay",s?n:ot.css(i,"display"))));for(r=0;a>r;r++)i=e[r],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[r]||"":"none"));return e}function F(e,t,n){var i=dn.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function N(e,t,n,i,s){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,r=0;4>o;o+=2)"margin"===n&&(r+=ot.css(e,n+At[o],!0,s)),i?("content"===n&&(r-=ot.css(e,"padding"+At[o],!0,s)),"margin"!==n&&(r-=ot.css(e,"border"+At[o]+"Width",!0,s))):(r+=ot.css(e,"padding"+At[o],!0,s),"padding"!==n&&(r+=ot.css(e,"border"+At[o]+"Width",!0,s)));return r}function M(e,t,n){var i=!0,s="width"===t?e.offsetWidth:e.offsetHeight,o=tn(e),r=it.boxSizing()&&"border-box"===ot.css(e,"boxSizing",!1,o);if(0>=s||null==s){if(s=nn(e,t,o),(0>s||null==s)&&(s=e.style[t]),on.test(s))return s;i=r&&(it.boxSizingReliable()||s===e.style[t]),s=parseFloat(s)||0}return s+N(e,t,n||(r?"border":"content"),i,o)+"px"}function $(e,t,n,i,s){return new $.prototype.init(e,t,n,i,s)}function P(){return setTimeout(function(){vn=void 0}),vn=ot.now()}function L(e,t){var n,i={height:e},s=0;for(t=t?1:0;4>s;s+=2-t)n=At[s],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function O(e,t,n){for(var i,s=(_n[t]||[]).concat(_n["*"]),o=0,r=s.length;r>o;o++)if(i=s[o].call(n,t,e))return i}function B(e,t,n){var i,s,o,r,a,l,c,d,u=this,h={},p=e.style,f=e.nodeType&&Ft(e),v=ot._data(e,"fxshow");n.queue||(a=ot._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,ot.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],c=ot.css(e,"display"),d=C(e.nodeName),"none"===c&&(c=d),"inline"===c&&"none"===ot.css(e,"float")&&(it.inlineBlockNeedsLayout&&"inline"!==d?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",it.shrinkWrapBlocks()||u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in t)if(s=t[i],gn.exec(s)){if(delete t[i],o=o||"toggle"===s,s===(f?"hide":"show")){if("show"!==s||!v||void 0===v[i])continue;f=!0}h[i]=v&&v[i]||ot.style(e,i)}if(!ot.isEmptyObject(h)){v?"hidden"in v&&(f=v.hidden):v=ot._data(e,"fxshow",{}),o&&(v.hidden=!f),f?ot(e).show():u.done(function(){ot(e).hide()}),u.done(function(){var t;ot._removeData(e,"fxshow");for(t in h)ot.style(e,t,h[t])});for(i in h)r=O(f?v[i]:0,i,u),i in v||(v[i]=r.start,f&&(r.end=r.start,r.start="width"===i||"height"===i?1:0))}}function D(e,t){var n,i,s,o,r;for(n in e)if(i=ot.camelCase(n),s=t[i],o=e[n],ot.isArray(o)&&(s=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),r=ot.cssHooks[i],r&&"expand"in r){o=r.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=s)}else t[i]=s}function j(e,t,n){var i,s,o=0,r=wn.length,a=ot.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=vn||P(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,o=1-i,r=0,l=c.tweens.length;l>r;r++)c.tweens[r].run(o);return a.notifyWith(e,[c,o,n]),1>o&&l?n:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:ot.extend({},t),opts:ot.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:vn||P(),duration:n.duration,tweens:[],createTween:function(t,n){var i=ot.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(s)return this;for(s=!0;i>n;n++)c.tweens[n].run(1);return t?a.resolveWith(e,[c,t]):a.rejectWith(e,[c,t]),this}}),d=c.props;for(D(d,c.opts.specialEasing);r>o;o++)if(i=wn[o].call(c,e,d,c.opts))return i;return ot.map(d,O,c),ot.isFunction(c.opts.start)&&c.opts.start.call(e,c),ot.fx.timer(ot.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function I(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,s=0,o=t.toLowerCase().match(wt)||[];if(ot.isFunction(n))for(;i=o[s++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function R(e,t,n,i){function s(a){var l;return o[a]=!0,ot.each(e[a]||[],function(e,a){var c=a(t,n,i);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)}),l}var o={},r=e===Un;return s(t.dataTypes[0])||!o["*"]&&s("*")}function V(e,t){var n,i,s=ot.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&ot.extend(!0,e,n),e}function z(e,t,n){for(var i,s,o,r,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(r in a)if(a[r]&&a[r].test(s)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}i||(i=r)}o=o||i}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}function H(e,t,n,i){var s,o,r,a,l,c={},d=e.dataTypes.slice();if(d[1])for(r in e.converters)c[r.toLowerCase()]=e.converters[r];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=d.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(r=c[l+" "+o]||c["* "+o],!r)for(s in c)if(a=s.split(" "),a[1]===o&&(r=c[l+" "+a[0]]||c["* "+a[0]])){r===!0?r=c[s]:c[s]!==!0&&(o=a[0],d.unshift(a[1]));break}if(r!==!0)if(r&&e["throws"])t=r(t);else try{t=r(t)}catch(u){return{state:"parsererror",error:r?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function q(e,t,n,i){var s;if(ot.isArray(t))ot.each(t,function(t,s){n||Kn.test(e)?i(e,s):q(e+"["+("object"==typeof s?t:"")+"]",s,n,i)});else if(n||"object"!==ot.type(t))i(e,t);else for(s in t)q(e+"["+s+"]",t[s],n,i)}function U(){try{return new e.XMLHttpRequest}catch(t){}}function X(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function W(e){return ot.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var Y=[],K=Y.slice,G=Y.concat,Q=Y.push,J=Y.indexOf,Z={},et=Z.toString,tt=Z.hasOwnProperty,nt="".trim,it={},st="1.11.0",ot=function(e,t){return new ot.fn.init(e,t)},rt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,at=/^-ms-/,lt=/-([\da-z])/gi,ct=function(e,t){return t.toUpperCase()};ot.fn=ot.prototype={jquery:st,constructor:ot,selector:"",length:0,toArray:function(){return K.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:K.call(this)},pushStack:function(e){var t=ot.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ot.each(this,e,t)},map:function(e){return this.pushStack(ot.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(K.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:Q,sort:Y.sort,splice:Y.splice},ot.extend=ot.fn.extend=function(){var e,t,n,i,s,o,r=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[a]||{},a++),"object"==typeof r||ot.isFunction(r)||(r={}),a===l&&(r=this,a--);l>a;a++)if(null!=(s=arguments[a]))for(i in s)e=r[i],n=s[i],r!==n&&(c&&n&&(ot.isPlainObject(n)||(t=ot.isArray(n)))?(t?(t=!1,o=e&&ot.isArray(e)?e:[]):o=e&&ot.isPlainObject(e)?e:{},r[i]=ot.extend(c,o,n)):void 0!==n&&(r[i]=n));return r},ot.extend({expando:"jQuery"+(st+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ot.type(e)},isArray:Array.isArray||function(e){return"array"===ot.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==ot.type(e)||e.nodeType||ot.isWindow(e))return!1;try{if(e.constructor&&!tt.call(e,"constructor")&&!tt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(it.ownLast)for(t in e)return tt.call(e,t);for(t in e);return void 0===t||tt.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[et.call(e)]||"object":typeof e},globalEval:function(t){t&&ot.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(at,"ms-").replace(lt,ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var s,o=0,r=e.length,a=n(e);if(i){if(a)for(;r>o&&(s=t.apply(e[o],i),s!==!1);o++);else for(o in e)if(s=t.apply(e[o],i),s===!1)break}else if(a)for(;r>o&&(s=t.call(e[o],o,e[o]),s!==!1);o++);else for(o in e)if(s=t.call(e[o],o,e[o]),s===!1)break;return e},trim:nt&&!nt.call("﻿ ")?function(e){return null==e?"":nt.call(e)}:function(e){return null==e?"":(e+"").replace(rt,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?ot.merge(i,"string"==typeof e?[e]:e):Q.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(J)return J.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,i=0,s=e.length;n>i;)e[s++]=t[i++];if(n!==n)for(;void 0!==t[i];)e[s++]=t[i++];return e.length=s,e},grep:function(e,t,n){for(var i,s=[],o=0,r=e.length,a=!n;r>o;o++)i=!t(e[o],o),i!==a&&s.push(e[o]);return s},map:function(e,t,i){var s,o=0,r=e.length,a=n(e),l=[];if(a)for(;r>o;o++)s=t(e[o],o,i),null!=s&&l.push(s);else for(o in e)s=t(e[o],o,i),null!=s&&l.push(s);return G.apply([],l)},guid:1,proxy:function(e,t){var n,i,s;return"string"==typeof t&&(s=e[t],t=e,e=s),ot.isFunction(e)?(n=K.call(arguments,2),i=function(){return e.apply(t||this,n.concat(K.call(arguments)))},i.guid=e.guid=e.guid||ot.guid++,i):void 0},now:function(){return+new Date},support:it}),ot.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()});var dt=function(e){function t(e,t,n,i){var s,o,r,a,l,c,u,f,v,m;if((t?t.ownerDocument||t:R)!==$&&M(t),t=t||$,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(L&&!i){if(s=bt.exec(e))if(r=s[1]){if(9===a){if(o=t.getElementById(r),!o||!o.parentNode)return n;if(o.id===r)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(r))&&j(t,o)&&o.id===r)return n.push(o),n}else{if(s[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((r=s[3])&&k.getElementsByClassName&&t.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(r)),n}if(k.qsa&&(!O||!O.test(e))){if(f=u=I,v=t,m=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(c=h(e),(u=t.getAttribute("id"))?f=u.replace(wt,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",l=c.length;l--;)c[l]=f+p(c[l]);v=yt.test(e)&&d(t.parentNode)||t,m=c.join(",")}if(m)try{return Z.apply(n,v.querySelectorAll(m)),n}catch(g){}finally{u||t.removeAttribute("id")}}}return _(e.replace(lt,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>S.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[I]=!0,e}function s(e){var t=$.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),i=e.length;i--;)S.attrHandle[n[i]]=t}function r(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(n,i){for(var s,o=e([],n.length,t),r=o.length;r--;)n[s=o[r]]&&(n[s]=!(i[s]=n[s]))})})}function d(e){return e&&typeof e.getElementsByTagName!==W&&e}function u(){}function h(e,n){var i,s,o,r,a,l,c,d=q[e+" "];if(d)return n?0:d.slice(0);for(a=e,l=[],c=S.preFilter;a;){(!i||(s=ct.exec(a)))&&(s&&(a=a.slice(s[0].length)||a),l.push(o=[])),i=!1,(s=dt.exec(a))&&(i=s.shift(),o.push({value:i,type:s[0].replace(lt," ")}),a=a.slice(i.length));
for(r in S.filter)!(s=ft[r].exec(a))||c[r]&&!(s=c[r](s))||(i=s.shift(),o.push({value:i,type:r,matches:s}),a=a.slice(i.length));if(!i)break}return n?a.length:a?t.error(e):q(e,l).slice(0)}function p(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function f(e,t,n){var i=t.dir,s=n&&"parentNode"===i,o=z++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,o)}:function(t,n,r){var a,l,c=[V,o];if(r){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,r))return!0}else for(;t=t[i];)if(1===t.nodeType||s){if(l=t[I]||(t[I]={}),(a=l[i])&&a[0]===V&&a[1]===o)return c[2]=a[2];if(l[i]=c,c[2]=e(t,n,r))return!0}}}function v(e){return e.length>1?function(t,n,i){for(var s=e.length;s--;)if(!e[s](t,n,i))return!1;return!0}:e[0]}function m(e,t,n,i,s){for(var o,r=[],a=0,l=e.length,c=null!=t;l>a;a++)(o=e[a])&&(!n||n(o,i,s))&&(r.push(o),c&&t.push(a));return r}function g(e,t,n,s,o,r){return s&&!s[I]&&(s=g(s)),o&&!o[I]&&(o=g(o,r)),i(function(i,r,a,l){var c,d,u,h=[],p=[],f=r.length,v=i||w(t||"*",a.nodeType?[a]:a,[]),g=!e||!i&&t?v:m(v,h,e,a,l),b=n?o||(i?e:f||s)?[]:r:g;if(n&&n(g,b,a,l),s)for(c=m(b,p),s(c,[],a,l),d=c.length;d--;)(u=c[d])&&(b[p[d]]=!(g[p[d]]=u));if(i){if(o||e){if(o){for(c=[],d=b.length;d--;)(u=b[d])&&c.push(g[d]=u);o(null,b=[],c,l)}for(d=b.length;d--;)(u=b[d])&&(c=o?tt.call(i,u):h[d])>-1&&(i[c]=!(r[c]=u))}}else b=m(b===r?b.splice(f,b.length):b),o?o(null,r,b,l):Z.apply(r,b)})}function b(e){for(var t,n,i,s=e.length,o=S.relative[e[0].type],r=o||S.relative[" "],a=o?1:0,l=f(function(e){return e===t},r,!0),c=f(function(e){return tt.call(t,e)>-1},r,!0),d=[function(e,n,i){return!o&&(i||n!==A)||((t=n).nodeType?l(e,n,i):c(e,n,i))}];s>a;a++)if(n=S.relative[e[a].type])d=[f(v(d),n)];else{if(n=S.filter[e[a].type].apply(null,e[a].matches),n[I]){for(i=++a;s>i&&!S.relative[e[i].type];i++);return g(a>1&&v(d),a>1&&p(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(lt,"$1"),n,i>a&&b(e.slice(a,i)),s>i&&b(e=e.slice(i)),s>i&&p(e))}d.push(n)}return v(d)}function y(e,n){var s=n.length>0,o=e.length>0,r=function(i,r,a,l,c){var d,u,h,p=0,f="0",v=i&&[],g=[],b=A,y=i||o&&S.find.TAG("*",c),w=V+=null==b?1:Math.random()||.1,_=y.length;for(c&&(A=r!==$&&r);f!==_&&null!=(d=y[f]);f++){if(o&&d){for(u=0;h=e[u++];)if(h(d,r,a)){l.push(d);break}c&&(V=w)}s&&((d=!h&&d)&&p--,i&&v.push(d))}if(p+=f,s&&f!==p){for(u=0;h=n[u++];)h(v,g,r,a);if(i){if(p>0)for(;f--;)v[f]||g[f]||(g[f]=Q.call(l));g=m(g)}Z.apply(l,g),c&&!i&&g.length>0&&p+n.length>1&&t.uniqueSort(l)}return c&&(V=w,A=b),v};return s?i(r):r}function w(e,n,i){for(var s=0,o=n.length;o>s;s++)t(e,n[s],i);return i}function _(e,t,n,i){var s,o,r,a,l,c=h(e);if(!i&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(r=o[0]).type&&k.getById&&9===t.nodeType&&L&&S.relative[o[1].type]){if(t=(S.find.ID(r.matches[0].replace(_t,xt),t)||[])[0],!t)return n;e=e.slice(o.shift().value.length)}for(s=ft.needsContext.test(e)?0:o.length;s--&&(r=o[s],!S.relative[a=r.type]);)if((l=S.find[a])&&(i=l(r.matches[0].replace(_t,xt),yt.test(o[0].type)&&d(t.parentNode)||t))){if(o.splice(s,1),e=i.length&&p(o),!e)return Z.apply(n,i),n;break}}return E(e,c)(i,t,!L,n,yt.test(e)&&d(t.parentNode)||t),n}var x,k,S,C,T,E,A,F,N,M,$,P,L,O,B,D,j,I="sizzle"+-new Date,R=e.document,V=0,z=0,H=n(),q=n(),U=n(),X=function(e,t){return e===t&&(N=!0),0},W="undefined",Y=1<<31,K={}.hasOwnProperty,G=[],Q=G.pop,J=G.push,Z=G.push,et=G.slice,tt=G.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},nt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=st.replace("w","w#"),rt="\\["+it+"*("+st+")"+it+"*(?:([*^$|!~]?=)"+it+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ot+")|)|)"+it+"*\\]",at=":("+st+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+rt.replace(3,8)+")*)|.*)\\)|)",lt=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),ct=new RegExp("^"+it+"*,"+it+"*"),dt=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ut=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),ht=new RegExp(at),pt=new RegExp("^"+ot+"$"),ft={ID:new RegExp("^#("+st+")"),CLASS:new RegExp("^\\.("+st+")"),TAG:new RegExp("^("+st.replace("w","w*")+")"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+nt+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},vt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,gt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,wt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),xt=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{Z.apply(G=et.call(R.childNodes),R.childNodes),G[R.childNodes.length].nodeType}catch(kt){Z={apply:G.length?function(e,t){J.apply(e,et.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}k=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},M=t.setDocument=function(e){var t,n=e?e.ownerDocument||e:R,i=n.defaultView;return n!==$&&9===n.nodeType&&n.documentElement?($=n,P=n.documentElement,L=!T(n),i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",function(){M()},!1):i.attachEvent&&i.attachEvent("onunload",function(){M()})),k.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),k.getElementsByTagName=s(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),k.getElementsByClassName=gt.test(n.getElementsByClassName)&&s(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),k.getById=s(function(e){return P.appendChild(e).id=I,!n.getElementsByName||!n.getElementsByName(I).length}),k.getById?(S.find.ID=function(e,t){if(typeof t.getElementById!==W&&L){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},S.filter.ID=function(e){var t=e.replace(_t,xt);return function(e){return e.getAttribute("id")===t}}):(delete S.find.ID,S.filter.ID=function(e){var t=e.replace(_t,xt);return function(e){var n=typeof e.getAttributeNode!==W&&e.getAttributeNode("id");return n&&n.value===t}}),S.find.TAG=k.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==W?t.getElementsByTagName(e):void 0}:function(e,t){var n,i=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[s++];)1===n.nodeType&&i.push(n);return i}return o},S.find.CLASS=k.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==W&&L?t.getElementsByClassName(e):void 0},B=[],O=[],(k.qsa=gt.test(n.querySelectorAll))&&(s(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&O.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+it+"*(?:value|"+nt+")"),e.querySelectorAll(":checked").length||O.push(":checked")}),s(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+it+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(k.matchesSelector=gt.test(D=P.webkitMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector||P.msMatchesSelector))&&s(function(e){k.disconnectedMatch=D.call(e,"div"),D.call(e,"[s!='']:x"),B.push("!=",at)}),O=O.length&&new RegExp(O.join("|")),B=B.length&&new RegExp(B.join("|")),t=gt.test(P.compareDocumentPosition),j=t||gt.test(P.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},X=t?function(e,t){if(e===t)return N=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!k.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===R&&j(R,e)?-1:t===n||t.ownerDocument===R&&j(R,t)?1:F?tt.call(F,e)-tt.call(F,t):0:4&i?-1:1)}:function(e,t){if(e===t)return N=!0,0;var i,s=0,o=e.parentNode,a=t.parentNode,l=[e],c=[t];if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:F?tt.call(F,e)-tt.call(F,t):0;if(o===a)return r(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[s]===c[s];)s++;return s?r(l[s],c[s]):l[s]===R?-1:c[s]===R?1:0},n):$},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==$&&M(e),n=n.replace(ut,"='$1']"),!(!k.matchesSelector||!L||B&&B.test(n)||O&&O.test(n)))try{var i=D.call(e,n);if(i||k.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(s){}return t(n,$,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==$&&M(e),j(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==$&&M(e);var n=S.attrHandle[t.toLowerCase()],i=n&&K.call(S.attrHandle,t.toLowerCase())?n(e,t,!L):void 0;return void 0!==i?i:k.attributes||!L?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,s=0;if(N=!k.detectDuplicates,F=!k.sortStable&&e.slice(0),e.sort(X),N){for(;t=e[s++];)t===e[s]&&(i=n.push(s));for(;i--;)e.splice(n[i],1)}return F=null,e},C=t.getText=function(e){var t,n="",i=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[i++];)n+=C(t);return n},S=t.selectors={cacheLength:50,createPseudo:i,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_t,xt),e[3]=(e[4]||e[5]||"").replace(_t,xt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return ft.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:n&&ht.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_t,xt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&H(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==W&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(s){var o=t.attr(s,e);return null==o?"!="===n:n?(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o+" ").indexOf(i)>-1:"|="===n?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,s){var o="nth"!==e.slice(0,3),r="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===s?function(e){return!!e.parentNode}:function(t,n,l){var c,d,u,h,p,f,v=o!==r?"nextSibling":"previousSibling",m=t.parentNode,g=a&&t.nodeName.toLowerCase(),b=!l&&!a;if(m){if(o){for(;v;){for(u=t;u=u[v];)if(a?u.nodeName.toLowerCase()===g:1===u.nodeType)return!1;f=v="only"===e&&!f&&"nextSibling"}return!0}if(f=[r?m.firstChild:m.lastChild],r&&b){for(d=m[I]||(m[I]={}),c=d[e]||[],p=c[0]===V&&c[1],h=c[0]===V&&c[2],u=p&&m.childNodes[p];u=++p&&u&&u[v]||(h=p=0)||f.pop();)if(1===u.nodeType&&++h&&u===t){d[e]=[V,p,h];break}}else if(b&&(c=(t[I]||(t[I]={}))[e])&&c[0]===V)h=c[1];else for(;(u=++p&&u&&u[v]||(h=p=0)||f.pop())&&((a?u.nodeName.toLowerCase()!==g:1!==u.nodeType)||!++h||(b&&((u[I]||(u[I]={}))[e]=[V,h]),u!==t)););return h-=s,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(e,n){var s,o=S.pseudos[e]||S.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[I]?o(n):o.length>1?(s=[e,e,"",n],S.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,s=o(e,n),r=s.length;r--;)i=tt.call(e,s[r]),e[i]=!(t[i]=s[r])}):function(e){return o(e,0,s)}):o}},pseudos:{not:i(function(e){var t=[],n=[],s=E(e.replace(lt,"$1"));return s[I]?i(function(e,t,n,i){for(var o,r=s(e,null,i,[]),a=e.length;a--;)(o=r[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,s(t,null,o,n),!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:i(function(e){return pt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_t,xt).toLowerCase(),function(t){var n;do if(n=L?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===P},focus:function(e){return e===$.activeElement&&(!$.hasFocus||$.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!S.pseudos.empty(e)},header:function(e){return mt.test(e.nodeName)},input:function(e){return vt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[0>n?n+t:n]}),even:c(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},S.pseudos.nth=S.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[x]=a(x);for(x in{submit:!0,reset:!0})S.pseudos[x]=l(x);return u.prototype=S.filters=S.pseudos,S.setFilters=new u,E=t.compile=function(e,t){var n,i=[],s=[],o=U[e+" "];if(!o){for(t||(t=h(e)),n=t.length;n--;)o=b(t[n]),o[I]?i.push(o):s.push(o);o=U(e,y(s,i))}return o},k.sortStable=I.split("").sort(X).join("")===I,k.detectDuplicates=!!N,M(),k.sortDetached=s(function(e){return 1&e.compareDocumentPosition($.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),k.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(nt,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);ot.find=dt,ot.expr=dt.selectors,ot.expr[":"]=ot.expr.pseudos,ot.unique=dt.uniqueSort,ot.text=dt.getText,ot.isXMLDoc=dt.isXML,ot.contains=dt.contains;var ut=ot.expr.match.needsContext,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pt=/^.[^:#\[\.,]*$/;ot.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?ot.find.matchesSelector(i,e)?[i]:[]:ot.find.matches(e,ot.grep(t,function(e){return 1===e.nodeType}))},ot.fn.extend({find:function(e){var t,n=[],i=this,s=i.length;if("string"!=typeof e)return this.pushStack(ot(e).filter(function(){for(t=0;s>t;t++)if(ot.contains(i[t],this))return!0}));for(t=0;s>t;t++)ot.find(e,i[t],n);return n=this.pushStack(s>1?ot.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&ut.test(e)?ot(e):e||[],!1).length}});var ft,vt=e.document,mt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,gt=ot.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:mt.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||ft).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof ot?t[0]:t,ot.merge(this,ot.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:vt,!0)),ht.test(n[1])&&ot.isPlainObject(t))for(n in t)ot.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if(i=vt.getElementById(n[2]),i&&i.parentNode){if(i.id!==n[2])return ft.find(e);this.length=1,this[0]=i}return this.context=vt,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ot.isFunction(e)?"undefined"!=typeof ft.ready?ft.ready(e):e(ot):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),ot.makeArray(e,this))};gt.prototype=ot.fn,ft=ot(vt);var bt=/^(?:parents|prev(?:Until|All))/,yt={children:!0,contents:!0,next:!0,prev:!0};ot.extend({dir:function(e,t,n){for(var i=[],s=e[t];s&&9!==s.nodeType&&(void 0===n||1!==s.nodeType||!ot(s).is(n));)1===s.nodeType&&i.push(s),s=s[t];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),ot.fn.extend({has:function(e){var t,n=ot(e,this),i=n.length;return this.filter(function(){for(t=0;i>t;t++)if(ot.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,i=0,s=this.length,o=[],r=ut.test(e)||"string"!=typeof e?ot(e,t||this.context):0;s>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(r?r.index(n)>-1:1===n.nodeType&&ot.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?ot.unique(o):o)},index:function(e){return e?"string"==typeof e?ot.inArray(this[0],ot(e)):ot.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ot.unique(ot.merge(this.get(),ot(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ot.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ot.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ot.dir(e,"parentNode",n)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return ot.dir(e,"nextSibling")},prevAll:function(e){return ot.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ot.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ot.dir(e,"previousSibling",n)},siblings:function(e){return ot.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ot.sibling(e.firstChild)},contents:function(e){return ot.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ot.merge([],e.childNodes)}},function(e,t){ot.fn[e]=function(n,i){var s=ot.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(s=ot.filter(i,s)),this.length>1&&(yt[e]||(s=ot.unique(s)),bt.test(e)&&(s=s.reverse())),this.pushStack(s)}});var wt=/\S+/g,_t={};ot.Callbacks=function(e){e="string"==typeof e?_t[e]||o(e):ot.extend({},e);var t,n,i,s,r,a,l=[],c=!e.once&&[],d=function(o){for(n=e.memory&&o,i=!0,r=a||0,a=0,s=l.length,t=!0;l&&s>r;r++)if(l[r].apply(o[0],o[1])===!1&&e.stopOnFalse){n=!1;break}t=!1,l&&(c?c.length&&d(c.shift()):n?l=[]:u.disable())},u={add:function(){if(l){var i=l.length;!function o(t){ot.each(t,function(t,n){var i=ot.type(n);"function"===i?e.unique&&u.has(n)||l.push(n):n&&n.length&&"string"!==i&&o(n)})}(arguments),t?s=l.length:n&&(a=i,d(n))}return this},remove:function(){return l&&ot.each(arguments,function(e,n){for(var i;(i=ot.inArray(n,l,i))>-1;)l.splice(i,1),t&&(s>=i&&s--,r>=i&&r--)}),this},has:function(e){return e?ot.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=n=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,n||u.disable(),this},locked:function(){return!c},fireWith:function(e,n){return!l||i&&!c||(n=n||[],n=[e,n.slice?n.slice():n],t?c.push(n):d(n)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},ot.extend({Deferred:function(e){var t=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ot.Deferred(function(n){ot.each(t,function(t,o){var r=ot.isFunction(e[t])&&e[t];s[o[1]](function(){var e=r&&r.apply(this,arguments);e&&ot.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===i?n.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ot.extend(e,i):i}},s={};return i.pipe=i.then,ot.each(t,function(e,o){var r=o[2],a=o[3];i[o[1]]=r.add,a&&r.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?i:this,arguments),this},s[o[0]+"With"]=r.fireWith}),i.promise(s),e&&e.call(s,s),s},when:function(e){var t,n,i,s=0,o=K.call(arguments),r=o.length,a=1!==r||e&&ot.isFunction(e.promise)?r:0,l=1===a?e:ot.Deferred(),c=function(e,n,i){return function(s){n[e]=this,i[e]=arguments.length>1?K.call(arguments):s,i===t?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(r>1)for(t=new Array(r),n=new Array(r),i=new Array(r);r>s;s++)o[s]&&ot.isFunction(o[s].promise)?o[s].promise().done(c(s,i,o)).fail(l.reject).progress(c(s,n,t)):--a;return a||l.resolveWith(i,o),l.promise()}});var xt;ot.fn.ready=function(e){return ot.ready.promise().done(e),this},ot.extend({isReady:!1,readyWait:1,holdReady:function(e){e?ot.readyWait++:ot.ready(!0)},ready:function(e){if(e===!0?!--ot.readyWait:!ot.isReady){if(!vt.body)return setTimeout(ot.ready);ot.isReady=!0,e!==!0&&--ot.readyWait>0||(xt.resolveWith(vt,[ot]),ot.fn.trigger&&ot(vt).trigger("ready").off("ready"))}}}),ot.ready.promise=function(t){if(!xt)if(xt=ot.Deferred(),"complete"===vt.readyState)setTimeout(ot.ready);else if(vt.addEventListener)vt.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1);else{vt.attachEvent("onreadystatechange",a),e.attachEvent("onload",a);var n=!1;try{n=null==e.frameElement&&vt.documentElement}catch(i){}n&&n.doScroll&&!function s(){if(!ot.isReady){try{n.doScroll("left")}catch(e){return setTimeout(s,50)}r(),ot.ready()}}()}return xt.promise(t)};var kt,St="undefined";for(kt in ot(it))break;it.ownLast="0"!==kt,it.inlineBlockNeedsLayout=!1,ot(function(){var e,t,n=vt.getElementsByTagName("body")[0];n&&(e=vt.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=vt.createElement("div"),n.appendChild(e).appendChild(t),typeof t.style.zoom!==St&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(it.inlineBlockNeedsLayout=3===t.offsetWidth)&&(n.style.zoom=1)),n.removeChild(e),e=t=null)}),function(){var e=vt.createElement("div");if(null==it.deleteExpando){it.deleteExpando=!0;try{delete e.test}catch(t){it.deleteExpando=!1}}e=null}(),ot.acceptData=function(e){var t=ot.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return 1!==n&&9!==n?!1:!t||t!==!0&&e.getAttribute("classid")===t};var Ct=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;ot.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?ot.cache[e[ot.expando]]:e[ot.expando],!!e&&!c(e)},data:function(e,t,n){return d(e,t,n)},removeData:function(e,t){return u(e,t)},_data:function(e,t,n){return d(e,t,n,!0)},_removeData:function(e,t){return u(e,t,!0)}}),ot.fn.extend({data:function(e,t){var n,i,s,o=this[0],r=o&&o.attributes;if(void 0===e){if(this.length&&(s=ot.data(o),1===o.nodeType&&!ot._data(o,"parsedAttrs"))){for(n=r.length;n--;)i=r[n].name,0===i.indexOf("data-")&&(i=ot.camelCase(i.slice(5)),l(o,i,s[i]));ot._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){ot.data(this,e)}):arguments.length>1?this.each(function(){ot.data(this,e,t)}):o?l(o,e,ot.data(o,e)):void 0},removeData:function(e){return this.each(function(){ot.removeData(this,e)})}}),ot.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=ot._data(e,t),n&&(!i||ot.isArray(n)?i=ot._data(e,t,ot.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=ot.queue(e,t),i=n.length,s=n.shift(),o=ot._queueHooks(e,t),r=function(){ot.dequeue(e,t)};"inprogress"===s&&(s=n.shift(),i--),s&&("fx"===t&&n.unshift("inprogress"),delete o.stop,s.call(e,r,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ot._data(e,n)||ot._data(e,n,{empty:ot.Callbacks("once memory").add(function(){ot._removeData(e,t+"queue"),ot._removeData(e,n)})})}}),ot.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?ot.queue(this[0],e):void 0===t?this:this.each(function(){var n=ot.queue(this,e,t);ot._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&ot.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ot.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,s=ot.Deferred(),o=this,r=this.length,a=function(){--i||s.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)n=ot._data(o[r],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(a));return a(),s.promise(t)}});var Et=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,At=["Top","Right","Bottom","Left"],Ft=function(e,t){return e=t||e,"none"===ot.css(e,"display")||!ot.contains(e.ownerDocument,e)},Nt=ot.access=function(e,t,n,i,s,o,r){var a=0,l=e.length,c=null==n;if("object"===ot.type(n)){s=!0;for(a in n)ot.access(e,t,a,n[a],!0,o,r)}else if(void 0!==i&&(s=!0,ot.isFunction(i)||(r=!0),c&&(r?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(ot(e),n)})),t))for(;l>a;a++)t(e[a],n,r?i:i.call(e[a],a,t(e[a],n)));return s?e:c?t.call(e):l?t(e[0],n):o},Mt=/^(?:checkbox|radio)$/i;!function(){var e=vt.createDocumentFragment(),t=vt.createElement("div"),n=vt.createElement("input");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",it.leadingWhitespace=3===t.firstChild.nodeType,it.tbody=!t.getElementsByTagName("tbody").length,it.htmlSerialize=!!t.getElementsByTagName("link").length,it.html5Clone="<:nav></:nav>"!==vt.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,e.appendChild(n),it.appendChecked=n.checked,t.innerHTML="<textarea>x</textarea>",it.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",it.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,it.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){it.noCloneEvent=!1}),t.cloneNode(!0).click()),null==it.deleteExpando){it.deleteExpando=!0;try{delete t.test}catch(i){it.deleteExpando=!1}}e=t=n=null}(),function(){var t,n,i=vt.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(it[t+"Bubbles"]=n in e)||(i.setAttribute(n,"t"),it[t+"Bubbles"]=i.attributes[n].expando===!1);i=null}();var $t=/^(?:input|select|textarea)$/i,Pt=/^key/,Lt=/^(?:mouse|contextmenu)|click/,Ot=/^(?:focusinfocus|focusoutblur)$/,Bt=/^([^.]*)(?:\.(.+)|)$/;ot.event={global:{},add:function(e,t,n,i,s){var o,r,a,l,c,d,u,h,p,f,v,m=ot._data(e);if(m){for(n.handler&&(l=n,n=l.handler,s=l.selector),n.guid||(n.guid=ot.guid++),(r=m.events)||(r=m.events={}),(d=m.handle)||(d=m.handle=function(e){return typeof ot===St||e&&ot.event.triggered===e.type?void 0:ot.event.dispatch.apply(d.elem,arguments)},d.elem=e),t=(t||"").match(wt)||[""],a=t.length;a--;)o=Bt.exec(t[a])||[],p=v=o[1],f=(o[2]||"").split(".").sort(),p&&(c=ot.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,c=ot.event.special[p]||{},u=ot.extend({type:p,origType:v,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&ot.expr.match.needsContext.test(s),namespace:f.join(".")},l),(h=r[p])||(h=r[p]=[],h.delegateCount=0,c.setup&&c.setup.call(e,i,f,d)!==!1||(e.addEventListener?e.addEventListener(p,d,!1):e.attachEvent&&e.attachEvent("on"+p,d))),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),s?h.splice(h.delegateCount++,0,u):h.push(u),ot.event.global[p]=!0);e=null}},remove:function(e,t,n,i,s){var o,r,a,l,c,d,u,h,p,f,v,m=ot.hasData(e)&&ot._data(e);if(m&&(d=m.events)){for(t=(t||"").match(wt)||[""],c=t.length;c--;)if(a=Bt.exec(t[c])||[],p=v=a[1],f=(a[2]||"").split(".").sort(),p){for(u=ot.event.special[p]||{},p=(i?u.delegateType:u.bindType)||p,h=d[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=h.length;o--;)r=h[o],!s&&v!==r.origType||n&&n.guid!==r.guid||a&&!a.test(r.namespace)||i&&i!==r.selector&&("**"!==i||!r.selector)||(h.splice(o,1),r.selector&&h.delegateCount--,u.remove&&u.remove.call(e,r));l&&!h.length&&(u.teardown&&u.teardown.call(e,f,m.handle)!==!1||ot.removeEvent(e,p,m.handle),delete d[p])}else for(p in d)ot.event.remove(e,p+t[c],n,i,!0);ot.isEmptyObject(d)&&(delete m.handle,ot._removeData(e,"events"))}},trigger:function(t,n,i,s){var o,r,a,l,c,d,u,h=[i||vt],p=tt.call(t,"type")?t.type:t,f=tt.call(t,"namespace")?t.namespace.split("."):[];if(a=d=i=i||vt,3!==i.nodeType&&8!==i.nodeType&&!Ot.test(p+ot.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),r=p.indexOf(":")<0&&"on"+p,t=t[ot.expando]?t:new ot.Event(p,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:ot.makeArray(n,[t]),c=ot.event.special[p]||{},s||!c.trigger||c.trigger.apply(i,n)!==!1)){if(!s&&!c.noBubble&&!ot.isWindow(i)){for(l=c.delegateType||p,Ot.test(l+p)||(a=a.parentNode);a;a=a.parentNode)h.push(a),d=a;d===(i.ownerDocument||vt)&&h.push(d.defaultView||d.parentWindow||e)}for(u=0;(a=h[u++])&&!t.isPropagationStopped();)t.type=u>1?l:c.bindType||p,o=(ot._data(a,"events")||{})[t.type]&&ot._data(a,"handle"),o&&o.apply(a,n),o=r&&a[r],o&&o.apply&&ot.acceptData(a)&&(t.result=o.apply(a,n),t.result===!1&&t.preventDefault());if(t.type=p,!s&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(h.pop(),n)===!1)&&ot.acceptData(i)&&r&&i[p]&&!ot.isWindow(i)){d=i[r],d&&(i[r]=null),ot.event.triggered=p;try{i[p]()}catch(v){}ot.event.triggered=void 0,d&&(i[r]=d)}return t.result}},dispatch:function(e){e=ot.event.fix(e);var t,n,i,s,o,r=[],a=K.call(arguments),l=(ot._data(this,"events")||{})[e.type]||[],c=ot.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(r=ot.event.handlers.call(this,e,l),t=0;(s=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,o=0;(i=s.handlers[o++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,n=((ot.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result
}},handlers:function(e,t){var n,i,s,o,r=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(s=[],o=0;a>o;o++)i=t[o],n=i.selector+" ",void 0===s[n]&&(s[n]=i.needsContext?ot(n,this).index(l)>=0:ot.find(n,this,null,[l]).length),s[n]&&s.push(i);s.length&&r.push({elem:l,handlers:s})}return a<t.length&&r.push({elem:this,handlers:t.slice(a)}),r},fix:function(e){if(e[ot.expando])return e;var t,n,i,s=e.type,o=e,r=this.fixHooks[s];for(r||(this.fixHooks[s]=r=Lt.test(s)?this.mouseHooks:Pt.test(s)?this.keyHooks:{}),i=r.props?this.props.concat(r.props):this.props,e=new ot.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=o.srcElement||vt),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,r.filter?r.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,s,o=t.button,r=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||vt,s=i.documentElement,n=i.body,e.pageX=t.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ot.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return ot.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var s=ot.extend(new ot.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?ot.event.trigger(s,null,t):ot.event.dispatch.call(t,s),s.isDefaultPrevented()&&n.preventDefault()}},ot.removeEvent=vt.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&(typeof e[i]===St&&(e[i]=null),e.detachEvent(i,n))},ot.Event=function(e,t){return this instanceof ot.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault())?h:p):this.type=e,t&&ot.extend(this,t),this.timeStamp=e&&e.timeStamp||ot.now(),void(this[ot.expando]=!0)):new ot.Event(e,t)},ot.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h,this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ot.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,s=e.relatedTarget,o=e.handleObj;return(!s||s!==i&&!ot.contains(i,s))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),it.submitBubbles||(ot.event.special.submit={setup:function(){return ot.nodeName(this,"form")?!1:void ot.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=ot.nodeName(t,"input")||ot.nodeName(t,"button")?t.form:void 0;n&&!ot._data(n,"submitBubbles")&&(ot.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),ot._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ot.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ot.nodeName(this,"form")?!1:void ot.event.remove(this,"._submit")}}),it.changeBubbles||(ot.event.special.change={setup:function(){return $t.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ot.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ot.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ot.event.simulate("change",this,e,!0)})),!1):void ot.event.add(this,"beforeactivate._change",function(e){var t=e.target;$t.test(t.nodeName)&&!ot._data(t,"changeBubbles")&&(ot.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ot.event.simulate("change",this.parentNode,e,!0)}),ot._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ot.event.remove(this,"._change"),!$t.test(this.nodeName)}}),it.focusinBubbles||ot.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){ot.event.simulate(t,e.target,ot.event.fix(e),!0)};ot.event.special[t]={setup:function(){var i=this.ownerDocument||this,s=ot._data(i,t);s||i.addEventListener(e,n,!0),ot._data(i,t,(s||0)+1)},teardown:function(){var i=this.ownerDocument||this,s=ot._data(i,t)-1;s?ot._data(i,t,s):(i.removeEventListener(e,n,!0),ot._removeData(i,t))}}}),ot.fn.extend({on:function(e,t,n,i,s){var o,r;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(o in e)this.on(o,t,n,e[o],s);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=p;else if(!i)return this;return 1===s&&(r=i,i=function(e){return ot().off(e),r.apply(this,arguments)},i.guid=r.guid||(r.guid=ot.guid++)),this.each(function(){ot.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,ot(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=p),this.each(function(){ot.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){ot.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?ot.event.trigger(e,t,n,!0):void 0}});var Dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",jt=/ jQuery\d+="(?:null|\d+)"/g,It=new RegExp("<(?:"+Dt+")[\\s/>]","i"),Rt=/^\s+/,Vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,zt=/<([\w:]+)/,Ht=/<tbody/i,qt=/<|&#?\w+;/,Ut=/<(?:script|style|link)/i,Xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Wt=/^$|\/(?:java|ecma)script/i,Yt=/^true\/(.*)/,Kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Gt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:it.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Qt=v(vt),Jt=Qt.appendChild(vt.createElement("div"));Gt.optgroup=Gt.option,Gt.tbody=Gt.tfoot=Gt.colgroup=Gt.caption=Gt.thead,Gt.th=Gt.td,ot.extend({clone:function(e,t,n){var i,s,o,r,a,l=ot.contains(e.ownerDocument,e);if(it.html5Clone||ot.isXMLDoc(e)||!It.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Jt.innerHTML=e.outerHTML,Jt.removeChild(o=Jt.firstChild)),!(it.noCloneEvent&&it.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ot.isXMLDoc(e)))for(i=m(o),a=m(e),r=0;null!=(s=a[r]);++r)i[r]&&k(s,i[r]);if(t)if(n)for(a=a||m(e),i=i||m(o),r=0;null!=(s=a[r]);r++)x(s,i[r]);else x(e,o);return i=m(o,"script"),i.length>0&&_(i,!l&&m(e,"script")),i=a=s=null,o},buildFragment:function(e,t,n,i){for(var s,o,r,a,l,c,d,u=e.length,h=v(t),p=[],f=0;u>f;f++)if(o=e[f],o||0===o)if("object"===ot.type(o))ot.merge(p,o.nodeType?[o]:o);else if(qt.test(o)){for(a=a||h.appendChild(t.createElement("div")),l=(zt.exec(o)||["",""])[1].toLowerCase(),d=Gt[l]||Gt._default,a.innerHTML=d[1]+o.replace(Vt,"<$1></$2>")+d[2],s=d[0];s--;)a=a.lastChild;if(!it.leadingWhitespace&&Rt.test(o)&&p.push(t.createTextNode(Rt.exec(o)[0])),!it.tbody)for(o="table"!==l||Ht.test(o)?"<table>"!==d[1]||Ht.test(o)?0:a:a.firstChild,s=o&&o.childNodes.length;s--;)ot.nodeName(c=o.childNodes[s],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(ot.merge(p,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=h.lastChild}else p.push(t.createTextNode(o));for(a&&h.removeChild(a),it.appendChecked||ot.grep(m(p,"input"),g),f=0;o=p[f++];)if((!i||-1===ot.inArray(o,i))&&(r=ot.contains(o.ownerDocument,o),a=m(h.appendChild(o),"script"),r&&_(a),n))for(s=0;o=a[s++];)Wt.test(o.type||"")&&n.push(o);return a=null,h},cleanData:function(e,t){for(var n,i,s,o,r=0,a=ot.expando,l=ot.cache,c=it.deleteExpando,d=ot.event.special;null!=(n=e[r]);r++)if((t||ot.acceptData(n))&&(s=n[a],o=s&&l[s])){if(o.events)for(i in o.events)d[i]?ot.event.remove(n,i):ot.removeEvent(n,i,o.handle);l[s]&&(delete l[s],c?delete n[a]:typeof n.removeAttribute!==St?n.removeAttribute(a):n[a]=null,Y.push(s))}}}),ot.fn.extend({text:function(e){return Nt(this,function(e){return void 0===e?ot.text(this):this.empty().append((this[0]&&this[0].ownerDocument||vt).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?ot.filter(e,this):this,s=0;null!=(n=i[s]);s++)t||1!==n.nodeType||ot.cleanData(m(n)),n.parentNode&&(t&&ot.contains(n.ownerDocument,n)&&_(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ot.cleanData(m(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ot.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ot.clone(this,e,t)})},html:function(e){return Nt(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(jt,""):void 0;if(!("string"!=typeof e||Ut.test(e)||!it.htmlSerialize&&It.test(e)||!it.leadingWhitespace&&Rt.test(e)||Gt[(zt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Vt,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(ot.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,ot.cleanData(m(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=G.apply([],e);var n,i,s,o,r,a,l=0,c=this.length,d=this,u=c-1,h=e[0],p=ot.isFunction(h);if(p||c>1&&"string"==typeof h&&!it.checkClone&&Xt.test(h))return this.each(function(n){var i=d.eq(n);p&&(e[0]=h.call(this,n,i.html())),i.domManip(e,t)});if(c&&(a=ot.buildFragment(e,this[0].ownerDocument,!1,this),n=a.firstChild,1===a.childNodes.length&&(a=n),n)){for(o=ot.map(m(a,"script"),y),s=o.length;c>l;l++)i=a,l!==u&&(i=ot.clone(i,!0,!0),s&&ot.merge(o,m(i,"script"))),t.call(this[l],i,l);if(s)for(r=o[o.length-1].ownerDocument,ot.map(o,w),l=0;s>l;l++)i=o[l],Wt.test(i.type||"")&&!ot._data(i,"globalEval")&&ot.contains(r,i)&&(i.src?ot._evalUrl&&ot._evalUrl(i.src):ot.globalEval((i.text||i.textContent||i.innerHTML||"").replace(Kt,"")));a=n=null}return this}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ot.fn[e]=function(e){for(var n,i=0,s=[],o=ot(e),r=o.length-1;r>=i;i++)n=i===r?this:this.clone(!0),ot(o[i])[t](n),Q.apply(s,n.get());return this.pushStack(s)}});var Zt,en={};!function(){var e,t,n=vt.createElement("div"),i="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=n.getElementsByTagName("a")[0],e.style.cssText="float:left;opacity:.5",it.opacity=/^0.5/.test(e.style.opacity),it.cssFloat=!!e.style.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",it.clearCloneStyle="content-box"===n.style.backgroundClip,e=n=null,it.shrinkWrapBlocks=function(){var e,n,s,o;if(null==t){if(e=vt.getElementsByTagName("body")[0],!e)return;o="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",n=vt.createElement("div"),s=vt.createElement("div"),e.appendChild(n).appendChild(s),t=!1,typeof s.style.zoom!==St&&(s.style.cssText=i+";width:1px;padding:1px;zoom:1",s.innerHTML="<div></div>",s.firstChild.style.width="5px",t=3!==s.offsetWidth),e.removeChild(n),e=n=s=null}return t}}();var tn,nn,sn=/^margin/,on=new RegExp("^("+Et+")(?!px)[a-z%]+$","i"),rn=/^(top|right|bottom|left)$/;e.getComputedStyle?(tn=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},nn=function(e,t,n){var i,s,o,r,a=e.style;return n=n||tn(e),r=n?n.getPropertyValue(t)||n[t]:void 0,n&&(""!==r||ot.contains(e.ownerDocument,e)||(r=ot.style(e,t)),on.test(r)&&sn.test(t)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=n.width,a.width=i,a.minWidth=s,a.maxWidth=o)),void 0===r?r:r+""}):vt.documentElement.currentStyle&&(tn=function(e){return e.currentStyle},nn=function(e,t,n){var i,s,o,r,a=e.style;return n=n||tn(e),r=n?n[t]:void 0,null==r&&a&&a[t]&&(r=a[t]),on.test(r)&&!rn.test(t)&&(i=a.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),a.left="fontSize"===t?"1em":r,r=a.pixelLeft+"px",a.left=i,o&&(s.left=o)),void 0===r?r:r+""||"auto"}),!function(){function t(){var t,n,i=vt.getElementsByTagName("body")[0];i&&(t=vt.createElement("div"),n=vt.createElement("div"),t.style.cssText=c,i.appendChild(t).appendChild(n),n.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",ot.swap(i,null!=i.style.zoom?{zoom:1}:{},function(){s=4===n.offsetWidth}),o=!0,r=!1,a=!0,e.getComputedStyle&&(r="1%"!==(e.getComputedStyle(n,null)||{}).top,o="4px"===(e.getComputedStyle(n,null)||{width:"4px"}).width),i.removeChild(t),n=i=null)}var n,i,s,o,r,a,l=vt.createElement("div"),c="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",d="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=l.getElementsByTagName("a")[0],n.style.cssText="float:left;opacity:.5",it.opacity=/^0.5/.test(n.style.opacity),it.cssFloat=!!n.style.cssFloat,l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",it.clearCloneStyle="content-box"===l.style.backgroundClip,n=l=null,ot.extend(it,{reliableHiddenOffsets:function(){if(null!=i)return i;var e,t,n,s=vt.createElement("div"),o=vt.getElementsByTagName("body")[0];return o?(s.setAttribute("className","t"),s.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=vt.createElement("div"),e.style.cssText=c,o.appendChild(e).appendChild(s),s.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t=s.getElementsByTagName("td"),t[0].style.cssText="padding:0;margin:0;border:0;display:none",n=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",i=n&&0===t[0].offsetHeight,o.removeChild(e),s=o=null,i):void 0},boxSizing:function(){return null==s&&t(),s},boxSizingReliable:function(){return null==o&&t(),o},pixelPosition:function(){return null==r&&t(),r},reliableMarginRight:function(){var t,n,i,s;if(null==a&&e.getComputedStyle){if(t=vt.getElementsByTagName("body")[0],!t)return;n=vt.createElement("div"),i=vt.createElement("div"),n.style.cssText=c,t.appendChild(n).appendChild(i),s=i.appendChild(vt.createElement("div")),s.style.cssText=i.style.cssText=d,s.style.marginRight=s.style.width="0",i.style.width="1px",a=!parseFloat((e.getComputedStyle(s,null)||{}).marginRight),t.removeChild(n)}return a}})}(),ot.swap=function(e,t,n,i){var s,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];s=n.apply(e,i||[]);for(o in t)e.style[o]=r[o];return s};var an=/alpha\([^)]*\)/i,ln=/opacity\s*=\s*([^)]*)/,cn=/^(none|table(?!-c[ea]).+)/,dn=new RegExp("^("+Et+")(.*)$","i"),un=new RegExp("^([+-])=("+Et+")","i"),hn={position:"absolute",visibility:"hidden",display:"block"},pn={letterSpacing:0,fontWeight:400},fn=["Webkit","O","Moz","ms"];ot.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":it.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,r,a=ot.camelCase(t),l=e.style;if(t=ot.cssProps[a]||(ot.cssProps[a]=E(l,a)),r=ot.cssHooks[t]||ot.cssHooks[a],void 0===n)return r&&"get"in r&&void 0!==(s=r.get(e,!1,i))?s:l[t];if(o=typeof n,"string"===o&&(s=un.exec(n))&&(n=(s[1]+1)*s[2]+parseFloat(ot.css(e,t)),o="number"),null!=n&&n===n&&("number"!==o||ot.cssNumber[a]||(n+="px"),it.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(r&&"set"in r&&void 0===(n=r.set(e,n,i)))))try{l[t]="",l[t]=n}catch(c){}}},css:function(e,t,n,i){var s,o,r,a=ot.camelCase(t);return t=ot.cssProps[a]||(ot.cssProps[a]=E(e.style,a)),r=ot.cssHooks[t]||ot.cssHooks[a],r&&"get"in r&&(o=r.get(e,!0,n)),void 0===o&&(o=nn(e,t,i)),"normal"===o&&t in pn&&(o=pn[t]),""===n||n?(s=parseFloat(o),n===!0||ot.isNumeric(s)?s||0:o):o}}),ot.each(["height","width"],function(e,t){ot.cssHooks[t]={get:function(e,n,i){return n?0===e.offsetWidth&&cn.test(ot.css(e,"display"))?ot.swap(e,hn,function(){return M(e,t,i)}):M(e,t,i):void 0},set:function(e,n,i){var s=i&&tn(e);return F(e,n,i?N(e,t,i,it.boxSizing()&&"border-box"===ot.css(e,"boxSizing",!1,s),s):0)}}}),it.opacity||(ot.cssHooks.opacity={get:function(e,t){return ln.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,s=ot.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===ot.trim(o.replace(an,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=an.test(o)?o.replace(an,s):o+" "+s)}}),ot.cssHooks.marginRight=T(it.reliableMarginRight,function(e,t){return t?ot.swap(e,{display:"inline-block"},nn,[e,"marginRight"]):void 0}),ot.each({margin:"",padding:"",border:"Width"},function(e,t){ot.cssHooks[e+t]={expand:function(n){for(var i=0,s={},o="string"==typeof n?n.split(" "):[n];4>i;i++)s[e+At[i]+t]=o[i]||o[i-2]||o[0];return s}},sn.test(e)||(ot.cssHooks[e+t].set=F)}),ot.fn.extend({css:function(e,t){return Nt(this,function(e,t,n){var i,s,o={},r=0;if(ot.isArray(t)){for(i=tn(e),s=t.length;s>r;r++)o[t[r]]=ot.css(e,t[r],!1,i);return o}return void 0!==n?ot.style(e,t,n):ot.css(e,t)},e,t,arguments.length>1)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ft(this)?ot(this).show():ot(this).hide()})}}),ot.Tween=$,$.prototype={constructor:$,init:function(e,t,n,i,s,o){this.elem=e,this.prop=n,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(ot.cssNumber[n]?"":"px")},cur:function(){var e=$.propHooks[this.prop];return e&&e.get?e.get(this):$.propHooks._default.get(this)},run:function(e){var t,n=$.propHooks[this.prop];return this.pos=t=this.options.duration?ot.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):$.propHooks._default.set(this),this}},$.prototype.init.prototype=$.prototype,$.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ot.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ot.fx.step[e.prop]?ot.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ot.cssProps[e.prop]]||ot.cssHooks[e.prop])?ot.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},$.propHooks.scrollTop=$.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ot.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ot.fx=$.prototype.init,ot.fx.step={};var vn,mn,gn=/^(?:toggle|show|hide)$/,bn=new RegExp("^(?:([+-])=|)("+Et+")([a-z%]*)$","i"),yn=/queueHooks$/,wn=[B],_n={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),s=bn.exec(t),o=s&&s[3]||(ot.cssNumber[e]?"":"px"),r=(ot.cssNumber[e]||"px"!==o&&+i)&&bn.exec(ot.css(n.elem,e)),a=1,l=20;if(r&&r[3]!==o){o=o||r[3],s=s||[],r=+i||1;do a=a||".5",r/=a,ot.style(n.elem,e,r+o);while(a!==(a=n.cur()/i)&&1!==a&&--l)}return s&&(r=n.start=+r||+i||0,n.unit=o,n.end=s[1]?r+(s[1]+1)*s[2]:+s[2]),n}]};ot.Animation=ot.extend(j,{tweener:function(e,t){ot.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,s=e.length;s>i;i++)n=e[i],_n[n]=_n[n]||[],_n[n].unshift(t)},prefilter:function(e,t){t?wn.unshift(e):wn.push(e)}}),ot.speed=function(e,t,n){var i=e&&"object"==typeof e?ot.extend({},e):{complete:n||!n&&t||ot.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ot.isFunction(t)&&t};return i.duration=ot.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ot.fx.speeds?ot.fx.speeds[i.duration]:ot.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){ot.isFunction(i.old)&&i.old.call(this),i.queue&&ot.dequeue(this,i.queue)},i},ot.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ft).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var s=ot.isEmptyObject(e),o=ot.speed(t,n,i),r=function(){var t=j(this,ot.extend({},e),o);(s||ot._data(this,"finish"))&&t.stop(!0)};return r.finish=r,s||o.queue===!1?this.each(r):this.queue(o.queue,r)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",o=ot.timers,r=ot._data(this);if(s)r[s]&&r[s].stop&&i(r[s]);else for(s in r)r[s]&&r[s].stop&&yn.test(s)&&i(r[s]);for(s=o.length;s--;)o[s].elem!==this||null!=e&&o[s].queue!==e||(o[s].anim.stop(n),t=!1,o.splice(s,1));(t||!n)&&ot.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=ot._data(this),i=n[e+"queue"],s=n[e+"queueHooks"],o=ot.timers,r=i?i.length:0;for(n.finish=!0,ot.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;r>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),ot.each(["toggle","show","hide"],function(e,t){var n=ot.fn[t];ot.fn[t]=function(e,i,s){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(L(t,!0),e,i,s)}}),ot.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ot.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),ot.timers=[],ot.fx.tick=function(){var e,t=ot.timers,n=0;for(vn=ot.now();n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||ot.fx.stop(),vn=void 0},ot.fx.timer=function(e){ot.timers.push(e),e()?ot.fx.start():ot.timers.pop()},ot.fx.interval=13,ot.fx.start=function(){mn||(mn=setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){clearInterval(mn),mn=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fn.delay=function(e,t){return e=ot.fx?ot.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e,t,n,i,s=vt.createElement("div");s.setAttribute("className","t"),s.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=s.getElementsByTagName("a")[0],n=vt.createElement("select"),i=n.appendChild(vt.createElement("option")),t=s.getElementsByTagName("input")[0],e.style.cssText="top:1px",it.getSetAttribute="t"!==s.className,it.style=/top/.test(e.getAttribute("style")),it.hrefNormalized="/a"===e.getAttribute("href"),it.checkOn=!!t.value,it.optSelected=i.selected,it.enctype=!!vt.createElement("form").enctype,n.disabled=!0,it.optDisabled=!i.disabled,t=vt.createElement("input"),t.setAttribute("value",""),it.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),it.radioValue="t"===t.value,e=t=n=i=s=null}();var xn=/\r/g;ot.fn.extend({val:function(e){var t,n,i,s=this[0];return arguments.length?(i=ot.isFunction(e),this.each(function(n){var s;1===this.nodeType&&(s=i?e.call(this,n,ot(this).val()):e,null==s?s="":"number"==typeof s?s+="":ot.isArray(s)&&(s=ot.map(s,function(e){return null==e?"":e+""})),t=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))})):s?(t=ot.valHooks[s.type]||ot.valHooks[s.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(s,"value"))?n:(n=s.value,"string"==typeof n?n.replace(xn,""):null==n?"":n)):void 0}}),ot.extend({valHooks:{option:{get:function(e){var t=ot.find.attr(e,"value");return null!=t?t:ot.text(e)}},select:{get:function(e){for(var t,n,i=e.options,s=e.selectedIndex,o="select-one"===e.type||0>s,r=o?null:[],a=o?s+1:i.length,l=0>s?a:o?s:0;a>l;l++)if(n=i[l],!(!n.selected&&l!==s||(it.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ot.nodeName(n.parentNode,"optgroup"))){if(t=ot(n).val(),o)return t;r.push(t)}return r},set:function(e,t){for(var n,i,s=e.options,o=ot.makeArray(t),r=s.length;r--;)if(i=s[r],ot.inArray(ot.valHooks.option.get(i),o)>=0)try{i.selected=n=!0}catch(a){i.scrollHeight}else i.selected=!1;return n||(e.selectedIndex=-1),s}}}}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(e,t){return ot.isArray(t)?e.checked=ot.inArray(ot(e).val(),t)>=0:void 0}},it.checkOn||(ot.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var kn,Sn,Cn=ot.expr.attrHandle,Tn=/^(?:checked|selected)$/i,En=it.getSetAttribute,An=it.input;ot.fn.extend({attr:function(e,t){return Nt(this,ot.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ot.removeAttr(this,e)})}}),ot.extend({attr:function(e,t,n){var i,s,o=e.nodeType;return e&&3!==o&&8!==o&&2!==o?typeof e.getAttribute===St?ot.prop(e,t,n):(1===o&&ot.isXMLDoc(e)||(t=t.toLowerCase(),i=ot.attrHooks[t]||(ot.expr.match.bool.test(t)?Sn:kn)),void 0===n?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=ot.find.attr(e,t),null==s?void 0:s):null!==n?i&&"set"in i&&void 0!==(s=i.set(e,n,t))?s:(e.setAttribute(t,n+""),n):void ot.removeAttr(e,t)):void 0},removeAttr:function(e,t){var n,i,s=0,o=t&&t.match(wt);if(o&&1===e.nodeType)for(;n=o[s++];)i=ot.propFix[n]||n,ot.expr.match.bool.test(n)?An&&En||!Tn.test(n)?e[i]=!1:e[ot.camelCase("default-"+n)]=e[i]=!1:ot.attr(e,n,""),e.removeAttribute(En?n:i)},attrHooks:{type:{set:function(e,t){if(!it.radioValue&&"radio"===t&&ot.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),Sn={set:function(e,t,n){return t===!1?ot.removeAttr(e,n):An&&En||!Tn.test(n)?e.setAttribute(!En&&ot.propFix[n]||n,n):e[ot.camelCase("default-"+n)]=e[n]=!0,n}},ot.each(ot.expr.match.bool.source.match(/\w+/g),function(e,t){var n=Cn[t]||ot.find.attr;Cn[t]=An&&En||!Tn.test(t)?function(e,t,i){var s,o;return i||(o=Cn[t],Cn[t]=s,s=null!=n(e,t,i)?t.toLowerCase():null,Cn[t]=o),s}:function(e,t,n){return n?void 0:e[ot.camelCase("default-"+t)]?t.toLowerCase():null}}),An&&En||(ot.attrHooks.value={set:function(e,t,n){return ot.nodeName(e,"input")?void(e.defaultValue=t):kn&&kn.set(e,t,n)}}),En||(kn={set:function(e,t,n){var i=e.getAttributeNode(n);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},Cn.id=Cn.name=Cn.coords=function(e,t,n){var i;return n?void 0:(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},ot.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:kn.set},ot.attrHooks.contenteditable={set:function(e,t,n){kn.set(e,""===t?!1:t,n)}},ot.each(["width","height"],function(e,t){ot.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),it.style||(ot.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Fn=/^(?:input|select|textarea|button|object)$/i,Nn=/^(?:a|area)$/i;ot.fn.extend({prop:function(e,t){return Nt(this,ot.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ot.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),ot.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,s,o,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?(o=1!==r||!ot.isXMLDoc(e),o&&(t=ot.propFix[t]||t,s=ot.propHooks[t]),void 0!==n?s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:e[t]=n:s&&"get"in s&&null!==(i=s.get(e,t))?i:e[t]):void 0},propHooks:{tabIndex:{get:function(e){var t=ot.find.attr(e,"tabindex");return t?parseInt(t,10):Fn.test(e.nodeName)||Nn.test(e.nodeName)&&e.href?0:-1}}}}),it.hrefNormalized||ot.each(["href","src"],function(e,t){ot.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),it.optSelected||(ot.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this}),it.enctype||(ot.propFix.enctype="encoding");var Mn=/[\t\r\n\f]/g;ot.fn.extend({addClass:function(e){var t,n,i,s,o,r,a=0,l=this.length,c="string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(wt)||[];l>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Mn," "):" ")){for(o=0;s=t[o++];)i.indexOf(" "+s+" ")<0&&(i+=s+" ");r=ot.trim(i),n.className!==r&&(n.className=r)}return this},removeClass:function(e){var t,n,i,s,o,r,a=0,l=this.length,c=0===arguments.length||"string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(wt)||[];l>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Mn," "):"")){for(o=0;s=t[o++];)for(;i.indexOf(" "+s+" ")>=0;)i=i.replace(" "+s+" "," ");r=e?ot.trim(i):"",n.className!==r&&(n.className=r)}return this
},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(ot.isFunction(e)?function(n){ot(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,s=ot(this),o=e.match(wt)||[];t=o[i++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else(n===St||"boolean"===n)&&(this.className&&ot._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ot._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Mn," ").indexOf(t)>=0)return!0;return!1}}),ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ot.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),ot.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var $n=ot.now(),Pn=/\?/,Ln=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;ot.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,i=null,s=ot.trim(t+"");return s&&!ot.trim(s.replace(Ln,function(e,t,s,o){return n&&t&&(i=0),0===i?e:(n=s||t,i+=!o-!s,"")}))?Function("return "+s)():ot.error("Invalid JSON: "+t)},ot.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new DOMParser,n=i.parseFromString(t,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(s){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||ot.error("Invalid XML: "+t),n};var On,Bn,Dn=/#.*$/,jn=/([?&])_=[^&]*/,In=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Rn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Vn=/^(?:GET|HEAD)$/,zn=/^\/\//,Hn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,qn={},Un={},Xn="*/".concat("*");try{Bn=location.href}catch(Wn){Bn=vt.createElement("a"),Bn.href="",Bn=Bn.href}On=Hn.exec(Bn.toLowerCase())||[],ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Bn,type:"GET",isLocal:Rn.test(On[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?V(V(e,ot.ajaxSettings),t):V(ot.ajaxSettings,e)},ajaxPrefilter:I(qn),ajaxTransport:I(Un),ajax:function(e,t){function n(e,t,n,i){var s,d,g,b,w,x=t;2!==y&&(y=2,a&&clearTimeout(a),c=void 0,r=i||"",_.readyState=e>0?4:0,s=e>=200&&300>e||304===e,n&&(b=z(u,_,n)),b=H(u,b,_,s),s?(u.ifModified&&(w=_.getResponseHeader("Last-Modified"),w&&(ot.lastModified[o]=w),w=_.getResponseHeader("etag"),w&&(ot.etag[o]=w)),204===e||"HEAD"===u.type?x="nocontent":304===e?x="notmodified":(x=b.state,d=b.data,g=b.error,s=!g)):(g=x,(e||!x)&&(x="error",0>e&&(e=0))),_.status=e,_.statusText=(t||x)+"",s?f.resolveWith(h,[d,x,_]):f.rejectWith(h,[_,x,g]),_.statusCode(m),m=void 0,l&&p.trigger(s?"ajaxSuccess":"ajaxError",[_,u,s?d:g]),v.fireWith(h,[_,x]),l&&(p.trigger("ajaxComplete",[_,u]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,s,o,r,a,l,c,d,u=ot.ajaxSetup({},t),h=u.context||u,p=u.context&&(h.nodeType||h.jquery)?ot(h):ot.event,f=ot.Deferred(),v=ot.Callbacks("once memory"),m=u.statusCode||{},g={},b={},y=0,w="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!d)for(d={};t=In.exec(r);)d[t[1].toLowerCase()]=t[2];t=d[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?r:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=b[n]=b[n]||e,g[e]=t),this},overrideMimeType:function(e){return y||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)m[t]=[m[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||w;return c&&c.abort(t),n(0,t),this}};if(f.promise(_).complete=v.add,_.success=_.done,_.error=_.fail,u.url=((e||u.url||Bn)+"").replace(Dn,"").replace(zn,On[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=ot.trim(u.dataType||"*").toLowerCase().match(wt)||[""],null==u.crossDomain&&(i=Hn.exec(u.url.toLowerCase()),u.crossDomain=!(!i||i[1]===On[1]&&i[2]===On[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(On[3]||("http:"===On[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=ot.param(u.data,u.traditional)),R(qn,u,t,_),2===y)return _;l=u.global,l&&0===ot.active++&&ot.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!Vn.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(Pn.test(o)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=jn.test(o)?o.replace(jn,"$1_="+$n++):o+(Pn.test(o)?"&":"?")+"_="+$n++)),u.ifModified&&(ot.lastModified[o]&&_.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&_.setRequestHeader("If-None-Match",ot.etag[o])),(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",u.contentType),_.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Xn+"; q=0.01":""):u.accepts["*"]);for(s in u.headers)_.setRequestHeader(s,u.headers[s]);if(u.beforeSend&&(u.beforeSend.call(h,_,u)===!1||2===y))return _.abort();w="abort";for(s in{success:1,error:1,complete:1})_[s](u[s]);if(c=R(Un,u,t,_)){_.readyState=1,l&&p.trigger("ajaxSend",[_,u]),u.async&&u.timeout>0&&(a=setTimeout(function(){_.abort("timeout")},u.timeout));try{y=1,c.send(g,n)}catch(x){if(!(2>y))throw x;n(-1,x)}}else n(-1,"No Transport");return _},getJSON:function(e,t,n){return ot.get(e,t,n,"json")},getScript:function(e,t){return ot.get(e,void 0,t,"script")}}),ot.each(["get","post"],function(e,t){ot[t]=function(e,n,i,s){return ot.isFunction(n)&&(s=s||i,i=n,n=void 0),ot.ajax({url:e,type:t,dataType:s,data:n,success:i})}}),ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ot.fn[t]=function(e){return this.on(t,e)}}),ot._evalUrl=function(e){return ot.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},ot.fn.extend({wrapAll:function(e){if(ot.isFunction(e))return this.each(function(t){ot(this).wrapAll(e.call(this,t))});if(this[0]){var t=ot(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(ot.isFunction(e)?function(t){ot(this).wrapInner(e.call(this,t))}:function(){var t=ot(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ot.isFunction(e);return this.each(function(n){ot(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}}),ot.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!it.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||ot.css(e,"display"))},ot.expr.filters.visible=function(e){return!ot.expr.filters.hidden(e)};var Yn=/%20/g,Kn=/\[\]$/,Gn=/\r?\n/g,Qn=/^(?:submit|button|image|reset|file)$/i,Jn=/^(?:input|select|textarea|keygen)/i;ot.param=function(e,t){var n,i=[],s=function(e,t){t=ot.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(e)||e.jquery&&!ot.isPlainObject(e))ot.each(e,function(){s(this.name,this.value)});else for(n in e)q(n,e[n],t,s);return i.join("&").replace(Yn,"+")},ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ot.prop(this,"elements");return e?ot.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ot(this).is(":disabled")&&Jn.test(this.nodeName)&&!Qn.test(e)&&(this.checked||!Mt.test(e))}).map(function(e,t){var n=ot(this).val();return null==n?null:ot.isArray(n)?ot.map(n,function(e){return{name:t.name,value:e.replace(Gn,"\r\n")}}):{name:t.name,value:n.replace(Gn,"\r\n")}}).get()}}),ot.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&U()||X()}:U;var Zn=0,ei={},ti=ot.ajaxSettings.xhr();e.ActiveXObject&&ot(e).on("unload",function(){for(var e in ei)ei[e](void 0,!0)}),it.cors=!!ti&&"withCredentials"in ti,ti=it.ajax=!!ti,ti&&ot.ajaxTransport(function(e){if(!e.crossDomain||it.cors){var t;return{send:function(n,i){var s,o=e.xhr(),r=++Zn;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)o[s]=e.xhrFields[s];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(s in n)void 0!==n[s]&&o.setRequestHeader(s,n[s]+"");o.send(e.hasContent&&e.data||null),t=function(n,s){var a,l,c;if(t&&(s||4===o.readyState))if(delete ei[r],t=void 0,o.onreadystatechange=ot.noop,s)4!==o.readyState&&o.abort();else{c={},a=o.status,"string"==typeof o.responseText&&(c.text=o.responseText);try{l=o.statusText}catch(d){l=""}a||!e.isLocal||e.crossDomain?1223===a&&(a=204):a=c.text?200:404}c&&i(a,l,c,o.getAllResponseHeaders())},e.async?4===o.readyState?setTimeout(t):o.onreadystatechange=ei[r]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ot.globalEval(e),e}}}),ot.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ot.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=vt.head||ot("head")[0]||vt.documentElement;return{send:function(i,s){t=vt.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||s(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var ni=[],ii=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ni.pop()||ot.expando+"_"+$n++;return this[e]=!0,e}}),ot.ajaxPrefilter("json jsonp",function(t,n,i){var s,o,r,a=t.jsonp!==!1&&(ii.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(s=t.jsonpCallback=ot.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(ii,"$1"+s):t.jsonp!==!1&&(t.url+=(Pn.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return r||ot.error(s+" was not called"),r[0]},t.dataTypes[0]="json",o=e[s],e[s]=function(){r=arguments},i.always(function(){e[s]=o,t[s]&&(t.jsonpCallback=n.jsonpCallback,ni.push(s)),r&&ot.isFunction(o)&&o(r[0]),r=o=void 0}),"script"):void 0}),ot.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||vt;var i=ht.exec(e),s=!n&&[];return i?[t.createElement(i[1])]:(i=ot.buildFragment([e],t,s),s&&s.length&&ot(s).remove(),ot.merge([],i.childNodes))};var si=ot.fn.load;ot.fn.load=function(e,t,n){if("string"!=typeof e&&si)return si.apply(this,arguments);var i,s,o,r=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),ot.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),r.length>0&&ot.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){s=arguments,r.html(i?ot("<div>").append(ot.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){r.each(n,s||[e.responseText,t,e])}),this},ot.expr.filters.animated=function(e){return ot.grep(ot.timers,function(t){return e===t.elem}).length};var oi=e.document.documentElement;ot.offset={setOffset:function(e,t,n){var i,s,o,r,a,l,c,d=ot.css(e,"position"),u=ot(e),h={};"static"===d&&(e.style.position="relative"),a=u.offset(),o=ot.css(e,"top"),l=ot.css(e,"left"),c=("absolute"===d||"fixed"===d)&&ot.inArray("auto",[o,l])>-1,c?(i=u.position(),r=i.top,s=i.left):(r=parseFloat(o)||0,s=parseFloat(l)||0),ot.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(h.top=t.top-a.top+r),null!=t.left&&(h.left=t.left-a.left+s),"using"in t?t.using.call(e,h):u.css(h)}},ot.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ot.offset.setOffset(this,e,t)});var t,n,i={top:0,left:0},s=this[0],o=s&&s.ownerDocument;return o?(t=o.documentElement,ot.contains(t,s)?(typeof s.getBoundingClientRect!==St&&(i=s.getBoundingClientRect()),n=W(o),{top:i.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i):void 0},position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===ot.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ot.nodeName(e[0],"html")||(n=e.offset()),n.top+=ot.css(e[0],"borderTopWidth",!0),n.left+=ot.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-ot.css(i,"marginTop",!0),left:t.left-n.left-ot.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||oi;e&&!ot.nodeName(e,"html")&&"static"===ot.css(e,"position");)e=e.offsetParent;return e||oi})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);ot.fn[e]=function(i){return Nt(this,function(e,i,s){var o=W(e);return void 0===s?o?t in o?o[t]:o.document.documentElement[i]:e[i]:void(o?o.scrollTo(n?ot(o).scrollLeft():s,n?s:ot(o).scrollTop()):e[i]=s)},e,i,arguments.length,null)}}),ot.each(["top","left"],function(e,t){ot.cssHooks[t]=T(it.pixelPosition,function(e,n){return n?(n=nn(e,t),on.test(n)?ot(e).position()[t]+"px":n):void 0})}),ot.each({Height:"height",Width:"width"},function(e,t){ot.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){ot.fn[i]=function(i,s){var o=arguments.length&&(n||"boolean"!=typeof i),r=n||(i===!0||s===!0?"margin":"border");return Nt(this,function(t,n,i){var s;return ot.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===i?ot.css(t,n,r):ot.style(t,n,i,r)},t,o?i:void 0,o,null)}})}),ot.fn.size=function(){return this.length},ot.fn.andSelf=ot.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot});var ri=e.jQuery,ai=e.$;return ot.noConflict=function(t){return e.$===ot&&(e.$=ai),t&&e.jQuery===ot&&(e.jQuery=ri),ot},typeof t===St&&(e.jQuery=e.$=ot),ot}),define("jQuery",function(e){return function(){var t;return t||e.$}}(this)),function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jQuery","exports"],function(n,i,s){e.Backbone=t(e,s,n,i)});else if("undefined"!=typeof exports){var n,i=require("underscore");try{n=require("jquery")}catch(s){}t(e,exports,i,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){{var s=e.Backbone,o=[],r=(o.push,o.slice);o.splice}t.VERSION="1.1.1",t.$=i,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!c(this,"once",e,[t,i])||!t)return this;var s=this,o=n.once(function(){s.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,i)},off:function(e,t,i){var s,o,r,a,l,d,u,h;if(!this._events||!c(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events=void 0,this;for(a=e?[e]:n.keys(this._events),l=0,d=a.length;d>l;l++)if(e=a[l],r=this._events[e]){if(this._events[e]=s=[],t||i)for(u=0,h=r.length;h>u;u++)o=r[u],(t&&t!==o.callback&&t!==o.callback._callback||i&&i!==o.context)&&s.push(o);s.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&d(n,t),i&&d(i,arguments),this},stopListening:function(e,t,i){var s=this._listeningTo;if(!s)return this;var o=!t&&!i;i||"object"!=typeof t||(i=this),e&&((s={})[e._listenId]=e);for(var r in s)e=s[r],e.off(t,i,this),(o||n.isEmpty(e._events))&&delete this._listeningTo[r];return this}},l=/\s+/,c=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var s in n)e[t].apply(e,[s,n[s]].concat(i));return!1}if(l.test(n)){for(var o=n.split(l),r=0,a=o.length;a>r;r++)e[t].apply(e,[o[r]].concat(i));return!1}return!0},d=function(e,t){var n,i=-1,s=e.length,o=t[0],r=t[1],a=t[2];switch(t.length){case 0:for(;++i<s;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<s;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<s;)(n=e[i]).callback.call(n.ctx,o,r);return;case 3:for(;++i<s;)(n=e[i]).callback.call(n.ctx,o,r,a);return;default:for(;++i<s;)(n=e[i]).callback.apply(n.ctx,t);return}},u={listenTo:"on",listenToOnce:"once"};n.each(u,function(e,t){a[t]=function(t,i,s){var o=this._listeningTo||(this._listeningTo={}),r=t._listenId||(t._listenId=n.uniqueId("l"));return o[r]=t,s||"object"!=typeof i||(s=this),t[e](i,s,this),this}}),a.bind=a.on,a.unbind=a.off,n.extend(t,a);var h=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var s,o,r,a,l,c,d,u;if(null==e)return this;if("object"==typeof e?(o=e,i=t):(o={})[e]=t,i||(i={}),!this._validate(o,i))return!1;r=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),u=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(s in o)t=o[s],n.isEqual(u[s],t)||a.push(s),n.isEqual(d[s],t)?delete this.changed[s]:this.changed[s]=t,r?delete u[s]:u[s]=t;if(!l){a.length&&(this._pending=i);for(var h=0,p=a.length;p>h;h++)this.trigger("change:"+a[h],this,u[a[h]],i)}if(c)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,s=this._changing?this._previousAttributes:this.attributes;for(var o in e)n.isEqual(s[o],t=e[o])||((i||(i={}))[o]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},D(this,e),this.sync("read",this,e)},save:function(e,t,i){var s,o,r,a=this.attributes;if(null==e||"object"==typeof e?(s=e,i=t):(s={})[e]=t,i=n.extend({validate:!0},i),s&&!i.wait){if(!this.set(s,i))return!1}else if(!this._validate(s,i))return!1;s&&i.wait&&(this.attributes=n.extend({},a,s)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=n.extend(s||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},D(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=s),r=this.sync(o,this,i),s&&i.wait&&(this.attributes=a),r},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&s(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;D(this,e);var o=this.sync("delete",this,e);return e.wait||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||B();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(e){h.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,m))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var s,o,r,a;for(s=0,o=e.length;o>s;s++)a=e[s]=this.get(e[s]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,t.silent||(t.index=r,a.trigger("remove",a,this,t)),this._removeReference(a,t));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,v),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var s,o,r,a,l,c,d,u=t.at,p=this.model,f=this.comparator&&null==u&&t.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,g=[],b=[],y={},w=t.add,_=t.merge,x=t.remove,k=!f&&w&&x?[]:!1;for(s=0,o=e.length;o>s;s++){if(l=e[s]||{},r=l instanceof h?a=l:l[p.prototype.idAttribute||"id"],c=this.get(r))x&&(y[c.cid]=!0),_&&(l=l===a?a.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),f&&!d&&c.hasChanged(m)&&(d=!0)),e[s]=c;else if(w){if(a=e[s]=this._prepareModel(l,t),!a)continue;g.push(a),this._addReference(a,t)}a=c||a,!k||!a.isNew()&&y[a.id]||k.push(a),y[a.id]=!0}if(x){for(s=0,o=this.length;o>s;++s)y[(a=this.models[s]).cid]||b.push(a);b.length&&this.remove(b,t)}if(g.length||k&&k.length)if(f&&(d=!0),this.length+=g.length,null!=u)for(s=0,o=g.length;o>s;s++)this.models.splice(u+s,0,g[s]);else{k&&(this.models.length=0);var S=k||g;for(s=0,o=S.length;o>s;s++)this.models.push(S[s])}if(d&&this.sort({silent:!0}),!t.silent){for(s=0,o=g.length;o>s;s++)(a=g[s]).trigger("add",a,this,t);(d||k&&k.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,s=this.models.length;s>i;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var s=e.reset?"reset":"set";i[s](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},D(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,s=t.success;return t.success=function(e,n){t.wait&&i.add(e,t),s&&s(e,n,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(g,function(e){f.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var b=["groupBy","countBy","sortBy","indexBy"];n.each(b,function(e){f.prototype[e]=function(t,i){var s=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,s,i)}});var y=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];n.extend(y.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var s=t.match(w),o=s[1],r=s[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,i):this.$el.on(o,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,s){var o=k[e];n.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:o,dataType:"json"};if(s.url||(r.url=n.result(i,"url")||B()),null!=s.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(s.attrs||i.toJSON(s))),s.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),s.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",s.emulateJSON&&(r.data._method=o);var a=s.beforeSend;s.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||s.emulateJSON||(r.processData=!1),"PATCH"===r.type&&x&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=t.ajax(n.extend(r,s));return i.trigger("request",i,l,s),l};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,E=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(S.prototype,a,{initialize:function(){},route:function(e,i,s){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var o=this;return t.history.route(e,function(n){var r=o._extractParameters(e,n);o.execute(s,r),o.trigger.apply(o,["route:"+i].concat(r)),o.trigger("route",i,r),t.history.trigger("route",o,i,r)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/?]+)"}).replace(E,"([^?]*?)"),new RegExp("^"+e+"(?:\\?(.*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var F=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,$=/msie [\w.]+/,P=/\/$/,L=/#.*$/;F.started=!1,n.extend(F.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(P,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(N,"")},start:function(e){if(F.started)throw new Error("Backbone.history has already been started");F.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);
var i=this.getFragment(),s=document.documentMode,o=$.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);if(this.root=("/"+this.root+"/").replace(M,"/"),o&&this._wantsHashChange){var r=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=r.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),F.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!F.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(L,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new F;var O=function(e,t){var i,s=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},n.extend(i,s,t);var o=function(){this.constructor=i};return o.prototype=s.prototype,i.prototype=new o,e&&n.extend(i.prototype,e),i.__super__=s.prototype,i};h.extend=f.extend=S.extend=y.extend=F.extend=O;var B=function(){throw new Error('A "url" property or function must be specified')},D=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),define("bb.domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=d;l&&t.length&&(d=[],e(t))}function n(){l||(l=!0,r&&clearInterval(r),t())}function i(e){return l?e(c):d.push(e),i}var s,o,r,a="undefined"!=typeof window&&window.document,l=!a,c=a?document:null,d=[];if(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{s=null===window.frameElement}catch(u){}o.doScroll&&s&&window.external&&(r=setInterval(function(){try{o.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return i.version="2.0.1",i.load=function(e,t,n,s){s.isBuild?n(null):i(n)},i}),function(){var e={};!function(){function t(e,n,i){var s=function(){};s.prototype=e.prototype;var o=new s,r=/xyz/.test(function(){})?/\bparent\b/:/.*/;i=i||{};for(var a in i){var l=i[a],c=o[a];o[a]="function"==typeof c&&"function"==typeof l&&r.test(l)?function(e,t){return function(){var n=this.parent;this.parent=t;var i=e.apply(this,arguments);return this.parent=n,i}}(l,c):l}o.typename=n;var d=function(){o.init&&o.init.apply(this,arguments)};return d.prototype=o,d.prototype.constructor=d,d.extend=function(e,n){return"object"==typeof e&&(n=e,e="anonymous"),t(d,e,n)},d}e.object=t(Object,"Object",{})}(),function(){var t=Array.prototype,n=Object.prototype,i={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},s=function(e){return i[e]},o=e.lib={};o.withPrettyErrors=function(e,t,n){try{return n()}catch(i){if(i.Update||(i=new o.TemplateError(i)),i.Update(e),!t){var s=i;i=new Error(s.message),i.name=s.name}throw i}},o.TemplateError=function(e,t,n){var i=this;return e instanceof Error?(i=e,e=e.name+": "+e.message):Error.captureStackTrace&&Error.captureStackTrace(i),i.name="Template render error",i.message=e,i.lineno=t,i.colno=n,i.firstUpdate=!0,i.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},i},o.TemplateError.prototype=Error.prototype,o.escape=function(e){return e.replace(/[&"'<>]/g,s)},o.isFunction=function(e){return"[object Function]"==n.toString.call(e)},o.isArray=Array.isArray||function(e){return"[object Array]"==n.toString.call(e)},o.isString=function(e){return"[object String]"==n.toString.call(e)},o.isObject=function(e){return e===Object(e)},o.groupBy=function(e,t){for(var n={},i=o.isFunction(t)?t:function(e){return e[t]},s=0;s<e.length;s++){var r=e[s],a=i(r,s);(n[a]||(n[a]=[])).push(r)}return n},o.toArray=function(e){return Array.prototype.slice.call(e)},o.without=function(e){var t=[];if(!e)return t;for(var n=-1,i=e.length,s=o.toArray(arguments).slice(1);++n<i;)-1===s.indexOf(e[n])&&t.push(e[n]);return t},o.extend=function(e,t){for(var n in t)e[n]=t[n];return e},o.repeat=function(e,t){for(var n="",i=0;t>i;i++)n+=e;return n},o.each=function(e,n,i){if(null!=e)if(t.each&&e.each==t.each)e.forEach(n,i);else if(e.length===+e.length)for(var s=0,o=e.length;o>s;s++)n.call(i,e[s],s,e)},o.map=function(e,n){var i=[];if(null==e)return i;if(t.map&&e.map===t.map)return e.map(n);for(var s=0;s<e.length;s++)i[i.length]=n(e[s],s);return e.length===+e.length&&(i.length=e.length),i},o.asyncIter=function(e,t,n){function i(){s++,s<e.length?t(e[s],s,i,n):n()}var s=-1;i()},o.asyncFor=function(e,t,n){function i(){a++;var o=s[a];r>a?t(o,e[o],a,r,i):n()}var s=o.keys(e),r=s.length,a=-1;i()},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(null==e)throw new TypeError;var n=Object(e),i=n.length>>>0;if(0===i)return-1;var s=0;if(arguments.length>2&&(s=Number(arguments[2]),s!=s?s=0:0!=s&&1/0!=s&&s!=-1/0&&(s=(s>0||-1)*Math.floor(Math.abs(s)))),s>=i)return-1;for(var o=s>=0?s:Math.max(i-Math.abs(s),0);i>o;o++)if(o in n&&n[o]===t)return o;return-1}),Array.prototype.map||(Array.prototype.map=function(){throw new Error("map is unimplemented for this js engine")}),o.keys=function(e){if(Object.prototype.keys)return e.keys();var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}}(),function(){function t(e,t,n){e instanceof t&&n.push(e),e instanceof r&&e.findAll(t,n)}function n(e,t){function o(e,t,n){for(var s=e.split("\n"),o=0;o<s.length;o++){if(s[o]&&(n&&o>0||!n))for(var r=0;t>r;r++)i.print(" ");o===s.length-1?i.print(s[o]):i.puts(s[o])}}if(t=t||0,o(e.typename+": ",t),e instanceof l)o("\n"),s.each(e.children,function(e){n(e,t+2)});else if(e instanceof et)o(e.extName+"."+e.prop),o("\n"),e.args&&n(e.args,t+2),e.contentArgs&&s.each(e.contentArgs,function(e){n(e,t+2)});else{var a=null,c=null;if(e.iterFields(function(e,t){e instanceof r?(a=a||{},a[t]=e):(c=c||{},c[t]=e)}),c?o(i.inspect(c,!0,null)+"\n",null,!0):o("\n"),a)for(var d in a)n(a[d],t+2)}}var i=e.util,s=e.lib,o=e.object,r=o.extend("Node",{init:function(e,t){this.lineno=e,this.colno=t;for(var n=this.fields,i=0,s=n.length;s>i;i++){var o=n[i],r=arguments[i+2];void 0===r&&(r=null),this[o]=r}},findAll:function(e,n){if(n=n||[],this instanceof l)for(var i=this.children,s=0,o=i.length;o>s;s++)t(i[s],e,n);else for(var r=this.fields,s=0,o=r.length;o>s;s++)t(this[r[s]],e,n);return n},iterFields:function(e){s.each(this.fields,function(t){e(this[t],t)},this)}}),a=r.extend("Value",{fields:["value"]}),l=r.extend("NodeList",{fields:["children"],init:function(e,t,n){this.parent(e,t,n||[])},addChild:function(e){this.children.push(e)}}),c=l.extend("Root"),d=a.extend("Literal"),u=a.extend("Symbol"),h=l.extend("Group"),p=l.extend("Array"),f=r.extend("Pair",{fields:["key","value"]}),v=l.extend("Dict"),m=r.extend("LookupVal",{fields:["target","val"]}),g=r.extend("If",{fields:["cond","body","else_"]}),b=g.extend("IfAsync"),y=r.extend("InlineIf",{fields:["cond","body","else_"]}),w=r.extend("For",{fields:["arr","name","body"]}),_=w.extend("AsyncEach"),x=w.extend("AsyncAll"),k=r.extend("Macro",{fields:["name","args","body"]}),S=r.extend("Import",{fields:["template","target"]}),C=r.extend("FromImport",{fields:["template","names"],init:function(e,t,n,i){this.parent(e,t,n,i||new l)}}),T=r.extend("FunCall",{fields:["name","args"]}),E=T.extend("Filter"),A=E.extend("FilterAsync",{fields:["name","args","symbol"]}),F=v.extend("KeywordArgs"),N=r.extend("Block",{fields:["name","body"]}),M=r.extend("Super",{fields:["blockName","symbol"]}),$=r.extend("TemplateRef",{fields:["template"]}),P=$.extend("Extends"),L=$.extend("Include"),O=r.extend("Set",{fields:["targets","value"]}),B=l.extend("Output"),D=d.extend("TemplateData"),j=r.extend("UnaryOp",{fields:["target"]}),I=r.extend("BinOp",{fields:["left","right"]}),R=I.extend("Or"),V=I.extend("And"),z=j.extend("Not"),H=I.extend("Add"),q=I.extend("Sub"),U=I.extend("Mul"),X=I.extend("Div"),W=I.extend("FloorDiv"),Y=I.extend("Mod"),K=I.extend("Pow"),G=j.extend("Neg"),Q=j.extend("Pos"),J=r.extend("Compare",{fields:["expr","ops"]}),Z=r.extend("CompareOperand",{fields:["expr","type"]}),et=(r.extend("CustomTag",{init:function(e,t,n){this.lineno=e,this.colno=t,this.name=n}}),r.extend("CallExtension",{fields:["extName","prop","args","contentArgs"],init:function(e,t,n,i){this.extName=e._name||e,this.prop=t,this.args=n||new l,this.contentArgs=i||[]}})),tt=et.extend("CallExtensionAsync");e.nodes={Node:r,Root:c,NodeList:l,Value:a,Literal:d,Symbol:u,Group:h,Array:p,Pair:f,Dict:v,Output:B,TemplateData:D,If:g,IfAsync:b,InlineIf:y,For:w,AsyncEach:_,AsyncAll:x,Macro:k,Import:S,FromImport:C,FunCall:T,Filter:E,FilterAsync:A,KeywordArgs:F,Block:N,Super:M,Extends:P,Include:L,Set:O,LookupVal:m,BinOp:I,Or:R,And:V,Not:z,Add:H,Sub:q,Mul:U,Div:X,FloorDiv:W,Mod:Y,Pow:K,Neg:G,Pos:Q,Compare:J,CompareOperand:Z,CallExtension:et,CallExtensionAsync:tt,printNodes:n}}(),function(){function t(e,t,n){return function(){var o,r=s(arguments),a=i(arguments);if(r>e.length){o=Array.prototype.slice.call(arguments,0,e.length);for(var l=Array.prototype.slice.call(arguments,o.length,r),c=0;c<l.length;c++)c<t.length&&(a[t[c]]=l[c]);o.push(a)}else if(r<e.length){o=Array.prototype.slice.call(arguments,0,r);for(var c=r;c<e.length;c++){var d=e[c];o.push(a[d]),delete a[d]}o.push(a)}else o=arguments;return n.apply(this,o)}}function n(e){return e.__keywords=!0,e}function i(e){var t=e.length;if(t){var n=e[t-1];if(n&&n.hasOwnProperty("__keywords"))return n}return{}}function s(e){var t=e.length;if(0===t)return 0;var n=e[t-1];return n&&n.hasOwnProperty("__keywords")?t-1:t}function o(e){if("string"!=typeof e)return e;this.toString=function(){return e},this.length=e.length;for(var t=["charAt","charCodeAt","concat","contains","endsWith","fromCharCode","indexOf","lastIndexOf","length","localeCompare","match","quote","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"],n=0;n<t.length;n++)this[t[n]]=a(e[t[n]])}function r(e,t){return e instanceof o?new o(t):t.toString()}function a(e){var t=typeof e;return"string"===t?new o(e):"function"!==t?e:function(){var t=e.apply(this,arguments);return"string"==typeof t?new o(t):t}}function l(e,t){return e=void 0!==e&&null!==e?e:"",t&&"string"==typeof e&&(e=v.escape(e)),e}function c(e,t){return e=e||{},"function"==typeof e[t]?function(){return e[t].apply(e,arguments)}:e[t]}function d(e,t,n){if(!e)throw new Error("Unable to call `"+t+"`, which is undefined or falsey");if("function"!=typeof e)throw new Error("Unable to call `"+t+"`, which is not a function");return e.apply(this,n)}function u(e,t,n){var i=t.lookup(n);return void 0!==i&&null!==i?i:e.lookup(n)}function h(e,t,n){return e.lineno?e:new v.TemplateError(e,t,n)}function p(e,t,n,i){if(v.isArray(e)){var s=e.length;v.asyncIter(e,function(e,i,o){switch(t){case 1:n(e,i,s,o);break;case 2:n(e[0],e[1],i,s,o);break;case 3:n(e[0],e[1],e[2],i,s,o);break;default:e.push(i,o),n.apply(this,e)}},i)}else v.asyncFor(e,function(e,t,i,s,o){n(e,t,i,s,o)},i)}function f(e,t,n,i){function s(e,t){a++,r[e]=t,a==o&&i(null,r.join(""))}var o,r,a=0;if(v.isArray(e))if(o=e.length,r=new Array(o),0==o)i(null,"");else for(var l=0;l<e.length;l++){var c=e[l];switch(t){case 1:n(c,l,o,s);break;case 2:n(c[0],c[1],l,o,s);break;case 3:n(c[0],c[1],c[2],l,o,s);break;default:c.push(l,s),n.apply(this,c)}}else{var d=v.keys(e);if(o=d.length,r=new Array(o),0==o)i(null,"");else for(var l=0;l<d.length;l++){var u=d[l];n(u,e[u],l,o,s)}}}var v=e.lib,m=e.object,g=m.extend({init:function(e){this.variables={},this.parent=e},set:function(e,t){for(var n=e.split("."),i=this.variables,s=0;s<n.length-1;s++){var o=n[s];i[o]||(i[o]={}),i=i[o]}i[n[n.length-1]]=t},get:function(e){var t=this.variables[e];return void 0!==t&&null!==t?t:null},lookup:function(e){var t=this.parent,n=this.variables[e];return void 0!==n&&null!==n?n:t&&t.lookup(e)},push:function(){return new g(this)},pop:function(){return this.parent}});e.runtime={Frame:g,makeMacro:t,makeKeywordArgs:n,numArgs:s,suppressValue:l,memberLookup:c,contextOrFrameLookup:u,callWrap:d,handleError:h,isArray:v.isArray,asyncEach:v.asyncEach,keys:v.keys,SafeString:o,copySafeness:r,markSafe:a,asyncEach:p,asyncAll:f}}(),function(){function t(e,t,n,i){return{type:e,value:t,lineno:n,colno:i}}function n(e){this.str=e,this.index=0,this.len=e.length,this.lineno=0,this.colno=0,this.in_code=!1}var i=(e.lib," \n	\r"),s="()[]{}%*-+/#,:|.<>=!",o="0123456789",r="{%",a="%}",l="{{",c="}}",d="{#",u="#}",h="string",p="whitespace",f="data",v="block-start",m="block-end",g="variable-start",b="variable-end",y="comment",w="left-paren",_="right-paren",x="left-bracket",k="right-bracket",S="left-curly",C="right-curly",T="operator",E="comma",A="colon",F="pipe",N="int",M="float",$="boolean",P="symbol",L="special";n.prototype.nextToken=function(){var e=this.lineno,n=this.colno;if(this.in_code){var L,O=this.current();if(this.is_finished())return null;if('"'==O||"'"==O)return t(h,this.parseString(O),e,n);if(L=this._extract(i))return t(p,L,e,n);if((L=this._extractString(a))||(L=this._extractString("-"+a)))return this.in_code=!1,t(m,L,e,n);if(L=this._extractString(c))return this.in_code=!1,t(b,L,e,n);if(-1!=s.indexOf(O)){this.forward();var B,D=["==","!=","<=",">=","//","**"],j=O+this.current();switch(-1!==D.indexOf(j)&&(this.forward(),O=j),O){case"(":B=w;break;case")":B=_;break;case"[":B=x;break;case"]":B=k;break;case"{":B=S;break;case"}":B=C;break;case",":B=E;break;case":":B=A;break;case"|":B=F;break;default:B=T}return t(B,O,e,n)}if(L=this._extractUntil(i+s),L.match(/^[-+]?[0-9]+$/)){if("."==this.current()){this.forward();var I=this._extract(o);return t(M,L+"."+I,e,n)}return t(N,L,e,n)}if(L.match(/^(true|false)$/))return t($,L,e,n);if(L)return t(P,L,e,n);throw new Error("Unexpected value while parsing: "+L)}var L,R=r.charAt(0)+l.charAt(0)+d.charAt(0)+u.charAt(0);if(this.is_finished())return null;if((L=this._extractString(r+"-"))||(L=this._extractString(r)))return this.in_code=!0,t(v,L,e,n);if(L=this._extractString(l))return this.in_code=!0,t(g,L,e,n);L="";var V,z=!1;for(this._matches(d)&&(z=!0,L=this._extractString(d));null!==(V=this._extractUntil(R))&&(L+=V,!(this._matches(r)||this._matches(l)||this._matches(d))||z);){if(this._matches(u)){if(!z)throw new Error("unexpected end of comment");L+=this._extractString(u);break}L+=this.current(),this.forward()}if(null===V&&z)throw new Error("expected end of comment, got end of file");return t(z?y:f,L,e,n)},n.prototype.parseString=function(e){this.forward();for(var t=(this.lineno,this.colno,"");!this.is_finished()&&this.current()!=e;){var n=this.current();if("\\"==n){switch(this.forward(),this.current()){case"n":t+="\n";break;case"t":t+="	";break;case"r":t+="\r";break;default:t+=this.current()}this.forward()}else t+=n,this.forward()}return this.forward(),t},n.prototype._matches=function(e){if(this.index+e.length>this.length)return null;var t=this.str.slice(this.index,this.index+e.length);return t==e},n.prototype._extractString=function(e){return this._matches(e)?(this.index+=e.length,e):null},n.prototype._extractUntil=function(e){return this._extractMatching(!0,e||"")},n.prototype._extract=function(e){return this._extractMatching(!1,e)},n.prototype._extractMatching=function(e,t){if(this.is_finished())return null;var n=t.indexOf(this.current());if(e&&-1==n||!e&&-1!=n){var i=this.current();this.forward();for(var s=t.indexOf(this.current());(e&&-1==s||!e&&-1!=s)&&!this.is_finished();)i+=this.current(),this.forward(),s=t.indexOf(this.current());return i}return""},n.prototype.is_finished=function(){return this.index>=this.len},n.prototype.forwardN=function(e){for(var t=0;e>t;t++)this.forward()},n.prototype.forward=function(){this.index++,"\n"==this.previous()?(this.lineno++,this.colno=0):this.colno++},n.prototype.back=function(){if(this.index--,"\n"==this.current()){this.lineno--;var e=this.src.lastIndexOf("\n",this.index-1);this.colno=-1==e?this.index:this.index-e}else this.colno--},n.prototype.current=function(){return this.is_finished()?"":this.str.charAt(this.index)},n.prototype.previous=function(){return this.str.charAt(this.index-1)},e.lexer={lex:function(e){return new n(e)},setTags:function(e){r=e.blockStart||r,a=e.blockEnd||a,l=e.variableStart||l,c=e.variableEnd||c,d=e.commentStart||d,u=e.commentEnd||u},TOKEN_STRING:h,TOKEN_WHITESPACE:p,TOKEN_DATA:f,TOKEN_BLOCK_START:v,TOKEN_BLOCK_END:m,TOKEN_VARIABLE_START:g,TOKEN_VARIABLE_END:b,TOKEN_COMMENT:y,TOKEN_LEFT_PAREN:w,TOKEN_RIGHT_PAREN:_,TOKEN_LEFT_BRACKET:x,TOKEN_RIGHT_BRACKET:k,TOKEN_LEFT_CURLY:S,TOKEN_RIGHT_CURLY:C,TOKEN_OPERATOR:T,TOKEN_COMMA:E,TOKEN_COLON:A,TOKEN_PIPE:F,TOKEN_INT:N,TOKEN_FLOAT:M,TOKEN_BOOLEAN:$,TOKEN_SYMBOL:P,TOKEN_SPECIAL:L}}(),function(){var t=e.lexer,n=e.nodes,i=e.object,s=e.lib,o=i.extend({init:function(e){this.tokens=e,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},nextToken:function(e){var n;if(this.peeked){if(e||this.peeked.type!=t.TOKEN_WHITESPACE)return n=this.peeked,this.peeked=null,n;this.peeked=null}if(n=this.tokens.nextToken(),!e)for(;n&&n.type==t.TOKEN_WHITESPACE;)n=this.tokens.nextToken();return n},peekToken:function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},pushToken:function(e){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=e},fail:function(e,t,n){if((void 0===t||void 0===n)&&this.peekToken()){var i=this.peekToken();t=i.lineno,n=i.colno}throw void 0!==t&&(t+=1),void 0!==n&&(n+=1),new s.TemplateError(e,t,n)},skip:function(e){var t=this.nextToken();return t&&t.type==e?!0:(this.pushToken(t),!1)},expect:function(e){var t=this.nextToken();return t.type!==e&&this.fail("expected "+e+", got "+t.type,t.lineno,t.colno),t},skipValue:function(e,t){var n=this.nextToken();return n&&n.type==e&&n.value==t?!0:(this.pushToken(n),!1)},skipWhitespace:function(){return this.skip(t.TOKEN_WHITESPACE)},skipSymbol:function(e){return this.skipValue(t.TOKEN_SYMBOL,e)},advanceAfterBlockEnd:function(e){if(!e){var n=this.peekToken();n||this.fail("unexpected end of file"),n.type!=t.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),e=this.nextToken().value}var n=this.nextToken();n&&n.type==t.TOKEN_BLOCK_END?"-"===n.value.charAt(0)&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+e+" statement")},advanceAfterVariableEnd:function(){this.skip(t.TOKEN_VARIABLE_END)||this.fail("expected variable end")},parseFor:function(){var e,i,s=this.peekToken();this.skipSymbol("for")?(e=new n.For(s.lineno,s.colno),i="endfor"):this.skipSymbol("asyncEach")?(e=new n.AsyncEach(s.lineno,s.colno),i="endeach"):this.skipSymbol("asyncAll")?(e=new n.AsyncAll(s.lineno,s.colno),i="endall"):this.fail("parseFor: expected for{Async}",s.lineno,s.colno),e.name=this.parsePrimary(),e.name instanceof n.Symbol||this.fail("parseFor: variable name expected for loop");var o=this.peekToken().type;if(o==t.TOKEN_COMMA){var r=e.name;for(e.name=new n.Array(r.lineno,r.colno),e.name.addChild(r);this.skip(t.TOKEN_COMMA);){var a=this.parsePrimary();e.name.addChild(a)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',s.lineno,s.colno),e.arr=this.parseExpression(),this.advanceAfterBlockEnd(s.value),e.body=this.parseUntilBlocks(i),this.advanceAfterBlockEnd(),e},parseMacro:function(){var e=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var t=this.parsePrimary(!0),i=this.parseSignature(),s=new n.Macro(e.lineno,e.colno,t,i);return this.advanceAfterBlockEnd(e.value),s.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),s},parseImport:function(){var e=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",e.lineno,e.colno);var t=this.parsePrimary();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',e.lineno,e.colno);var i=this.parsePrimary(),s=new n.Import(e.lineno,e.colno,t,i);return this.advanceAfterBlockEnd(e.value),s},parseFrom:function(){var e=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var i=this.parsePrimary(),s=new n.FromImport(e.lineno,e.colno,i,new n.NodeList);this.skipSymbol("import")||this.fail("parseFrom: expected import",e.lineno,e.colno);for(var o=s.names;;){var r=this.peekToken();if(r.type==t.TOKEN_BLOCK_END){o.children.length||this.fail("parseFrom: Expected at least one import name",e.lineno,e.colno),"-"==r.value.charAt(0)&&(this.dropLeadingWhitespace=!0),this.nextToken();break}o.children.length>0&&!this.skip(t.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",e.lineno,e.colno);var a=this.parsePrimary();if("_"==a.value.charAt(0)&&this.fail("parseFrom: names starting with an underscore cannot be imported",a.lineno,a.colno),this.skipSymbol("as")){var l=this.parsePrimary();o.addChild(new n.Pair(a.lineno,a.colno,a,l))}else o.addChild(a)}return s},parseBlock:function(){var e=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",e.lineno,e.colno);var t=new n.Block(e.lineno,e.colno);return t.name=this.parsePrimary(),t.name instanceof n.Symbol||this.fail("parseBlock: variable name expected",e.lineno,e.colno),this.advanceAfterBlockEnd(e.value),t.body=this.parseUntilBlocks("endblock"),this.peekToken()||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(),t},parseTemplateRef:function(e,t){var n=this.peekToken();this.skipSymbol(e)||this.fail("parseTemplateRef: expected "+e);var i=new t(n.lineno,n.colno);return i.template=this.parsePrimary(),this.advanceAfterBlockEnd(n.value),i},parseExtends:function(){return this.parseTemplateRef("extends",n.Extends)},parseInclude:function(){return this.parseTemplateRef("include",n.Include)},parseIf:function(){var e,t=this.peekToken();this.skipSymbol("if")||this.skipSymbol("elif")?e=new n.If(t.lineno,t.colno):this.skipSymbol("ifAsync")?e=new n.IfAsync(t.lineno,t.colno):this.fail("parseIf: expected if or elif",t.lineno,t.colno),e.cond=this.parseExpression(),this.advanceAfterBlockEnd(t.value),e.body=this.parseUntilBlocks("elif","else","endif");var i=this.peekToken();switch(i&&i.value){case"elif":e.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),e.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":e.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected endif, else, or endif, got end of file")}return e},parseSet:function(){var e=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",e.lineno,e.colno);for(var i,s=new n.Set(e.lineno,e.colno,[]);(i=this.parsePrimary())&&(s.targets.push(i),this.skip(t.TOKEN_COMMA)););return this.skipValue(t.TOKEN_OPERATOR,"=")||this.fail("parseSet: expected = in set tag",e.lineno,e.colno),s.value=this.parseExpression(),this.advanceAfterBlockEnd(e.value),s},parseStatement:function(){var e,i=this.peekToken();if(i.type!=t.TOKEN_SYMBOL&&this.fail("tag name expected",i.lineno,i.colno),this.breakOnBlocks&&-1!==this.breakOnBlocks.indexOf(i.value))return null;switch(i.value){case"raw":return this.parseRaw();case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"import":return this.parseImport();case"from":return this.parseFrom();default:if(this.extensions.length)for(var s=0;s<this.extensions.length;s++){var o=this.extensions[s];if(-1!==(o.tags||[]).indexOf(i.value))return o.parse(this,n,t)}this.fail("unknown block tag: "+i.value,i.lineno,i.colno)}return e},parseRaw:function(){this.advanceAfterBlockEnd();for(var e="",i=this.peekToken();;){var s=this.nextToken(!0);if(s||this.fail("expected endraw, got end of file"),s.type==t.TOKEN_BLOCK_START){var o=null,r=this.nextToken(!0);if(r.type==t.TOKEN_WHITESPACE&&(o=r,r=this.nextToken()),r.type==t.TOKEN_SYMBOL&&"endraw"==r.value){this.advanceAfterBlockEnd(r.value);break}e+=s.value,o&&(e+=o.value),e+=r.value}else e+=s.value}var a=new n.Output(i.lineno,i.colno,[new n.TemplateData(i.lineno,i.colno,e)]);return a},parsePostfix:function(e){for(var i=this.peekToken();i;){if(i.type==t.TOKEN_LEFT_PAREN)e=new n.FunCall(i.lineno,i.colno,e,this.parseSignature());else if(i.type==t.TOKEN_LEFT_BRACKET){var s=this.parseAggregate();s.children.length>1&&this.fail("invalid index"),e=new n.LookupVal(i.lineno,i.colno,e,s.children[0])}else{if(i.type!=t.TOKEN_OPERATOR||"."!=i.value)break;this.nextToken();var o=this.nextToken();o.type!=t.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+o.value,o.lineno,o.colno);var s=new n.Literal(o.lineno,o.colno,o.value);e=new n.LookupVal(i.lineno,i.colno,e,s)}i=this.peekToken()}return e},parseExpression:function(){var e=this.parseInlineIf();return e},parseInlineIf:function(){var e=this.parseOr();if(this.skipSymbol("if")){var t=this.parseOr(),i=e;e=new n.InlineIf(e.lineno,e.colno),e.body=i,e.cond=t,e.else_=this.skipSymbol("else")?this.parseOr():null}return e},parseOr:function(){for(var e=this.parseAnd();this.skipSymbol("or");){var t=this.parseAnd();e=new n.Or(e.lineno,e.colno,e,t)}return e},parseAnd:function(){for(var e=this.parseNot();this.skipSymbol("and");){var t=this.parseNot();e=new n.And(e.lineno,e.colno,e,t)}return e},parseNot:function(){var e=this.peekToken();return this.skipSymbol("not")?new n.Not(e.lineno,e.colno,this.parseNot()):this.parseCompare()},parseCompare:function(){for(var e=["==","!=","<",">","<=",">="],i=this.parseAdd(),s=[];;){var o=this.nextToken();if(!o)break;if(-1!==e.indexOf(o.value))s.push(new n.CompareOperand(o.lineno,o.colno,this.parseAdd(),o.value));else if(o.type==t.TOKEN_SYMBOL&&"in"==o.value)s.push(new n.CompareOperand(o.lineno,o.colno,this.parseAdd(),"in"));else{if(o.type!=t.TOKEN_SYMBOL||"not"!=o.value||!this.skipSymbol("in")){this.pushToken(o);break}s.push(new n.CompareOperand(o.lineno,o.colno,this.parseAdd(),"notin"))}}return s.length?new n.Compare(s[0].lineno,s[0].colno,i,s):i},parseAdd:function(){for(var e=this.parseSub();this.skipValue(t.TOKEN_OPERATOR,"+");){var i=this.parseSub();e=new n.Add(e.lineno,e.colno,e,i)}return e},parseSub:function(){for(var e=this.parseMul();this.skipValue(t.TOKEN_OPERATOR,"-");){var i=this.parseMul();e=new n.Sub(e.lineno,e.colno,e,i)}return e},parseMul:function(){for(var e=this.parseDiv();this.skipValue(t.TOKEN_OPERATOR,"*");){var i=this.parseDiv();e=new n.Mul(e.lineno,e.colno,e,i)}return e},parseDiv:function(){for(var e=this.parseFloorDiv();this.skipValue(t.TOKEN_OPERATOR,"/");){var i=this.parseFloorDiv();e=new n.Div(e.lineno,e.colno,e,i)}return e},parseFloorDiv:function(){for(var e=this.parseMod();this.skipValue(t.TOKEN_OPERATOR,"//");){var i=this.parseMod();e=new n.FloorDiv(e.lineno,e.colno,e,i)}return e},parseMod:function(){for(var e=this.parsePow();this.skipValue(t.TOKEN_OPERATOR,"%");){var i=this.parsePow();e=new n.Mod(e.lineno,e.colno,e,i)}return e},parsePow:function(){for(var e=this.parseUnary();this.skipValue(t.TOKEN_OPERATOR,"**");){var i=this.parseUnary();e=new n.Pow(e.lineno,e.colno,e,i)}return e},parseUnary:function(e){var i,s=this.peekToken();return i=this.skipValue(t.TOKEN_OPERATOR,"-")?new n.Neg(s.lineno,s.colno,this.parseUnary(!0)):this.skipValue(t.TOKEN_OPERATOR,"+")?new n.Pos(s.lineno,s.colno,this.parseUnary(!0)):this.parsePrimary(),e||(i=this.parseFilter(i)),i},parsePrimary:function(e){var i=this.nextToken(),s=null,o=null;return i?i.type==t.TOKEN_STRING?s=i.value:i.type==t.TOKEN_INT?s=parseInt(i.value,10):i.type==t.TOKEN_FLOAT?s=parseFloat(i.value):i.type==t.TOKEN_BOOLEAN&&("true"==i.value?s=!0:"false"==i.value?s=!1:this.fail("invalid boolean: "+i.val,i.lineno,i.colno)):this.fail("expected expression, got end of file"),null!==s?o=new n.Literal(i.lineno,i.colno,s):i.type==t.TOKEN_SYMBOL?(o=new n.Symbol(i.lineno,i.colno,i.value),e||(o=this.parsePostfix(o))):(this.pushToken(i),o=this.parseAggregate()),o?o:void this.fail("unexpected token: "+i.value,i.lineno,i.colno)},parseFilter:function(e){for(;this.skip(t.TOKEN_PIPE);){for(var i=this.expect(t.TOKEN_SYMBOL),s=i.value;this.skipValue(t.TOKEN_OPERATOR,".");)s+="."+this.expect(t.TOKEN_SYMBOL).value;if(e=new n.Filter(i.lineno,i.colno,new n.Symbol(i.lineno,i.colno,s),new n.NodeList(i.lineno,i.colno,[e])),this.peekToken().type==t.TOKEN_LEFT_PAREN){var o=this.parsePostfix(e);e.args.children=e.args.children.concat(o.args.children)}}return e},parseAggregate:function(){var e,i=this.nextToken();switch(i.type){case t.TOKEN_LEFT_PAREN:e=new n.Group(i.lineno,i.colno);break;case t.TOKEN_LEFT_BRACKET:e=new n.Array(i.lineno,i.colno);break;case t.TOKEN_LEFT_CURLY:e=new n.Dict(i.lineno,i.colno);break;default:return null}for(;;){var s=this.peekToken().type;if(s==t.TOKEN_RIGHT_PAREN||s==t.TOKEN_RIGHT_BRACKET||s==t.TOKEN_RIGHT_CURLY){this.nextToken();break}if(e.children.length>0&&(this.skip(t.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",i.lineno,i.colno)),e instanceof n.Dict){var o=this.parsePrimary();this.skip(t.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",i.lineno,i.colno);var r=this.parseExpression();e.addChild(new n.Pair(o.lineno,o.colno,o,r))}else{var a=this.parseExpression();e.addChild(a)}}return e},parseSignature:function(e,i){var s=this.peekToken();if(!i&&s.type!=t.TOKEN_LEFT_PAREN){if(e)return null;this.fail("expected arguments",s.lineno,s.colno)}s.type==t.TOKEN_LEFT_PAREN&&(s=this.nextToken());for(var o=new n.NodeList(s.lineno,s.colno),r=new n.KeywordArgs(s.lineno,s.colno),a=!1;;){if(s=this.peekToken(),!i&&s.type==t.TOKEN_RIGHT_PAREN){this.nextToken();break}if(i&&s.type==t.TOKEN_BLOCK_END)break;if(a&&!this.skip(t.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",s.lineno,s.colno);else{var l=this.parseExpression();this.skipValue(t.TOKEN_OPERATOR,"=")?r.addChild(new n.Pair(l.lineno,l.colno,l,this.parseExpression())):o.addChild(l)}a=!0}return r.children.length&&o.addChild(r),o},parseUntilBlocks:function(){var e=this.breakOnBlocks;this.breakOnBlocks=s.toArray(arguments);var t=this.parse();return this.breakOnBlocks=e,t},parseNodes:function(){for(var e,i=[];e=this.nextToken();)if(e.type==t.TOKEN_DATA){var s=e.value,o=this.peekToken(),r=o&&o.value;
this.dropLeadingWhitespace&&(s=s.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),o&&o.type==t.TOKEN_BLOCK_START&&"-"==r.charAt(r.length-1)&&(s=s.replace(/\s*$/,"")),i.push(new n.Output(e.lineno,e.colno,[new n.TemplateData(e.lineno,e.colno,s)]))}else if(e.type==t.TOKEN_BLOCK_START){var a=this.parseStatement();if(!a)break;i.push(a)}else if(e.type==t.TOKEN_VARIABLE_START){var l=this.parseExpression();this.advanceAfterVariableEnd(),i.push(new n.Output(e.lineno,e.colno,[l]))}else e.type!=t.TOKEN_COMMENT&&this.fail("Unexpected token at top-level: "+e.type,e.lineno,e.colno);return i},parse:function(){return new n.NodeList(0,0,this.parseNodes())},parseAsRoot:function(){return new n.Root(0,0,this.parseNodes())}});e.parser={parse:function(e,n){var i=new o(t.lex(e));return void 0!==n&&(i.extensions=n),i.parseAsRoot()}}}(),function(){function t(){return"hole_"+h++}function n(e,t){for(var n=null,i=0;i<e.length;i++){var s=t(e[i]);s!==e[i]&&(n||(n=e.slice()),n[i]=s)}return n||e}function i(e,t,s){if(!(e instanceof u.Node))return e;if(!s){var o=t(e);if(o&&o!==e)return o}if(e instanceof u.NodeList){var r=n(e.children,function(e){return i(e,t,s)});r!==e.children&&(e=new u[e.typename](e.lineno,e.colno,r))}else if(e instanceof u.CallExtension){var a=i(e.args,t,s),l=n(e.contentArgs,function(e){return i(e,t,s)});(a!==e.args||l!==e.contentArgs)&&(e=new u[e.typename](e.extName,e.prop,a,l))}else{var c=e.fields.map(function(t){return e[t]}),d=n(c,function(e){return i(e,t,s)});d!==c&&(e=new u[e.typename](e.lineno,e.colno),d.forEach(function(t,n){e[e.fields[n]]=t}))}return s?t(e)||e:e}function s(e,t){return i(e,t,!0)}function o(e,n,i){var o=[],r=s(i?e[i]:e,function(e){if(e instanceof u.Block)return e;if(e instanceof u.Filter&&-1!==n.indexOf(e.name.value)||e instanceof u.CallExtensionAsync){var i=new u.Symbol(e.lineno,e.colno,t());return o.push(new u.FilterAsync(e.lineno,e.colno,e.name,e.args,i)),i}});return i?e[i]=r:e=r,o.length?(o.push(e),new u.NodeList(e.lineno,e.colno,o)):e}function r(e,t){return s(e,function(e){return e instanceof u.Output?o(e,t):e instanceof u.For?o(e,t,"arr"):e instanceof u.If?o(e,t,"cond"):e instanceof u.CallExtension?o(e,t,"args"):void 0})}function a(e){return i(e,function(e){if(e instanceof u.Block){var n=!1,s=t();e.body=i(e.body,function(e){return e instanceof u.FunCall&&"super"==e.name.value?(n=!0,new u.Symbol(e.lineno,e.colno,s)):void 0}),n&&e.body.children.unshift(new u.Super(0,0,e.name,new u.Symbol(0,0,s)))}})}function l(e){return s(e,function(e){if(e instanceof u.If||e instanceof u.For){var t=!1;if(i(e,function(e){return e instanceof u.FilterAsync||e instanceof u.IfAsync||e instanceof u.AsyncEach||e instanceof u.AsyncAll||e instanceof u.CallExtensionAsync?(t=!0,e):void 0}),t){if(e instanceof u.If)return new u.IfAsync(e.lineno,e.colno,e.cond,e.body,e.else_);if(e instanceof u.For)return new u.AsyncEach(e.lineno,e.colno,e.arr,e.name,e.body)}}})}function c(e,t){return l(a(r(e,t)))}function d(e,t){return c(e,t||[])}var u=e.nodes,h=0;e.transformer={transform:d}}(),function(){function t(e){return function(t,n){this.compile(t.left,n),this.emit(e),this.compile(t.right,n)}}var n=e.lib,i=e.parser,s=e.transformer,o=e.nodes,r=e.object,a=e.runtime.Frame,l={"==":"==","!=":"!=","<":"<",">":">","<=":"<=",">=":">="},c=r.extend({init:function(){this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this.isChild=!1,this.scopeClosers=""},fail:function(e,t,i){throw void 0!==t&&(t+=1),void 0!==i&&(i+=1),new n.TemplateError(e,t,i)},pushBufferId:function(e){this.bufferStack.push(this.buffer),this.buffer=e,this.emit("var "+this.buffer+' = "";')},popBufferId:function(){this.buffer=this.bufferStack.pop()},emit:function(e){this.codebuf.push(e)},emitLine:function(e){this.emit(e+"\n")},emitLines:function(){n.each(n.toArray(arguments),function(e){this.emitLine(e)},this)},emitFuncBegin:function(e){this.buffer="output",this.scopeClosers="",this.emitLine("function "+e+"(env, context, frame, runtime, cb) {"),this.emitLine("var lineno = null;"),this.emitLine("var colno = null;"),this.emitLine("var "+this.buffer+' = "";'),this.emitLine("try {")},emitFuncEnd:function(e){e||this.emitLine("cb(null, "+this.buffer+");"),this.closeScopeLevels(),this.emitLine("} catch (e) {"),this.emitLine("  cb(runtime.handleError(e, lineno, colno));"),this.emitLine("}"),this.emitLine("}"),this.buffer=null},addScopeLevel:function(){this.scopeClosers+="})"},closeScopeLevels:function(){this.emitLine(this.scopeClosers+";"),this.scopeClosers=""},withScopedSyntax:function(e){var t=this.scopeClosers;this.scopeClosers="",e.call(this),this.closeScopeLevels(),this.scopeClosers=t},makeCallback:function(e){var t=this.tmpid();return"function("+t+(e?","+e:"")+") {\nif("+t+") { cb("+t+"); return; }"},tmpid:function(){return this.lastId++,"t_"+this.lastId},_bufferAppend:function(e){this.emit(this.buffer+" += runtime.suppressValue("),e.call(this),this.emit(", env.autoesc);\n")},_compileChildren:function(e,t){for(var n=e.children,i=0,s=n.length;s>i;i++)this.compile(n[i],t)},_compileAggregate:function(e,t,n,i){n&&this.emit(n);for(var s=0;s<e.children.length;s++)s>0&&this.emit(","),this.compile(e.children[s],t);i&&this.emit(i)},_compileExpression:function(e,t){this.assertType(e,o.Literal,o.Symbol,o.Group,o.Array,o.Dict,o.FunCall,o.Filter,o.LookupVal,o.Compare,o.InlineIf,o.And,o.Or,o.Not,o.Add,o.Sub,o.Mul,o.Div,o.FloorDiv,o.Mod,o.Pow,o.Neg,o.Pos,o.Compare,o.NodeList),this.compile(e,t)},assertType:function(e){for(var t=n.toArray(arguments).slice(1),i=!1,s=0;s<t.length;s++)e instanceof t[s]&&(i=!0);i||this.fail("assertType: invalid type: "+e.typename,e.lineno,e.colno)},compileCallExtension:function(e,t,i){var s=(e.extName,e.args),r=e.contentArgs;if(i||this.emit(this.buffer+" += runtime.suppressValue("),this.emit('env.getExtension("'+e.extName+'")["'+e.prop+'"]('),this.emit("context"),(s||r)&&this.emit(","),s&&(s instanceof o.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),n.each(s.children,function(e,n){this._compileExpression(e,t),(n!=s.children.length-1||r.length)&&this.emit(",")},this)),r.length&&n.each(r,function(e,n){if(n>0&&this.emit(","),e){var i=this.tmpid();this.emitLine("function(cb) {"),this.emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}"),this.pushBufferId(i),this.withScopedSyntax(function(){this.compile(e,t),this.emitLine("cb(null, "+i+");")}),this.popBufferId(),this.emitLine("return "+i+";"),this.emitLine("}")}else this.emit("null")},this),i){var a=this.tmpid();this.emitLine(", "+this.makeCallback(a)),this.emitLine(this.buffer+" += runtime.suppressValue("+a+", env.autoesc);"),this.addScopeLevel()}else this.emit(")"),this.emit(", env.autoesc);\n")},compileCallExtensionAsync:function(e,t){this.compileCallExtension(e,t,!0)},compileNodeList:function(e,t){this._compileChildren(e,t)},compileLiteral:function(e){if("string"==typeof e.value){var t=e.value.replace(/\\/g,"\\\\");t=t.replace(/"/g,'\\"'),t=t.replace(/\n/g,"\\n"),t=t.replace(/\r/g,"\\r"),t=t.replace(/\t/g,"\\t"),this.emit('"'+t+'"')}else this.emit(e.value.toString())},compileSymbol:function(e,t){var n,i=e.value;this.emit((n=t.lookup(i))?n:'runtime.contextOrFrameLookup(context, frame, "'+i+'")')},compileGroup:function(e,t){this._compileAggregate(e,t,"(",")")},compileArray:function(e,t){this._compileAggregate(e,t,"[","]")},compileDict:function(e,t){this._compileAggregate(e,t,"{","}")},compilePair:function(e,t){var n=e.key,i=e.value;n instanceof o.Symbol?n=new o.Literal(n.lineno,n.colno,n.value):n instanceof o.Literal&&"string"==typeof n.value||this.fail("compilePair: Dict keys must be strings or names",n.lineno,n.colno),this.compile(n,t),this.emit(": "),this._compileExpression(i,t)},compileInlineIf:function(e,t){this.emit("("),this.compile(e.cond,t),this.emit("?"),this.compile(e.body,t),this.emit(":"),null!==e.else_?this.compile(e.else_,t):this.emit('""'),this.emit(")")},compileOr:t(" || "),compileAnd:t(" && "),compileAdd:t(" + "),compileSub:t(" - "),compileMul:t(" * "),compileDiv:t(" / "),compileMod:t(" % "),compileNot:function(e,t){this.emit("!"),this.compile(e.target,t)},compileFloorDiv:function(e,t){this.emit("Math.floor("),this.compile(e.left,t),this.emit(" / "),this.compile(e.right,t),this.emit(")")},compilePow:function(e,t){this.emit("Math.pow("),this.compile(e.left,t),this.emit(", "),this.compile(e.right,t),this.emit(")")},compileNeg:function(e,t){this.emit("-"),this.compile(e.target,t)},compilePos:function(e,t){this.emit("+"),this.compile(e.target,t)},compileCompare:function(e,t){this.compile(e.expr,t);for(var n=0;n<e.ops.length;n++){var i=e.ops[n];this.emit(" "+l[i.type]+" "),this.compile(i.expr,t)}},compileLookupVal:function(e,t){this.emit("runtime.memberLookup(("),this._compileExpression(e.target,t),this.emit("),"),this._compileExpression(e.val,t),this.emit(", env.autoesc)")},_getNodeName:function(e){switch(e.typename){case"Symbol":return e.value;case"FunCall":return"the return value of ("+this._getNodeName(e.name)+")";case"LookupVal":return this._getNodeName(e.target)+'["'+this._getNodeName(e.val)+'"]';case"Literal":return e.value.toString().substr(0,10);default:return"--expression--"}},compileFunCall:function(e,t){this.emit("(lineno = "+e.lineno+", colno = "+e.colno+", "),this.emit("runtime.callWrap("),this._compileExpression(e.name,t),this.emit(', "'+this._getNodeName(e.name).replace(/"/g,'\\"')+'", '),this._compileAggregate(e.args,t,"[","])"),this.emit(")")},compileFilter:function(e,t){var n=e.name;this.assertType(n,o.Symbol),this.emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this.emit(")")},compileFilterAsync:function(e,t){var n=e.name;this.assertType(n,o.Symbol);var i=e.symbol.value;t.set(i,i),this.emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this.emitLine(", "+this.makeCallback(i)),this.addScopeLevel()},compileKeywordArgs:function(e,t){var i=[];n.each(e.children,function(e){i.push(e.key.value)}),this.emit("runtime.makeKeywordArgs("),this.compileDict(e,t),this.emit(")")},compileSet:function(e,t){var i=[];n.each(e.targets,function(e){var n=e.value,s=t.get(n);null===s&&(s=this.tmpid(),this.emitLine("var "+s+";")),i.push(s)},this),this.emit(i.join(" = ")+" = "),this._compileExpression(e.value,t),this.emitLine(";"),n.each(e.targets,function(e,n){var s=i[n],o=e.value;this.emitLine('frame.set("'+o+'", '+s+");"),null===t.get(o)&&t.set(o,s),this.emitLine("if(!frame.parent) {"),this.emitLine('context.setVariable("'+o+'", '+s+");"),"_"!=o.charAt(0)&&this.emitLine('context.addExport("'+o+'");'),this.emitLine("}")},this)},compileIf:function(e,t,n){this.emit("if("),this._compileExpression(e.cond,t),this.emitLine(") {"),this.withScopedSyntax(function(){this.compile(e.body,t),n&&this.emit("cb()")}),e.else_&&(this.emitLine("}\nelse {"),this.withScopedSyntax(function(){this.compile(e.else_,t),n&&this.emit("cb()")})),this.emitLine("}")},compileIfAsync:function(e,t){this.emit("(function(cb) {"),this.compileIf(e,t,!0),this.emit("})(function() {"),this.addScopeLevel()},scanLoop:function(e){var t={};return e.iterFields(function(e){var i=e.findAll(o.LookupVal);n.each(i,function(e){e.target instanceof o.Symbol&&"loop"==e.target.value&&e.val instanceof o.Literal&&(t[e.val.value]=!0)})}),t},emitLoopBindings:function(e,t,n,i,s){s=s||n+".length";var o={index:i+" + 1",index0:i,revindex:s+" - "+i,revindex0:s+" - "+i+" - 1",first:i+" === 0",last:i+" === "+s+" - 1",length:s};for(var r in o)r in t&&this.emitLine('frame.set("loop.'+r+'", '+o[r]+");")},compileFor:function(e,t){var n=this.tmpid(),i=this.tmpid(),s=this.tmpid(),r=this.scanLoop(e);if(t=t.push(),this.emitLine("frame = frame.push();"),this.emit("var "+s+" = "),this._compileExpression(e.arr,t),this.emitLine(";"),this.emit("if("+s+") {"),e.name instanceof o.Array){this.emitLine("var "+n+";"),this.emitLine("if(runtime.isArray("+s+")) {"),this.emitLine("for("+n+"=0; "+n+" < "+s+".length; "+n+"++) {");for(var a=0;a<e.name.children.length;a++){var l=this.tmpid();this.emitLine("var "+l+" = "+s+"["+n+"]["+a+"]"),this.emitLine('frame.set("'+e.name.children[a].value+'", '+s+"["+n+"]["+a+"]);"),t.set(e.name.children[a].value,l)}this.emitLoopBindings(e,r,s,n),this.withScopedSyntax(function(){this.compile(e.body,t)}),this.emitLine("}"),this.emitLine("} else {");var c=e.name.children[0],d=e.name.children[1],u=this.tmpid(),h=this.tmpid();t.set(c.value,u),t.set(d.value,h),this.emitLine(n+" = -1;"),(r.revindex||r.revindex0||r.last||r.length)&&this.emitLine("var "+i+" = runtime.keys("+s+").length;"),this.emitLine("for(var "+u+" in "+s+") {"),this.emitLine(n+"++;"),this.emitLine("var "+h+" = "+s+"["+u+"];"),this.emitLine('frame.set("'+c.value+'", '+u+");"),this.emitLine('frame.set("'+d.value+'", '+h+");"),this.emitLoopBindings(e,r,s,n,i),this.withScopedSyntax(function(){this.compile(e.body,t)}),this.emitLine("}"),this.emitLine("}")}else{var h=this.tmpid();t.set(e.name.value,h),this.emitLine("for(var "+n+"=0; "+n+" < "+s+".length; "+n+"++) {"),this.emitLine("var "+h+" = "+s+"["+n+"];"),this.emitLine('frame.set("'+e.name.value+'", '+h+");"),this.emitLoopBindings(e,r,s,n),this.withScopedSyntax(function(){this.compile(e.body,t)}),this.emitLine("}")}this.emitLine("}"),this.emitLine("frame = frame.pop();")},_compileAsyncLoop:function(e,t,i){var s=this.tmpid(),r=this.tmpid(),a=this.tmpid(),l=this.scanLoop(e),c=i?"asyncAll":"asyncEach";if(t=t.push(),this.emitLine("frame = frame.push();"),this.emit("var "+a+" = "),this._compileExpression(e.arr,t),this.emitLine(";"),e.name instanceof o.Array)this.emit("runtime."+c+"("+a+", "+e.name.children.length+", function("),n.each(e.name.children,function(e){this.emit(e.value+",")},this),this.emit(s+","+r+",next) {"),n.each(e.name.children,function(e){var n=e.value;t.set(n,n),this.emitLine('frame.set("'+n+'", '+n+");")},this);else{var d=e.name.value;this.emitLine("runtime."+c+"("+a+", 1, function("+d+", "+s+", "+r+",next) {"),this.emitLine('frame.set("'+d+'", '+d+");"),t.set(d,d)}this.emitLoopBindings(e,l,a,s,r),this.withScopedSyntax(function(){var n;i&&(n=this.tmpid(),this.pushBufferId(n)),this.compile(e.body,t),this.emitLine("next("+s+(n?","+n:"")+");"),i&&this.popBufferId()});var u=this.tmpid();this.emitLine("}, "+this.makeCallback(u)),this.addScopeLevel(),i&&this.emitLine(this.buffer+" += "+u+";"),this.emitLine("frame = frame.pop();")},compileAsyncEach:function(e,t){this._compileAsyncLoop(e,t)},compileAsyncAll:function(e,t){this._compileAsyncLoop(e,t,!0)},_emitMacroBegin:function(e,t){var i=[],s=null,r="macro_"+this.tmpid();n.each(e.args.children,function(t,n){n===e.args.children.length-1&&t instanceof o.Dict?s=t:(this.assertType(t,o.Symbol),i.push(t))},this);var a=n.map(i,function(e){return"l_"+e.value});a.push("kwargs");var l=n.map(i,function(e){return'"'+e.value+'"'}),c=n.map(s&&s.children||[],function(e){return'"'+e.key.value+'"'});return this.emitLines("var "+r+" = runtime.makeMacro(","["+l.join(", ")+"], ","["+c.join(", ")+"], ","function ("+a.join(", ")+") {","frame = frame.push();","kwargs = kwargs || {};"),n.each(i,function(e){this.emitLine('frame.set("'+e.value+'", l_'+e.value+");"),t.set(e.value,"l_"+e.value)},this),s&&n.each(s.children,function(e){var n=e.key.value;this.emit('frame.set("'+n+'", kwargs.hasOwnProperty("'+n+'") ? kwargs["'+n+'"] : '),this._compileExpression(e.value,t),this.emitLine(");")},this),r},_emitMacroEnd:function(){this.emitLine("frame = frame.pop();"),this.emitLine("return new runtime.SafeString("+this.buffer+");"),this.emitLine("});")},compileMacro:function(e,t){t=t.push();var n=this._emitMacroBegin(e,t),i=this.buffer;this.buffer="output",this.emitLine("var "+this.buffer+'= "";'),this.compile(e.body,t),this._emitMacroEnd(),this.buffer=i;var s=e.name.value;t=t.pop(),t.set(s,n),t.parent?this.emitLine('frame.set("'+s+'", '+n+");"):("_"!=e.name.value.charAt(0)&&this.emitLine('context.addExport("'+s+'");'),this.emitLine('context.setVariable("'+s+'", '+n+");"))},compileImport:function(e,t){var n=this.tmpid(),i=e.target.value;this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", "+this.makeCallback(n)),this.addScopeLevel(),this.emitLine(n+".getExported("+this.makeCallback(n)),this.addScopeLevel(),t.set(i,n),this.emitLine(t.parent?'frame.set("'+i+'", '+n+");":'context.setVariable("'+i+'", '+n+");")},compileFromImport:function(e,t){var i=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", "+this.makeCallback(i)),this.addScopeLevel(),this.emitLine(i+".getExported("+this.makeCallback(i)),this.addScopeLevel(),n.each(e.names.children,function(e){var n,s,r=this.tmpid();e instanceof o.Pair?(n=e.key.value,s=e.value.value):(n=e.value,s=n),this.emitLine("if("+i+'.hasOwnProperty("'+n+'")) {'),this.emitLine("var "+r+" = "+i+"."+n+";"),this.emitLine("} else {"),this.emitLine("cb(new Error(\"cannot import '"+n+"'\")); return;"),this.emitLine("}"),t.set(s,r),this.emitLine(t.parent?'frame.set("'+s+'", '+r+");":'context.setVariable("'+s+'", '+r+");")},this)},compileBlock:function(e){if(!this.isChild){var t=this.tmpid();this.emitLine('context.getBlock("'+e.name.value+'")(env, context, frame, runtime, '+this.makeCallback(t)),this.emitLine(this.buffer+" += "+t+";"),this.addScopeLevel()}},compileSuper:function(e,t){var n=e.blockName.value,i=e.symbol.value;this.emitLine('context.getSuper(env, "'+n+'", b_'+n+", frame, runtime, "+this.makeCallback(i)),this.emitLine(i+" = runtime.markSafe("+i+");"),this.addScopeLevel(),t.set(i,i)},compileExtends:function(e,t){this.isChild&&this.fail("compileExtends: cannot extend multiple times",e.template.lineno,e.template.colno);var n=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", true, "+this.makeCallback("parentTemplate")),this.emitLine("for(var "+n+" in parentTemplate.blocks) {"),this.emitLine("context.addBlock("+n+", parentTemplate.blocks["+n+"]);"),this.emitLine("}"),this.addScopeLevel(),this.isChild=!0},compileInclude:function(e,t){var n=this.tmpid(),i=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(e.template,t),this.emitLine(", "+this.makeCallback(n)),this.addScopeLevel(),this.emitLine(n+".render(context.getVariables(), frame.push(), "+this.makeCallback(i)),this.emitLine(this.buffer+" += "+i),this.addScopeLevel()},compileTemplateData:function(e,t){this.compileLiteral(e,t)},compileOutput:function(e,t){for(var n=e.children,i=0,s=n.length;s>i;i++)n[i]instanceof o.TemplateData?n[i].value&&(this.emit(this.buffer+" += "),this.compileLiteral(n[i],t),this.emitLine(";")):(this.emit(this.buffer+" += runtime.suppressValue("),this.compile(n[i],t),this.emit(", env.autoesc);\n"))},compileRoot:function(e,t){t&&this.fail("compileRoot: root node can't have frame"),t=new a,this.emitFuncBegin("root"),this._compileChildren(e,t),this.isChild&&this.emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this.emitFuncEnd(this.isChild),this.isChild=!1;for(var n=e.findAll(o.Block),i=0;i<n.length;i++){var s=n[i],r=s.name.value;this.emitFuncBegin("b_"+r);var l=new a;this.compile(s.body,l),this.emitFuncEnd()}this.emitLine("return {");for(var i=0;i<n.length;i++){var s=n[i],r="b_"+s.name.value;this.emitLine(r+": "+r+",")}this.emitLine("root: root\n};")},compile:function(e,t){var n=this["compile"+e.typename];n?n.call(this,e,t):this.fail("compile: Cannot compile node: "+e.typename,e.lineno,e.colno)},getCode:function(){return this.codebuf.join("")}});e.compiler={compile:function(e,t,n,o){var r=new c;if(n&&n.length)for(var a=0;a<n.length;a++)"preprocess"in n[a]&&(e=n[a].preprocess(e,o));return r.compile(s.transform(i.parse(e,n),t,o)),r.getCode()},Compiler:c}}(),function(){var t=e.lib,n=e.runtime,i={abs:function(e){return Math.abs(e)},batch:function(e,t,n){for(var i=[],s=[],o=0;o<e.length;o++)o%t===0&&s.length&&(i.push(s),s=[]),s.push(e[o]);if(s.length){if(n)for(var o=s.length;t>o;o++)s.push(n);i.push(s)}return i},capitalize:function(e){var t=e.toLowerCase();return n.copySafeness(e,t.charAt(0).toUpperCase()+t.slice(1))},center:function(e,i){if(i=i||80,e.length>=i)return e;var s=i-e.length,o=t.repeat(" ",s/2-s%2),r=t.repeat(" ",s/2);return n.copySafeness(e,o+e+r)},"default":function(e,t){return e?e:t},dictsort:function(e,n,i){if(!t.isObject(e))throw new t.TemplateError("dictsort filter: val must be an object");var s=[];for(var o in e)s.push([o,e[o]]);var r;if(void 0===i||"key"===i)r=0;else{if("value"!==i)throw new t.TemplateError("dictsort filter: You can only sort by either key or value");r=1}return s.sort(function(e,i){var s=e[r],o=i[r];return n||(t.isString(s)&&(s=s.toUpperCase()),t.isString(o)&&(o=o.toUpperCase())),s>o?1:s==o?0:-1}),s},escape:function(e){return"string"==typeof e||e instanceof n.SafeString?t.escape(e):e},safe:function(e){return n.markSafe(e)},first:function(e){return e[0]},groupby:function(e,n){return t.groupBy(e,n)},indent:function(e,i,s){i=i||4;for(var o="",r=e.split("\n"),a=t.repeat(" ",i),l=0;l<r.length;l++)o+=0!=l||s?a+r[l]+"\n":r[l]+"\n";return n.copySafeness(e,o)},join:function(e,n,i){return n=n||"",i&&(e=t.map(e,function(e){return e[i]})),e.join(n)},last:function(e){return e[e.length-1]},length:function(e){return e.length},list:function(e){if(t.isString(e))return e.split("");if(t.isObject(e)){var n=[];if(Object.keys)n=Object.keys(e);else for(var i in e)n.push(i);return t.map(n,function(t){return{key:t,value:e[t]}})}throw new t.TemplateError("list filter: type not iterable")},lower:function(e){return e.toLowerCase()},random:function(e){return e[Math.floor(Math.random()*e.length)]},replace:function(e,t,i,s){var o=e,r=o,a=1;for(o=o.replace(t,i);r!=o&&!(a>=s);)r=o,o=o.replace(t,i),a++;return n.copySafeness(e,o)},reverse:function(e){var s;return s=t.isString(e)?i.list(e):t.map(e,function(e){return e}),s.reverse(),t.isString(e)?n.copySafeness(e,s.join("")):s},round:function(e,t,n){t=t||0;var i,s=Math.pow(10,t);return i="ceil"==n?Math.ceil:"floor"==n?Math.floor:Math.round,i(e*s)/s},slice:function(e,t,n){for(var i=Math.floor(e.length/t),s=e.length%t,o=0,r=[],a=0;t>a;a++){var l=o+a*i;s>a&&o++;var c=o+(a+1)*i,d=e.slice(l,c);n&&a>=s&&d.push(n),r.push(d)}return r},sort:function(e,n,i,s){return e=t.map(e,function(e){return e}),e.sort(function(e,o){var r,a;return s?(r=e[s],a=o[s]):(r=e,a=o),!i&&t.isString(r)&&t.isString(a)&&(r=r.toLowerCase(),a=a.toLowerCase()),a>r?n?1:-1:r>a?n?-1:1:0}),e},string:function(e){return n.copySafeness(e,e)},title:function(e){for(var t=e.split(" "),s=0;s<t.length;s++)t[s]=i.capitalize(t[s]);return n.copySafeness(e,t.join(" "))},trim:function(e){return n.copySafeness(e,e.replace(/^\s*|\s*$/g,""))},truncate:function(e,t,i,s){var o=e;if(t=t||255,e.length<=t)return e;if(i)e=e.substring(0,t);else{var r=e.lastIndexOf(" ",t);-1===r&&(r=t),e=e.substring(0,r)}return e+=void 0!==s&&null!==s?s:"...",n.copySafeness(o,e)},upper:function(e){return e.toUpperCase()},urlencode:function(e){var n=encodeURIComponent;if(t.isString(e))return n(e);var i;if(t.isArray(e))i=e.map(function(e){return n(e[0])+"="+n(e[1])});else{i=[];for(var s in e)e.hasOwnProperty(s)&&i.push(n(s)+"="+n(e[s]))}return i.join("&")},urlize:function(e,t,n){isNaN(t)&&(t=1/0);var i=n===!0?' rel="nofollow"':"",s=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,o=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,r=/^https?:\/\/.*$/,a=/^www\./,l=/\.(?:org|net|com)(?:\:|\/|$)/,c=e.split(/\s+/).filter(function(e){return e&&e.length}).map(function(e){var n=e.match(s),c=n&&n[1]||e;return r.test(c)?'<a href="'+c+'"'+i+">"+c.substr(0,t)+"</a>":a.test(c)?'<a href="http://'+c+'"'+i+">"+c.substr(0,t)+"</a>":o.test(c)?'<a href="mailto:'+c+'">'+c+"</a>":l.test(c)?'<a href="http://'+c+'"'+i+">"+c.substr(0,t)+"</a>":c});return c.join(" ")},wordcount:function(e){return e.match(/\w+/g).length},"float":function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},"int":function(e,t){var n=parseInt(e,10);return isNaN(n)?t:n}};i.d=i["default"],i.e=i.escape,e.filters=i}(),function(){function t(e){var t=-1,n=null;return{reset:function(){t=-1,n=null},next:function(){return t++,t>=e.length&&(t=0),n=e[t]}}}function n(e){e=e||",";var t=!0;return function(){var n=t?"":e;return t=!1,n}}var i={range:function(e,t,n){t?n||(n=1):(t=e,e=0,n=1);for(var i=[],s=e;t>s;s+=n)i.push(s);return i},cycler:function(){return t(Array.prototype.slice.call(arguments))},joiner:function(e){return n(e)}};e.globals=i}(),function(){var t=e.object,n=e.lib,i=t.extend({on:function(e,t){this.listeners=this.listeners||{},this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t)},emit:function(e){var t=Array.prototype.slice.call(arguments,1);this.listeners&&this.listeners[e]&&n.each(this.listeners[e],function(e){e.apply(null,t)})}});e.loader=i}(),function(){var t=e.loader,n=t.extend({init:function(e,t){this.precompiled=window.nunjucksPrecompiled||{},this.baseURL=e||"",this.neverUpdate=t},getSource:function(e){if(this.precompiled[e])return{src:{type:"code",obj:this.precompiled[e]},path:e};var t=this.fetch(this.baseURL+"/"+e);return t?{src:t,path:e,noCache:this.neverUpdate}:null},fetch:function(e){var t,n,i=!0;return window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t.onreadystatechange=function(){4!==t.readyState||0!==t.status&&200!==t.status||!i||(i=!1,n=t.responseText)},e+=(-1===e.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),t.open("GET",e,!1),t.send(),n}});e["web-loaders"]={WebLoader:n}}(),function(){e.loaders="undefined"==typeof window?e["node-loaders"]:e["web-loaders"]}(),function(){var t=e.lib,n=e.object,i=e.lexer,s=e.compiler,o=e.filters,r=e.loaders,a=e.runtime,l=e.globals,c=a.Frame,d=n.extend({init:function(e,n){n=n||{},this.dev=!!n.dev,this.autoesc=!!n.autoescape,this.loaders=e?t.isArray(e)?e:[e]:r.FileSystemLoader?[new r.FileSystemLoader("views")]:[new r.WebLoader("/views")],this.initCache(),this.filters={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],n.tags&&i.setTags(n.tags);for(var s in o)this.addFilter(s,o[s])},initCache:function(){var e={};t.each(this.loaders,function(t){t.on("update",function(t){e[t]=null})}),this.cache=e},addExtension:function(e,t){t._name=e,this.extensions[e]=t,this.extensionsList.push(t)},getExtension:function(e){return this.extensions[e]},addFilter:function(e,t,n){var i=t;n&&this.asyncFilters.push(e),this.filters[e]=i},getFilter:function(e){if(!this.filters[e])throw new Error("filter not found: "+e);return this.filters[e]},getTemplate:function(e,n,i){if(e&&e.raw&&(e=e.raw),t.isFunction(n)&&(i=n,n=!1),"string"!=typeof e)throw new Error("template names must be a string: "+e);var s=this.cache[e];if(!s){var o;return t.asyncIter(this.loaders,function(t,n,i,s){function o(e){e?s(e):i()}t.async?t.getSource(e,function(e,t){if(e)throw e;o(t)}):o(t.getSource(e))},function(t){if(t){var s=new h(t.src,this,t.path,n);t.noCache||(this.cache[e]=s),i?i(null,s):o=s}else{var r=new Error("template not found: "+e);if(!i)throw r;i(r)}}.bind(this)),o}return n&&s.compile(),i?void i(null,s):s},express:function(e){function t(e){this.name=e,this.path=e}var n=this;t.prototype.render=function(e,t){n.render(this.name,e,t)},e.set("view",t)},render:function(e,n,i){t.isFunction(n)&&(i=n,n=null);var s=null;return this.getTemplate(e,function(e,t){if(e&&i)i(e);else{if(e)throw e;t.render(n,i||function(e,t){if(e)throw e;s=t})}}),s},renderString:function(e,t,n){var i=new h(e,this);return i.render(t,n)}}),u=n.extend({init:function(e,t){this.ctx=e,this.blocks={},this.exported=[];for(var n in t)this.addBlock(n,t[n])},lookup:function(e){return e in l&&!(e in this.ctx)?l[e]:this.ctx[e]},setVariable:function(e,t){this.ctx[e]=t},getVariables:function(){return this.ctx},addBlock:function(e,t){this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t)},getBlock:function(e){if(!this.blocks[e])throw new Error('unknown block "'+e+'"');return this.blocks[e][0]},getSuper:function(e,t,n,i,s,o){var r=(this.blocks[t]||[]).indexOf(n),a=this.blocks[t][r+1],l=this;if(-1==r||!a)throw new Error('no super block available for "'+t+'"');a(e,l,i,s,o)},addExport:function(e){this.exported.push(e)},getExported:function(){for(var e={},t=0;t<this.exported.length;t++){var n=this.exported[t];e[n]=this.ctx[n]}return e}}),h=n.extend({init:function(e,n,i,s){if(this.env=n||new d,t.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj}else{if(!t.isString(e))throw new Error("src must be a string or an object describing the source");this.tmplStr=e}this.path=i,s?t.withPrettyErrors(this.path,this.env.dev,this._compile.bind(this)):this.compiled=!1},render:function(e,n,i){return"function"==typeof e?(i=e,e={}):"function"==typeof n&&(i=n,n=null),t.withPrettyErrors(this.path,this.env.dev,function(){this.compile();var t=new u(e||{},this.blocks),s=null;return this.rootRenderFunc(this.env,t,n||new c,a,i||function(e,t){if(e)throw e;s=t}),s}.bind(this))},getExported:function(e){this.compile();var t=new u({},this.blocks);this.rootRenderFunc(this.env,t,new c,a,function(){e(null,t.getExported())})},compile:function(){this.compiled||this._compile()},_compile:function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=s.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path),n=new Function(t);e=n()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},_getBlocks:function(e){var t={};for(var n in e)"b_"==n.slice(0,2)&&(t[n.slice(2)]=e[n]);return t}});e.environment={Environment:d,Template:h}}();var t,n=e.lib,i=e.environment,s=e.compiler,o=e.parser,r=e.lexer,a=e.runtime,l=(e.loader,e.loaders),c=e.precompile;t={},t.Environment=i.Environment,t.Template=i.Template,t.Loader=i.Loader,t.FileSystemLoader=l.FileSystemLoader,t.WebLoader=l.WebLoader,t.compiler=s,t.parser=o,t.lexer=r,t.runtime=a;var d;t.configure=function(e,t){t=t||{},n.isObject(e)&&(t=e,e=null);var s="watch"in t?!t.watch:!1,o=l.FileSystemLoader||l.WebLoader;return d=new i.Environment(new o(e,s),t),t&&t.express&&d.express(t.express),d},t.compile=function(e,n,i,s){return d||t.configure(),new t.Template(e,n,i,s)},t.render=function(e,n,i){return d||t.configure(),d.render(e,n,i)},t.renderString=function(e,n,i){return d||t.configure(),d.renderString(e,n,i)},c&&(t.precompile=c.precompile,t.precompileString=c.precompileString),t.require=function(t){return e[t]},"function"==typeof define&&define.amd?define("nunjucks",[],function(){return t}):window.nunjucks=t}();var MONTH=["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],FMONTH=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"];define("NunjucksFilters",[],function(){var e={decline:function(e,t,n,i){if(2===arguments.length){var s=t.split("|");t=s[0],n=s[1],i=s[2]}return e=parseInt(e,10),11===e||12===e||13===e||14===e||e%10===0?t:e%10===1?n:e%10===2||e%10===3||e%10===4?i:t},money:function(e,t,n,i){t=isNaN(t=Math.abs(t))?2:t,n=void 0===n?",":n,i=void 0===i?" ":i;var s=0>e?"-":"",o=parseInt(e=Math.abs(+e||0).toFixed(t),10)+"",r=(r=o.length)>3?r%3:0;return s+(r?o.substr(0,r)+i:"")+o.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+i)+(t?n+Math.abs(e-o).toFixed(t).slice(2):"")},strftime:function(e,t){var n=e.getDate(),i=10>n?"0"+n:String(n),s=e.getMonth()+1,o=10>s?"0"+s:String(s),r=String(e.getFullYear()).substr(2),a=e.getFullYear(),l=MONTH[s],c=FMONTH[s];return t=t.split("%y").join(r),t=t.split("%Y").join(String(a)),t=t.split("%d").join(String(n)),t=t.split("%D").join(String(i)),t=t.split("%m").join(String(s)),t=t.split("%M").join(String(o)),t=t.split("%b").join(String(l)),t=t.split("%B").join(String(c))},encodeData:function(e){return encodeURIComponent(e).replace(/\-/g,"%2D").replace(/\_/g,"%5F").replace(/\./g,"%2E").replace(/\!/g,"%21").replace(/\~/g,"%7E").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")},decodeData:function(e){try{return decodeURIComponent(e.replace(/\%2D/g,"-").replace(/\%5F/g,"_").replace(/\%2E/g,".").replace(/\%21/g,"!").replace(/\%7E/g,"~").replace(/\%2A/g,"*").replace(/\%27/g,"'").replace(/\%28/g,"(").replace(/\%29/g,")"))
}catch(t){}return""}};return e}),define("app/events/DisplayModeEvent",[],function(){var e={MODE_LINES:"DisplayModeEvent:DISPLAY_MODE_LINES",MODE_LETTERS:"DisplayModeEvent:DISPLAY_MODE_LETTERS",MODE_PARAGRAPHS:"DisplayModeEvent:DISPLAY_MODE_PARAGRAPHS"};return e}),define("app/events/FaceModeEvent",[],function(){var e={MODE_SETS:"FaceModeEvent:FACE_MODE_SETS",MODE_FONTS:"FaceModeEvent:FACE_MODE_FONTS"};return e}),define("app/events/FilterEvent",[],function(){var e={ADD:"FilterEvent:add",DEL:"FilterEvent:del"};return e}),define("app/models/FilterModel",["backbone"],function(e){var t=e.Model.extend({defaults:{},initialize:function(){},validate:function(e){return _.isUndefined(e.name)?"filter should have a name":_.isUndefined(e.label)?"filter should have a display name":!_.isUndefined(e.from)&&_.isUndefined(e.to)||!_.isUndefined(e.from)&&_.isUndefined(e.to)?"filter should have from an to values":void 0}});return t}),define("app/collections/FilterCollection",["backbone","app/models/FilterModel"],function(e,t){var n=e.Collection.extend({model:t,initialize:function(){},fill:function(){},comparator:function(e){return e.cid},toURL:function(){var e=[];return _.each(this.toJSON(),function(t,n){e[n]=t.from?t.name+"="+t.from+":"+t.to:t.value?t.name+"="+t.value:t.name}),e.join("/")}});return n}),define("app/models/FontSetModel",["backbone"],function(e){var t=e.Model.extend({defaults:{fontFace:"",setName:"",fontName:"",fullName:"",subSets:null,css:null,price:0,subSetCount:0,isFavorite:!1,isInTypeTester:!1,isInBucket:!1,sampleTextLine:null,sampleTextParagraph:null,description:"",tags:[],languages:[],licences:{},tryLink:null,pdfLink:null},url:function(){return"/jsonFonts/font/"+(this.get("id")?this.get("id"):"")},set:function(t,n){if(""===t.setName&&""!==t.fontName?t.setName=t.fontName:""===t.fontName&&""!==t.setName&&(t.fontName=t.setName),""===t.fullName&&(""!==t.fontName||""!==t.setName)){var i=t.setName?t.setName:this.get("setName"),s=t.fontName?t.fontName:this.get("fontName");t.fullName=i&&s&&i!==s?i+" "+s:i?i:s}"isInBucket"===t?n?e.trigger("fontset:toBucket",this):e.trigger("fontset:fromBucket",this):"isFavorite"===t?n?e.trigger("fontset:toFavorites",this):e.trigger("fontset:fromFavorites",this):"isInTypeTester"===t&&(n?e.trigger("fontset:toTypeTester",this):e.trigger("fontset:fromTypeTester",this)),e.Model.prototype.set.call(this,t,n)},checkBucket:function(){_.size(this.get("licences"))>0?this.set("isInBucket")||this.set("isInBucket",!0):this.set("isInBucket")&&this.set("isInBucket",!1)},initialize:function(){this.bind("change:setName",this.updateName,this),this.bind("change:fontName",this.updateName,this),this.bind("change:id",this.onID,this)},onID:function(){this.url=function(){return"/jsonFonts/font/"+this.get("id")}},updateName:function(){""===this.get("setName")&&""!==this.get("fontName")?this.set("setName",this.get("fontName")):""===this.get("fontName")&&""!==this.get("setName")&&this.set("fontName",this.get("setName"));var e=this.get("setName"),t=this.get("fontName");e&&t&&e!==t?this.set("fullName",e+" "+t):e?this.set("fullName",e):this.set("fullName",t)}});return t}),define("app/collections/FontSetCollection",["backbone","app/models/FontSetModel"],function(e,t){var n=e.Collection.extend({allCount:0,filters:null,model:t,initialize:function(e,t){t&&t.filters&&(this.filters=t.filters,this.listenTo(this.filters,"add",this.repopulate),this.listenTo(this.filters,"remove",this.repopulate),this.listenTo(this.filters,"change",this.repopulate)),e&&e.length>0&&this.pluckRandom(e)},pluckRandom:function(t){var n=_.pluck(t,"fontFace"),i=n[Math.floor(Math.random()*n.length)];i&&e.trigger("change:logo",i)},url:function(){return"/jsonFonts/"+(this.filters.length>0?"filters/"+this.filters.toURL()+"/":"")+"limit/50/offset="+this.length},parse:function(t,n){return this.allCount=t.allCount,this.pluckRandom(t.fonts),e.Collection.prototype.parse.call(this,t.fonts,n)},repopulate:function(){this.fetch({reset:!0})}});return n}),define("app/models/BucketModel",["backbone","app/collections/FontSetCollection"],function(e,t){var n=e.Model.extend({_fontSets:null,defaults:{promoCode:null,price:null,payers:[{id:"0",title:"Red Keds"},{id:"1",title:"Ked Reds"}]},initialize:function(n){_.bindAll(this,"getFontSets","getPrice","onChanged"),this.listenTo(e,"fontset:toBucket",this.addToBucket),this.listenTo(e,"fontset:fromBucket",this.removeBucket),this._fontSets=n&&n.fontSets?n.fontSets:new t,this._licences=n.licences,this.listenTo(this._fontSets,"remove",this.onChanged),this.listenTo(this._fontSets,"add",this.onChanged)},onChanged:function(){this.trigger("change")},addToBucket:function(e){this._fontSets.add(e)},removeBucket:function(e){this._fontSets.remove(e)},getFontSets:function(){return this._fontSets},getLicences:function(){return this.get("licences")},getPrice:function(){return this.get("price")},toJSON:function(){var t=e.Model.prototype.toJSON.call(this);return t.fontSets=this._fontSets.toJSON(),t}});return n}),define("app/models/FavoriteModel",["backbone","app/models/FontSetModel","app/collections/FontSetCollection"],function(e,t,n){var i=t.extend({defaults:{id:null,title:null},url:function(){return"/jsonFavorite/"+(this.isNew()?"":this.get("id"))},initialize:function(e){this.fonts=new n(e&&e.fonts?e.fonts:[]),this.listenTo(this.fonts,"add",this.onChanged,this),this.listenTo(this.fonts,"remove",this.onChanged,this)},toJSON:function(){var t=e.Model.prototype.toJSON.call(this);return t.fonts=this.fonts.toJSON(),t},onChanged:function(){this.trigger("change")},parse:function(t){var n=t.fonts;delete t.fonts;var i=e.Model.prototype.parse.call(this,t);return this.fonts.parse(n),i}});return i}),define("app/collections/FavoritesCollection",["backbone","app/models/FavoriteModel","app/collections/FontSetCollection"],function(e,t,n){var i=e.Collection.extend({model:t,initialize:function(){},fill:function(){},url:"favorites",toURL:function(){var e=[];return _.each(this.toJSON(),function(t,n){e[n]=t.from?t.name+"="+t.from+":"+t.to:t.value?t.name+"="+t.value:t.name}),e.join("/")},comparator:function(e){return e.get("title").toLowerCase()},getPlainCollection:function(){var e=this.reduce(function(e,t){return e.concat(t.fonts.toJSON())},[]);return new n(e)}});return i}),define("app/models/ArchiveModel",["backbone","app/models/FontSetModel","app/collections/FontSetCollection"],function(e,t,n){var i=t.extend({defaults:{id:null},url:function(){return"/jsonArchive/"+(this.isNew()?"":this.get("id"))},initialize:function(e){this.fonts=new n(e&&e.fonts?e.fonts:[]),this.listenTo(this.fonts,"add",this.onChanged,this),this.listenTo(this.fonts,"remove",this.onChanged,this),this.set("date",new Date(parseInt(this.get("date"),10)))},toJSON:function(){var t=e.Model.prototype.toJSON.call(this);return t.fonts=this.fonts.toJSON(),t},onChanged:function(){this.trigger("change")},parse:function(t){console.log("parse",t);var n=t.fonts;delete t.fonts;var i=e.Model.prototype.parse.call(this,t);return this.fonts.parse(n),i}});return i}),define("app/collections/ArchiveCollection",["backbone","app/models/ArchiveModel","app/collections/FontSetCollection"],function(e,t,n){var i=e.Collection.extend({model:t,initialize:function(){},fill:function(){},url:"archive",toURL:function(){var e=[];return _.each(this.toJSON(),function(t,n){e[n]=t.from?t.name+"="+t.from+":"+t.to:t.value?t.name+"="+t.value:t.name}),e.join("/")},comparator:function(e){return-e.get("date").getTime()},getPlainCollection:function(){var e=this.reduce(function(e,t){return e.concat(t.fonts.toJSON())},[]);return new n(e)}});return i}),define("app/models/TypetesterModel",["backbone","app/collections/FontSetCollection","app/models/FontSetModel"],function(e,t,n){var i=e.Model.extend({initialize:function(){this.set("selectCollection",new t),this.set("typetestedCollection",new t),this.listenTo(e,"fontset:toTypeTester",function(e){var t=new n;t.url="/jsonFonts/fullfont/"+e.get("id"),this.get("typetestedCollection").add(t),t.fetch()}),this.listenTo(e,"fontset:fromTypeTester",function(e){this.get("typetestedCollection").remove(e)})}});return i}),define("app/models/AppModel",["backbone","nunjucks","NunjucksFilters","app/events/DisplayModeEvent","app/events/FaceModeEvent","app/events/FilterEvent","app/collections/FilterCollection","app/collections/FontSetCollection","app/models/BucketModel","app/collections/FavoritesCollection","app/collections/ArchiveCollection","app/models/TypetesterModel"],function(e,t,n,i,s,o,r,a,l,c,d,u){var h=i.MODE_LINES,p=s.MODE_SETS,f=!1,v={},m=16,g=null,b="",y=e.Model.extend({_interfaceLocked:!1,nunjucks:null,_filters:new r,initialize:function(){_.bindAll(this,"preload","getPangramme","getNightMode","getDisplayMode","getSizeMode","getFaceMode","getImageURL","getFontListImageURL","onAddFilterEvent","onDelFilterEvent"),this._favoritesCollection=new c(this.getCachedFavorites()),this._archiveCollection=new d(this.getCachedArchive()),this._typetesterModel=new u,g=new l({licences:this.getLicenceList()}),this.listenTo(e,o.ADD,this.onAddFilterEvent),this.listenTo(e,o.DEL,this.onDelFilterEvent),this.listenTo(e,"change:logo",this.onChangeLogo,this),this.listenTo(e,"share",this.share,this),this.listenTo(e,"share:favorite",this.shareFavorite,this),this.listenTo(e,"share:info",this.shareInfo,this),this.listenTo(e,"DisplayModeEvent",function(e){h=e}),this.listenTo(e,"FaceModeEvent",function(t){p=t,t===s.MODE_SETS?e.trigger(o.DEL,"typefaces"):e.trigger(o.ADD,{name:"typefaces"})}),this.listenTo(e,"NightModeEvent",function(e){f=e}),this.listenTo(e,"PangrammeModeEvent",function(e){v[e.type]=e}),this.listenTo(e,"SizeModeEvent",function(e){m=e}),this.nunjucks=t.configure("views",{autoescape:!0}),this.nunjucks.addFilter("decline",n.decline),this.nunjucks.addFilter("money",n.money),this.nunjucks.addFilter("encode",n.encodeData),this.nunjucks.addFilter("decode",n.decodeData),this.nunjucks.addFilter("strftime",n.strftime),this.preload([])},onChangeLogo:function(e){b=e},getLogoFont:function(){return b},getLicenceList:function(){return window.licences},getCachedFonts:function(){return window.fonts},getCachedFavorites:function(){return window.favorites},getCachedArchive:function(){return window.archive},getCachedFilters:function(){return window.filters},getCachedAdviser:function(){return window.adviser},getPlainFilters:function(){function e(t,n){if(t.filters)for(var i=0,s=t.filters.length;s>i;i++)e(t.filters[i],n);else n.push(t);return n}return e({filters:this.getCachedFilters()},[])},isApple:function(){var e=/iphone|ipod|ipad/.test(navigator.userAgent.toLowerCase());return e},isMobile:function(){var e=/iphone|ipod|ipad|android|blackberry/.test(navigator.userAgent.toLowerCase());return e},preload:function(e){$.each(e,function(e,t){$("<img />").attr("src",t)})},getNightMode:function(){return f},getDisplayMode:function(){return h},getSizeMode:function(){return m},getFaceMode:function(){return p},isInterfaceLocked:function(){return this._interfaceLocked},lockeInterface:function(e){this._interfaceLocked=e},getFontListImageURL:function(e){return e.nightMode=this.getNightMode(),e.displayMode=this.getDisplayMode(),e.fontSize=this.getSizeMode(),this.getImageURL(e)},getImageURL:function(e){var t="/image/";return t+="dayNight="+(e.nightMode?"1/":"0/"),t+="displayStyle="+(e.displayMode===i.MODE_LINES?"0/":e.displayMode===i.MODE_LETTERS?"1/":"2/"),delete e.nightMode,delete e.displayMode,t+=_.reduce(_.keys(e),function(t,n){return t+(n+"="+encodeURIComponent(e[n]))+"/"},"")},onAddFilterEvent:function(t,n){("promo"===t.type||this._filters.findWhere({type:"promo"}))&&this._filters.reset([],{silent:!0}),_.where(t,{name:"typefaces"}).length>0&&e.trigger("FaceModeEvent",s.MODE_FONTS);var i=this._filters.findWhere({name:t.name});i?(i.set(t.value?{value:Math.floor(t.value)}:{from:Math.floor(t.from),to:Math.floor(t.to)}),n&&n.silent||this._filters.trigger("change")):this._filters.push(t,n)},onDelFilterEvent:function(e){if(e)this._filters.remove(this._filters.findWhere({name:e}));else{var t=this._filters.filter(function(e){return"typefaces"===e.get("name")||"webfonts"===e.get("name")});this._filters.reset(t),this._filters.trigger("change")}},getFilters:function(){return this._filters},getPangrammes:function(e){return _.where(window.pangrammes,{type:e})},getPangramme:function(e){var t=v[e];return t?t:_.where(window.pangrammes,{type:e})[0]},getTypetesterModel:function(){return this._typetesterModel},getFavoritesCollection:function(){return this._favoritesCollection},getArchiveCollection:function(){return this._archiveCollection},getBucketModel:function(){return g},shareInfo:function(e,t){this.share(e,t.title,t.title,"/info/"+t.name)},shareFavorite:function(e,t){this.share(e,t.get("title"),t.get("title"),"/favorite/"+t.get("id"))},share:function(e,t,n,i){var s,o=this.baseUrl+"/share.jpg",r=encodeURIComponent(t),a=encodeURIComponent(n),l=encodeURIComponent(this.baseUrl+i),c=encodeURIComponent(o);"facebook"===e?FB&&FB.ui({method:"feed",name:t,link:this.baseUrl+i,picture:o,caption:"",description:n+"\n"+this.baseUrl+i}):"twitter"===e?s=window.open("http://twitter.com/share?url="+l+"&title="+r+"&text="+a,"tw_share","width=500,height=400,resizable=no,scrollbars=no,status=no"):"vkontakte"===e&&(s=window.open("http://vkontakte.ru/share.php?url="+l+"&image="+c+"&title="+r+"&description="+a,"vk_share","width=500,height=400,resizable=no,scrollbars=no,status=no")),s&&s.focus()},baseUrl:"http://pasha.dev.studio7.com.ua/paratype.src"});return new y}),define("app/routers/MainRouter",["backbone","app/events/FilterEvent","app/events/FaceModeEvent"],function(e,t){function n(e){var t={};if(e){for(var n=e.split("/"),s=null,o=[],r=0,a=n.length;a>r;r++){var l=n[r];if(_.indexOf(i,l)>=0)s&&o&&(t[s]=o,o=[]),s=l;else if(l)if(l.indexOf("=")<0)o.push({name:l});else{var c=l.split("="),d={name:c[0]};if(c[1].indexOf(":")>0){var u=c[1].split(":");d.from=parseFloat(u[0],10),d.to=parseFloat(u[1],10)}else d.value=parseInt(c[1],10);o.push(d)}}o&&(s?t[s]=o:t.filters=o)}return t}var i=["filters","fonts","cart","favorits","offset","limit"],s=e.Router.extend({QUERY_SECTION:"section",QUERY_FONT:"fonts",QUERY_FILTER:"filters",QUERY_ORDERD:"ordered",filters:null,filterCollection:null,routes:{"cart(/)(*tagline)":"bucket","(*tagline)":"index"},initialize:function(e){_.bindAll(this,"onRouted","update"),e&&e.filters&&(this.filters=e.filters),e&&e.filterCollection&&(this.filterCollection=e.filterCollection,this.listenTo(this.filterCollection,"change",this.update),this.listenTo(this.filterCollection,"add",this.update),this.listenTo(this.filterCollection,"remove",this.update))},update:function(){this.filterCollection.length>0?this.navigate("filters/"+this.filterCollection.toURL()):this.navigate()},navigateTo:function(e){e=e?e:{};var t="";_.has(e,"section")&&(t+="/"+e.section),_.has(e,"ordered")&&(t+=["/:",this.QUERY_ORDERD,":/",e[this.QUERY_ORDERD].join("/")].join("")),_.has(e,this.QUERY_FONT)&&(t+=["/:",this.QUERY_FONT,":/",e[this.QUERY_FONT].join("/")].join("")),_.has(e,this.QUERY_FILTER)&&(t+=["/:",this.QUERY_FILTER,":/",_.map(e[this.QUERY_FILTER],function(e){return _.pairs(e)[0].join("=")}).join("/")].join("")),this.navigate(t)},onSection:function(){},onRouted:function(n){var i,s=[];n.filters&&_.each(n.filters,function(e){i=_.findWhere(this.filters,{name:e.name}),i?s.push(_.extend(i,e)):!e||"typefaces"!==e.name&&"webfonts"!==e.name||s.push(e)},this),setTimeout(function(){e.trigger(t.ADD,s,{silent:!0})},500)},index:function(e){this.onRouted(n(e))},bucket:function(e){var t=n(e);this.onSection("bucket",t),this.onRouted(t)}});return s}),require(["backbone"],function(e){e.InfiniScroll=function(e,t){function n(e){var t={};return t[o.options.param]="function"==typeof e[o.options.untilAttr]?e[o.options.untilAttr]():e.get(o.options.untilAttr),t[o.options.pageSizeParam]=o.options.pageSize,o.options.includePage&&(t.page=s+1),t}t=t||{};var i,s,o={},r=e.length||25;o.collection=e,o.options=_.defaults(t,{success:function(){},error:function(){},onFetch:function(){},param:"until",extraParams:{},pageSizeParam:"page_size",untilAttr:"id",pageSize:r,scrollOffset:100,remove:!1,strict:!0,includePage:!1});var a=function(){i=!0,s=1};return o.resetScroll=function(){i=!0,s=1},o.enableFetch=function(){i=!0},o.disableFetch=function(){i=!1},o.onFetch=function(){o.options.onFetch()},o.fetchSuccess=function(e,t){o.options.strict&&e.length>=(s+1)*o.options.pageSize||!o.options.strict&&t.length>0?(o.enableFetch(),s+=1):o.disableFetch(),o.options.forwardSuccess?o.options.forwardSuccess(e,t):o.options.success(e,t)},o.fetchBackwardSuccess=function(e,t){o.options.strict&&e.length>=(s+1)*o.options.pageSize||!o.options.strict&&t.length>0?(o.enableFetch(),s+=1):o.disableFetch(),o.options.backwardSuccess?o.options.backwardSuccess(e,t):o.options.success(e,t)},o.fetchError=function(e,t){o.enableFetch(),o.options.error(e,t)},o.fetchForward=function(){o.collection.set=o.collection.appendSet,o.fetch({success:o.fetchSuccess,url:o.collection.forwardURL()})},o.fetchBackward=function(){o.collection.backwardURL&&(o.collection.set=o.collection.prependSet,o.fetch({success:o.fetchBackwardSuccess,url:o.collection.backwardURL()}))},o.fetch=function(e){var t=o.collection.last();t&&(o.onFetch(),o.disableFetch(),o.collection.fetch(_.extend({success:o.fetchSuccess,error:o.fetchError,remove:o.options.remove,data:$.extend(n(t),o.options.extraParams)},e)))},a(),o}}),define("bb.InfiniScroll",function(){}),function(e){"function"==typeof define&&define.amd?define("jq.mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var o=t||window.event,r=a.call(arguments,1),l=0,c=0,d=0,u=0;return t=e.event.fix(o),t.type="mousewheel","detail"in o&&(d=-1*o.detail),"wheelDelta"in o&&(d=o.wheelDelta),"wheelDeltaY"in o&&(d=o.wheelDeltaY),"wheelDeltaX"in o&&(c=-1*o.wheelDeltaX),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(c=-1*d,d=0),l=0===d?c:d,"deltaY"in o&&(d=-1*o.deltaY,l=d),"deltaX"in o&&(c=o.deltaX,0===d&&(l=-1*c)),0!==d||0!==c?(u=Math.max(Math.abs(d),Math.abs(c)),(!s||s>u)&&(s=u),l=Math[l>=1?"floor":"ceil"](l/s),c=Math[c>=1?"floor":"ceil"](c/s),d=Math[d>=1?"floor":"ceil"](d/s),t.deltaX=c,t.deltaY=d,t.deltaFactor=s,r.unshift(t,l,c,d),i&&clearTimeout(i),i=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,r)):void 0}function n(){s=null}var i,s,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],a=Array.prototype.slice;if(e.event.fixHooks)for(var l=o.length;l;)e.event.fixHooks[o[--l]]=e.event.mouseHooks;e.event.special.mousewheel={version:"3.1.6",setup:function(){if(this.addEventListener)for(var e=r.length;e;)this.addEventListener(r[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=r.length;e;)this.removeEventListener(r[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(e){var t={init:function(t){var n={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,alwaysShowScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},t=e.extend(!0,n,t);return this.each(function(){var n=e(this);if(t.set_width&&n.css("width",t.set_width),t.set_height&&n.css("height",t.set_height),e(document).data("mCustomScrollbar-index")){var i=parseInt(e(document).data("mCustomScrollbar-index"));e(document).data("mCustomScrollbar-index",i+1)}else e(document).data("mCustomScrollbar-index","1");n.wrapInner("<div class='mCustomScrollBox mCS-"+t.theme+"' id='mCSB_"+e(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+e(document).data("mCustomScrollbar-index"));var s=n.children(".mCustomScrollBox");if(t.horizontalScroll){s.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var o=s.children(".mCSB_h_wrapper");o.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:o.children().outerWidth(),position:"relative"}).unwrap()}else s.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var r=s.children(".mCSB_container");e.support.touch&&r.addClass("mCS_touch"),r.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var a=s.children(".mCSB_scrollTools"),l=a.children(".mCSB_draggerContainer"),c=l.children(".mCSB_dragger");if(t.horizontalScroll?c.data("minDraggerWidth",c.width()):c.data("minDraggerHeight",c.height()),t.scrollButtons.enable&&(t.horizontalScroll?a.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):a.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),s.bind("scroll",function(){n.is(".mCS_disabled")||s.scrollTop(0).scrollLeft(0)}),n.data({mCS_Init:!0,mCustomScrollbarIndex:e(document).data("mCustomScrollbar-index"),horizontalScroll:t.horizontalScroll,scrollInertia:t.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:t.mouseWheel,mouseWheelPixels:t.mouseWheelPixels,autoDraggerLength:t.autoDraggerLength,autoHideScrollbar:t.autoHideScrollbar,alwaysShowScrollbar:t.alwaysShowScrollbar,snapAmount:t.snapAmount,snapOffset:t.snapOffset,scrollButtons_enable:t.scrollButtons.enable,scrollButtons_scrollType:t.scrollButtons.scrollType,scrollButtons_scrollSpeed:t.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:t.scrollButtons.scrollAmount,autoExpandHorizontalScroll:t.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:t.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:t.advanced.normalizeMouseWheelDelta,contentTouchScroll:t.contentTouchScroll,onScrollStart_Callback:t.callbacks.onScrollStart,onScroll_Callback:t.callbacks.onScroll,onTotalScroll_Callback:t.callbacks.onTotalScroll,onTotalScrollBack_Callback:t.callbacks.onTotalScrollBack,onTotalScroll_Offset:t.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:t.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:t.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),t.horizontalScroll)"none"!==n.css("max-width")&&(t.advanced.updateOnContentResize||(t.advanced.updateOnContentResize=!0));else if("none"!==n.css("max-height")){var d=!1,u=parseInt(n.css("max-height"));n.css("max-height").indexOf("%")>=0&&(d=u,u=n.parent().height()*d/100),n.css("overflow","hidden"),s.css("max-height",u)}if(n.mCustomScrollbar("update"),t.advanced.updateOnBrowserResize){var h,p=e(window).width(),f=e(window).height();e(window).bind("resize."+n.data("mCustomScrollbarIndex"),function(){h&&clearTimeout(h),h=setTimeout(function(){if(!n.is(".mCS_disabled")&&!n.is(".mCS_destroyed")){var t=e(window).width(),i=e(window).height();(p!==t||f!==i)&&("none"!==n.css("max-height")&&d&&s.css("max-height",n.parent().height()*d/100),n.mCustomScrollbar("update"),p=t,f=i)}},150)})}if(t.advanced.updateOnContentResize){var v;if(t.horizontalScroll)var m=r.outerWidth();else var m=r.outerHeight();v=setInterval(function(){if(t.horizontalScroll){t.advanced.autoExpandHorizontalScroll&&r.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:r.outerWidth(),position:"relative"}).unwrap();var e=r.outerWidth()}else var e=r.outerHeight();e!=m&&(n.mCustomScrollbar("update"),m=e)},300)}})},update:function(){var t=e(this),n=t.children(".mCustomScrollBox"),i=n.children(".mCSB_container");i.removeClass("mCS_no_scrollbar"),t.removeClass("mCS_disabled mCS_destroyed"),n.scrollTop(0).scrollLeft(0);var s=n.children(".mCSB_scrollTools"),o=s.children(".mCSB_draggerContainer"),r=o.children(".mCSB_dragger");if(t.data("horizontalScroll")){var a=s.children(".mCSB_buttonLeft"),l=s.children(".mCSB_buttonRight"),c=n.width();t.data("autoExpandHorizontalScroll")&&i.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:i.outerWidth(),position:"relative"}).unwrap();var d=i.outerWidth()}else var u=s.children(".mCSB_buttonUp"),h=s.children(".mCSB_buttonDown"),p=n.height(),f=i.outerHeight();if(f>p&&!t.data("horizontalScroll")){s.css("display","block");var v=o.height();if(t.data("autoDraggerLength")){var m=Math.round(p/f*v),g=r.data("minDraggerHeight");if(g>=m)r.css({height:g});else if(m>=v-10){var b=v-10;r.css({height:b})}else r.css({height:m});r.children(".mCSB_dragger_bar").css({"line-height":r.height()+"px"})}var y=r.height(),w=(f-p)/(v-y);t.data("scrollAmount",w).mCustomScrollbar("scrolling",n,i,o,r,u,h,a,l);var _=Math.abs(i.position().top);t.mCustomScrollbar("scrollTo",_,{scrollInertia:0,trigger:"internal"})}else if(d>c&&t.data("horizontalScroll")){s.css("display","block");var x=o.width();if(t.data("autoDraggerLength")){var k=Math.round(c/d*x),S=r.data("minDraggerWidth");if(S>=k)r.css({width:S});else if(k>=x-10){var C=x-10;r.css({width:C})}else r.css({width:k})}var T=r.width(),w=(d-c)/(x-T);t.data("scrollAmount",w).mCustomScrollbar("scrolling",n,i,o,r,u,h,a,l);var _=Math.abs(i.position().left);t.mCustomScrollbar("scrollTo",_,{scrollInertia:0,trigger:"internal"})}else n.unbind("mousewheel focusin"),t.data("horizontalScroll")?r.add(i).css("left",0):r.add(i).css("top",0),t.data("alwaysShowScrollbar")?t.data("horizontalScroll")?t.data("horizontalScroll")&&r.css({width:o.width()}):r.css({height:o.height()}):(s.css("display","none"),i.addClass("mCS_no_scrollbar")),t.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(t,i,s,o,r,a,l,c){function d(e,t,n,i){p.data("horizontalScroll")?p.mCustomScrollbar("scrollTo",o.position().left-t+i,{moveDragger:!0,trigger:"internal"}):p.mCustomScrollbar("scrollTo",o.position().top-e+n,{moveDragger:!0,trigger:"internal"})}function u(e){o.data("preventAction")||(o.data("preventAction",!0),p.mCustomScrollbar("scrollTo",e,{trigger:"internal"}))}function h(){var e=p.data("scrollButtons_scrollSpeed");return"auto"===p.data("scrollButtons_scrollSpeed")&&(e=Math.round((p.data("scrollInertia")+100)/40)),e}var p=e(this);if(!p.data("bindEvent_scrollbar_drag")){var f,v,m,g,b;e.support.pointer?(m="pointerdown",g="pointermove",b="pointerup"):e.support.msPointer&&(m="MSPointerDown",g="MSPointerMove",b="MSPointerUp"),e.support.pointer||e.support.msPointer?(o.bind(m,function(t){t.preventDefault(),p.data({on_drag:!0}),o.addClass("mCSB_dragger_onDrag");var n=e(this),i=n.offset(),s=t.originalEvent.pageX-i.left,r=t.originalEvent.pageY-i.top;s<n.width()&&s>0&&r<n.height()&&r>0&&(f=r,v=s)}),e(document).bind(g+"."+p.data("mCustomScrollbarIndex"),function(e){if(e.preventDefault(),p.data("on_drag")){var t=o,n=t.offset(),i=e.originalEvent.pageX-n.left,s=e.originalEvent.pageY-n.top;d(f,v,s,i)}}).bind(b+"."+p.data("mCustomScrollbarIndex"),function(){p.data({on_drag:!1}),o.removeClass("mCSB_dragger_onDrag")})):(o.bind("mousedown touchstart",function(t){t.preventDefault(),t.stopImmediatePropagation();var n,i,s=e(this),r=s.offset();if("touchstart"===t.type){var a=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];n=a.pageX-r.left,i=a.pageY-r.top}else p.data({on_drag:!0}),o.addClass("mCSB_dragger_onDrag"),n=t.pageX-r.left,i=t.pageY-r.top;n<s.width()&&n>0&&i<s.height()&&i>0&&(f=i,v=n)}).bind("touchmove",function(t){t.preventDefault(),t.stopImmediatePropagation();var n=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],i=e(this),s=i.offset(),o=n.pageX-s.left,r=n.pageY-s.top;d(f,v,r,o)}),e(document).bind("mousemove."+p.data("mCustomScrollbarIndex"),function(e){if(p.data("on_drag")){var t=o,n=t.offset(),i=e.pageX-n.left,s=e.pageY-n.top;d(f,v,s,i)}}).bind("mouseup."+p.data("mCustomScrollbarIndex"),function(){p.data({on_drag:!1}),o.removeClass("mCSB_dragger_onDrag")})),p.data({bindEvent_scrollbar_drag:!0})}if(e.support.touch&&p.data("contentTouchScroll")&&!p.data("bindEvent_content_touch")){var y,w,_,x,k,S,C;i.bind("touchstart",function(t){t.stopImmediatePropagation(),y=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],w=e(this),_=w.offset(),k=y.pageX-_.left,x=y.pageY-_.top,S=x,C=k}),i.bind("touchmove",function(t){t.preventDefault(),t.stopImmediatePropagation(),y=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],w=e(this).parent(),_=w.offset(),k=y.pageX-_.left,x=y.pageY-_.top,p.data("horizontalScroll")?p.mCustomScrollbar("scrollTo",C-k,{trigger:"internal"}):p.mCustomScrollbar("scrollTo",S-x,{trigger:"internal"})})}if(p.data("bindEvent_scrollbar_click")||(s.bind("click",function(t){var n=(t.pageY-s.offset().top)*p.data("scrollAmount"),i=e(t.target);p.data("horizontalScroll")&&(n=(t.pageX-s.offset().left)*p.data("scrollAmount")),(i.hasClass("mCSB_draggerContainer")||i.hasClass("mCSB_draggerRail"))&&p.mCustomScrollbar("scrollTo",n,{trigger:"internal",scrollEasing:"draggerRailEase"})}),p.data({bindEvent_scrollbar_click:!0})),p.data("mouseWheel")&&(p.data("bindEvent_mousewheel")||(t.bind("mousewheel",function(e,t){var n,r=p.data("mouseWheelPixels"),a=Math.abs(i.position().top),l=o.position().top,c=s.height()-o.height();p.data("normalizeMouseWheelDelta")&&(t=0>t?-1:1),"auto"===r&&(r=100+Math.round(p.data("scrollAmount")/2)),p.data("horizontalScroll")&&(l=o.position().left,c=s.width()-o.width(),a=Math.abs(i.position().left)),(t>0&&0!==l||0>t&&l!==c)&&(e.preventDefault(),e.stopImmediatePropagation()),n=a-t*r,p.mCustomScrollbar("scrollTo",n,{trigger:"internal"})}),p.data({bindEvent_mousewheel:!0}))),p.data("scrollButtons_enable"))if("pixels"===p.data("scrollButtons_scrollType"))p.data("horizontalScroll")?(c.add(l).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",T,E),p.data({bindEvent_buttonsContinuous_x:!1}),p.data("bindEvent_buttonsPixels_x")||(c.bind("click",function(e){e.preventDefault(),u(Math.abs(i.position().left)+p.data("scrollButtons_scrollAmount"))}),l.bind("click",function(e){e.preventDefault(),u(Math.abs(i.position().left)-p.data("scrollButtons_scrollAmount"))}),p.data({bindEvent_buttonsPixels_x:!0}))):(a.add(r).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",T,E),p.data({bindEvent_buttonsContinuous_y:!1}),p.data("bindEvent_buttonsPixels_y")||(a.bind("click",function(e){e.preventDefault(),u(Math.abs(i.position().top)+p.data("scrollButtons_scrollAmount"))}),r.bind("click",function(e){e.preventDefault(),u(Math.abs(i.position().top)-p.data("scrollButtons_scrollAmount"))}),p.data({bindEvent_buttonsPixels_y:!0})));else if(p.data("horizontalScroll")){if(c.add(l).unbind("click"),p.data({bindEvent_buttonsPixels_x:!1}),!p.data("bindEvent_buttonsContinuous_x")){c.bind("mousedown touchstart MSPointerDown pointerdown",function(e){e.preventDefault();
var t=h();p.data({mCSB_buttonScrollRight:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(i.position().left)+t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var T=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollRight"))};c.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",T),l.bind("mousedown touchstart MSPointerDown pointerdown",function(e){e.preventDefault();var t=h();p.data({mCSB_buttonScrollLeft:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(i.position().left)-t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var E=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollLeft"))};l.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",E),p.data({bindEvent_buttonsContinuous_x:!0})}}else if(a.add(r).unbind("click"),p.data({bindEvent_buttonsPixels_y:!1}),!p.data("bindEvent_buttonsContinuous_y")){a.bind("mousedown touchstart MSPointerDown pointerdown",function(e){e.preventDefault();var t=h();p.data({mCSB_buttonScrollDown:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(i.position().top)+t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var A=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollDown"))};a.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",A),r.bind("mousedown touchstart MSPointerDown pointerdown",function(e){e.preventDefault();var t=h();p.data({mCSB_buttonScrollUp:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(i.position().top)-t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var F=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollUp"))};r.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",F),p.data({bindEvent_buttonsContinuous_y:!0})}p.data("autoScrollOnFocus")&&(p.data("bindEvent_focusin")||(t.bind("focusin",function(){t.scrollTop(0).scrollLeft(0);var n=e(document.activeElement);if(n.is("input,textarea,select,button,a[tabindex],area,object")){var s=i.position().top,o=n.position().top,r=t.height()-n.outerHeight();p.data("horizontalScroll")&&(s=i.position().left,o=n.position().left,r=t.width()-n.outerWidth()),(0>s+o||s+o>r)&&p.mCustomScrollbar("scrollTo",o,{trigger:"internal"})}}),p.data({bindEvent_focusin:!0}))),p.data("autoHideScrollbar")&&!p.data("alwaysShowScrollbar")&&(p.data("bindEvent_autoHideScrollbar")||(t.bind("mouseenter",function(){t.addClass("mCS-mouse-over"),n.showScrollbar.call(t.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(e){t.removeClass("mCS-mouse-over"),"mouseleave"===e.type&&n.hideScrollbar.call(t.children(".mCSB_scrollTools"))}),p.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(t,i){function s(e){if(d.data("mCustomScrollbarIndex"))switch(this.mcs={top:p.position().top,left:p.position().left,draggerTop:m.position().top,draggerLeft:m.position().left,topPct:Math.round(100*Math.abs(p.position().top)/Math.abs(p.outerHeight()-h.height())),leftPct:Math.round(100*Math.abs(p.position().left)/Math.abs(p.outerWidth()-h.width()))},e){case"onScrollStart":d.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(d,this.mcs);break;case"whileScrolling":d.data("whileScrolling_Callback").call(d,this.mcs);break;case"onScroll":d.data("onScroll_Callback").call(d,this.mcs);break;case"onTotalScrollBack":d.data("onTotalScrollBack_Callback").call(d,this.mcs);break;case"onTotalScroll":d.data("onTotalScroll_Callback").call(d,this.mcs)}}var o,r,a,l,c,d=e(this),u={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:d.data("scrollInertia"),scrollEasing:d.data("scrollEasing")},i=e.extend(u,i),h=d.children(".mCustomScrollBox"),p=h.children(".mCSB_container"),f=h.children(".mCSB_scrollTools"),v=f.children(".mCSB_draggerContainer"),m=v.children(".mCSB_dragger"),g=draggerSpeed=i.scrollInertia;if(!p.hasClass("mCS_no_scrollbar")&&(d.data({mCS_trigger:i.trigger}),d.data("mCS_Init")&&(i.callbacks=!1),t||0===t)){if("number"==typeof t)i.moveDragger?(o=t,t=d.data("horizontalScroll")?m.position().left*d.data("scrollAmount"):m.position().top*d.data("scrollAmount"),draggerSpeed=0):o=t/d.data("scrollAmount");else if("string"==typeof t){var b;b="top"===t?0:"bottom"!==t||d.data("horizontalScroll")?"left"===t?0:"right"===t&&d.data("horizontalScroll")?p.outerWidth()-h.width():"first"===t?d.find(".mCSB_container").find(":first"):"last"===t?d.find(".mCSB_container").find(":last"):d.find(t):p.outerHeight()-h.height(),1===b.length?(t=d.data("horizontalScroll")?b.position().left:b.position().top,o=t/d.data("scrollAmount")):o=t=b}if(d.data("horizontalScroll")){d.data("onTotalScrollBack_Offset")&&(a=-d.data("onTotalScrollBack_Offset")),d.data("onTotalScroll_Offset")&&(c=h.width()-p.outerWidth()+d.data("onTotalScroll_Offset")),0>o?(o=t=0,clearInterval(d.data("mCSB_buttonScrollLeft")),a||(r=!0)):o>=v.width()-m.width()?(o=v.width()-m.width(),t=h.width()-p.outerWidth(),clearInterval(d.data("mCSB_buttonScrollRight")),c||(l=!0)):t=-t;var y=d.data("snapAmount");y&&(t=Math.round(t/y)*y-d.data("snapOffset")),n.mTweenAxis.call(this,m[0],"left",Math.round(o),draggerSpeed,i.scrollEasing),n.mTweenAxis.call(this,p[0],"left",Math.round(t),g,i.scrollEasing,{onStart:function(){i.callbacks&&!d.data("mCS_tweenRunning")&&s("onScrollStart"),d.data("autoHideScrollbar")&&!d.data("alwaysShowScrollbar")&&n.showScrollbar.call(f)},onUpdate:function(){i.callbacks&&s("whileScrolling")},onComplete:function(){i.callbacks&&(s("onScroll"),(r||a&&p.position().left>=a)&&s("onTotalScrollBack"),(l||c&&p.position().left<=c)&&s("onTotalScroll")),m.data("preventAction",!1),d.data("mCS_tweenRunning",!1),d.data("autoHideScrollbar")&&!d.data("alwaysShowScrollbar")&&(h.hasClass("mCS-mouse-over")||n.hideScrollbar.call(f))}})}else{d.data("onTotalScrollBack_Offset")&&(a=-d.data("onTotalScrollBack_Offset")),d.data("onTotalScroll_Offset")&&(c=h.height()-p.outerHeight()+d.data("onTotalScroll_Offset")),0>o?(o=t=0,clearInterval(d.data("mCSB_buttonScrollUp")),a||(r=!0)):o>=v.height()-m.height()?(o=v.height()-m.height(),t=h.height()-p.outerHeight(),clearInterval(d.data("mCSB_buttonScrollDown")),c||(l=!0)):t=-t;var y=d.data("snapAmount");y&&(t=Math.round(t/y)*y-d.data("snapOffset")),n.mTweenAxis.call(this,m[0],"top",Math.round(o),draggerSpeed,i.scrollEasing),n.mTweenAxis.call(this,p[0],"top",Math.round(t),g,i.scrollEasing,{onStart:function(){i.callbacks&&!d.data("mCS_tweenRunning")&&s("onScrollStart"),d.data("autoHideScrollbar")&&!d.data("alwaysShowScrollbar")&&n.showScrollbar.call(f)},onUpdate:function(){i.callbacks&&s("whileScrolling")},onComplete:function(){i.callbacks&&(s("onScroll"),(r||a&&p.position().top>=a)&&s("onTotalScrollBack"),(l||c&&p.position().top<=c)&&s("onTotalScroll")),m.data("preventAction",!1),d.data("mCS_tweenRunning",!1),d.data("autoHideScrollbar")&&!d.data("alwaysShowScrollbar")&&(h.hasClass("mCS-mouse-over")||n.hideScrollbar.call(f))}})}d.data("mCS_Init")&&d.data({mCS_Init:!1})}},stop:function(){var t=e(this),i=t.children().children(".mCSB_container"),s=t.children().children().children().children(".mCSB_dragger");n.mTweenAxisStop.call(this,i[0]),n.mTweenAxisStop.call(this,s[0])},disable:function(t){var n=e(this),i=n.children(".mCustomScrollBox"),s=i.children(".mCSB_container"),o=i.children(".mCSB_scrollTools"),r=o.children().children(".mCSB_dragger");i.unbind("mousewheel focusin mouseenter mouseleave touchend"),s.unbind("touchstart touchmove"),t&&(n.data("horizontalScroll")?r.add(s).css("left",0):r.add(s).css("top",0)),o.css("display","none"),s.addClass("mCS_no_scrollbar"),n.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var t=e(this);t.removeClass("mCustomScrollbar _mCS_"+t.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),e(document).unbind("mousemove."+t.data("mCustomScrollbarIndex")+" mouseup."+t.data("mCustomScrollbarIndex")+" MSPointerMove."+t.data("mCustomScrollbarIndex")+" MSPointerUp."+t.data("mCustomScrollbarIndex")),e(window).unbind("resize."+t.data("mCustomScrollbarIndex"))}},n={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(e,t,n,i,s,o){function r(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()}function a(){g||p.call(),g=r()-m,l(),g>=e._time&&(e._time=g>e._time?g+h-(g-e._time):g+h-1,e._time<g+1&&(e._time=g+1)),e._time<i?e._id=_request(a):v.call()}function l(){i>0?(e.currVal=u(e._time,b,w,i,s),y[t]=Math.round(e.currVal)+"px"):y[t]=n+"px",f.call()}function c(){h=1e3/60,e._time=g+h,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return l(),setTimeout(e,.01)},e._id=_request(a)}function d(){null!=e._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._id):clearTimeout(e._id),e._id=null)}function u(e,t,n,i,s){switch(s){case"linear":return n*e/i+t;case"easeOutQuad":return e/=i,-n*e*(e-2)+t;case"easeInOutQuad":return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t);case"easeOutCubic":return e/=i,e--,n*(e*e*e+1)+t;case"easeOutQuart":return e/=i,e--,-n*(e*e*e*e-1)+t;case"easeOutQuint":return e/=i,e--,n*(e*e*e*e*e+1)+t;case"easeOutCirc":return e/=i,e--,n*Math.sqrt(1-e*e)+t;case"easeOutSine":return n*Math.sin(e/i*(Math.PI/2))+t;case"easeOutExpo":return n*(-Math.pow(2,-10*e/i)+1)+t;case"mcsEaseOut":var o=(e/=i)*e,r=o*e;return t+n*(.499999999999997*r*o+-2.5*o*o+5.5*r+-6.5*o+4*e);case"draggerRailEase":return e/=i/2,1>e?n/2*e*e*e+t:(e-=2,n/2*(e*e*e+2)+t)}}var h,o=o||{},p=o.onStart||function(){},f=o.onUpdate||function(){},v=o.onComplete||function(){},m=r(),g=0,b=e.offsetTop,y=e.style;"left"===t&&(b=e.offsetLeft);var w=n-b;d(),c()},mTweenAxisStop:function(e){null!=e._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._id):clearTimeout(e._id),e._id=null)},rafPolyfill:function(){for(var e=["ms","moz","webkit","o"],t=e.length;--t>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"]}};n.rafPolyfill.call(),e.support.touch=!!("ontouchstart"in window),e.support.pointer=window.navigator.pointerEnabled,e.support.msPointer=window.navigator.msPointerEnabled;var i="https:"==document.location.protocol?"https:":"http:";e.event.special.mousewheel||document.write('<script src="'+i+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"></script>'),e.fn.mCustomScrollbar=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist"):t.init.apply(this,arguments)}}(jQuery),define("jq.mCustomScrollbar",["jQuery","jq.mousewheel"],function(e){return function(){var t;return t||e.$.fn.mCustomScrollbar}}(this)),define("bb.text",["module"],function(e){var t,n,i,s,o,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),u=c&&location.hostname,h=c&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,i,s=!1,o=e.indexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!r||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(s="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,s){var o,r,a,l=t.xdRegExp.exec(e);return l?(o=l[2],r=l[3],r=r.split(":"),a=r[1],r=r[0],!(o&&o!==n||r&&r.toLowerCase()!==i.toLowerCase()||(a||r)&&a!==s)):!0},finishLoad:function(e,n,i,s){i=n?t.strip(i):i,f.isBuild&&(p[e]=i),s(i)},load:function(e,n,i,s){if(s.isBuild&&!s.inlineText)return void i();f.isBuild=s.isBuild;var o=t.parseName(e),r=o.moduleName+(o.ext?"."+o.ext:""),a=n.toUrl(r),l=f.useXhr||t.useXhr;return 0===a.indexOf("empty:")?void i():void(!c||l(a,d,u,h)?t.get(a,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([r],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)}))},write:function(e,n,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,i,s,o){var r=t.parseName(n),a=r.ext?"."+r.ext:"",l=r.moduleName+a,c=i.toUrl(r.moduleName+a)+".js";t.load(l,i,function(){var n=function(e){return s(c,e)};n.asModule=function(e,t){return s.asModule(e,c,t)},t.write(e,l,n,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var s=n.readFileSync(e,"utf8");0===s.indexOf("﻿")&&(s=s.substring(1)),t(s)}catch(o){i(o)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,s){var o,r=t.createXhr();if(r.open("GET",e,!0),s)for(o in s)s.hasOwnProperty(o)&&r.setRequestHeader(o.toLowerCase(),s[o]);f.onXhr&&f.onXhr(r,e),r.onreadystatechange=function(){var t,s;4===r.readyState&&(t=r.status,t>399&&600>t?(s=new Error(e+" HTTP status: "+t),s.xhr=r,i(s)):n(r.responseText),f.onXhrComplete&&f.onXhrComplete(r,e))},r.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,s="utf-8",o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),s)),l="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(r),n.append(i);l=String(n.toString())}finally{a.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,r,a,l={};o&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),n.init(a,1,0,!1),r=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),r.init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(n.available(),l),r.close(),n.close(),t(l.value)}catch(c){throw new Error((a&&a.path||"")+": "+c)}}),t}),define("bb.text!app/../../resources/tpl/fontlist/FontSet.html",[],function(){return'<div class="pangrammeCrop">\n    {% if css %}\n    <div class="pangramme" {% if fontFace %} style="font-family:\'{{fontFace}}\',\'Arial\';" {% endif %} >{{pangramme|safe}}</div>\n    {% else %}\n        <img class="pangramme" />\n    {% endif %}\n</div>\n<div class="gradient"></div>\n\n<div class="hr"><div></div></div>\n\n<div class="topLine">\n    <span class="fullName">{{fullName}}</span>\n        {{licences.length}}\n\n        {% if price %}\n            <span class="match">{{match}}&nbsp;\n                {{ match|decline ("начертаний", "начертание", "начертания") }}\n                &nbsp;из&nbsp;{{subSets.length}}\n            </span>\n        {% endif %}\n        {% if price %}<span class="price">от&nbsp;{{price}}&nbsp;&#x20B7;</span>{% endif %}\n</div>\n{% if price %}\n<div class="buttonLine">\n    <div class="toFavorites icon-in_favorites {% if isFavorite %} selected {% endif %}"></div>\n    <div class="toTypeTester icon-in_typetester {% if isInTypeTester %} selected {% endif %}"></div>\n    <!--div class="toBucket {% if isInBucket %} selected {% endif %}"><span class="icon-in_cart"></span>{{price}}&nbsp;<span class=\'rouble\'>P</span></div-->\n\n    {% if isInBucket %}\n        <div class="toBucket selected"><span class="icon-check_big"></span>В&nbsp;корзине</div>\n    {% else %}\n        <div class="toBucket"><span class="icon-in_cart"></span>{{price}}&nbsp;&#x20B7;</div>\n    {% endif %}\n</div>\n{% else %}\n<div class="buttonLine">\n    <div class="toFavorites icon-in_favorites {% if isFavorite %} selected {% endif %}"></div>\n    <div class="toTypeTester icon-in_typetester {% if isInTypeTester %} selected {% endif %}"></div>\n</div>\n{% endif %}\n\n'}),define("app/views/fontlist/FontSetView",["app/models/AppModel","backbone","app/events/FaceModeEvent","app/events/DisplayModeEvent","bb.text!app/../../resources/tpl/fontlist/FontSet.html"],function(e,t,n,i,s){function o(e){$("head link#list_"+e.split(" ").join("_")).remove()}function r(e,t,n){t=t?t:"none";var i=$("head link#"+t);0===i.length&&$("head").append(["<link id='list_",t.split(" ").join("_"),"' type='text/css' rel='stylesheet' href='",n,"' />"].join(""))}function a(t){return e.getImageURL({mode:t._displayMode,color:t._nightMode?16777215:0,backgroundColor:t._nightMode?0:16777215,size:t._modeSize})}function l(t){return t._displayMode===i.MODE_PARAGRAPHS?t.model.get("sampleTextParagraph")?{type:"paragraph",text:t.model.get("sampleTextParagraph")}:e.getPangramme("paragraph"):t._displayMode===i.MODE_LETTERS?t.model.get("sampleTextLine")?{type:"letter",text:t.model.get("sampleTextLine").substr(0,2)}:e.getPangramme("letter"):t.model.get("sampleTextLine")?{type:"line",text:t.model.get("sampleTextLine")}:e.getPangramme("line")}function c(e,t){e.model.get("css")?e.$(".pangramme").html(t):e.$(".pangramme").attr("src",a(e))}function d(e){e.$el.removeClass("mode_sets mode_fonts mode_night mode_day mode_paragraphs mode_letters mode_lines "),e.$el.addClass(e._nightMode?"mode_night":"mode_day"),e.$el.addClass(e._displayMode===i.MODE_PARAGRAPHS?"mode_paragraphs":e._displayMode===i.MODE_LETTERS?"mode_letters":"mode_lines"),e.$el.addClass(e._faceMode===n.MODE_SETS?"mode_sets":"mode_fonts")}var u=t.View.extend({tagName:"div",className:"FontSetView",_template:s,_pangrammes:{},_nightMode:!1,_displayMode:i.MODE_LINES,_faceMode:n.MODE_SETS,_size:16,events:{"click .toTypeTester":"toTypeTester","click .toFavorites":"toFavorites","click .toBucket":"toBucket",click:"toPanel"},initialize:function(){_.bindAll(this,"render","setNightMode","setDisplayMode","setSizeMode","setPangrammeMode","setPosition","setWidth","setHeight","getPreferableWidth","getPreferableHeight","toTypeTester","toPanel"),this.listenTo(this.model,"change",this.render),this.listenTo(t,"NightModeEvent",this.setNightMode,this),this.listenTo(t,"DisplayModeEvent",this.setDisplayMode,this),this.listenTo(t,"SizeModeEvent",this.setSizeMode,this),this.listenTo(t,"PangrammeModeEvent",this.setPangrammeMode,this),this.listenTo(t,"FaceModeEvent",this.setFaceMode,this),this._size=e.getSizeMode(),this._nightMode=e.getNightMode(),this._faceMode=e.getFaceMode(),this._displayMode=e.getDisplayMode(),this.render(),this.setSizeMode(this._size),this.listenTo(this.model,"change",this.render)},remove:function(){o(this.model.get("fontFace")),t.View.prototype.remove.call(this)},render:function(){this.$el.attr("id",this.cid);var t=l(this);return this.$el.html(e.nunjucks.renderString(this._template,_.extend({pangramme:t?t.text:""},this.model.attributes))),this.model.get("css")&&r(this.$el,this.model.get("fontFace"),this.model.get("css")),d(this),this.setSizeMode(this._size),this._height&&this.setHeight(this._height),this},setNightMode:function(e){this._nightMode=e,this.$el.removeClass("mode_night mode_day"),this.$el.addClass(e?"mode_night":"mode_day"),this.setPangrammeMode(l(this))},setDisplayMode:function(e){this._displayMode=e,this.$el.removeClass("mode_paragraphs mode_letters mode_lines"),this.$el.addClass(e===i.MODE_PARAGRAPHS?"mode_paragraphs":e===i.MODE_LETTERS?"mode_letters":"mode_lines"),this.setPangrammeMode(l(this))},setSizeMode:function(e){this._size=e,e=Math.floor(e),this.$(".pangramme").css({"font-size":String(e)+"px"}),this.setHeight()},setPangrammeMode:function(e){e=e?e:"",this._displayMode===i.MODE_PARAGRAPHS&&"paragraph"===e.type?this.model.get("sampleTextParagraph")?c(this,l(this).text):c(this,e.text):this._displayMode===i.MODE_LETTERS&&"letter"===e.type?this.model.get("sampleTextLine")?c(this,l(this).text):c(this,e.text):this.model.get("sampleTextLine")?c(this,l(this).text):c(this,e.text)},setFaceMode:function(e){this.$el.removeClass("mode_sets mode_fonts"),this.$el.addClass(e===n.MODE_SETS?"mode_sets":"mode_fonts"),this.setPangrammeMode(l(this))},setPosition:function(e,t){this.$el.css(_.isUndefined(e)||_.isUndefined(t)?{position:"relative",left:0,top:0}:{position:"absolute",left:Math.floor(e),top:Math.floor(t)})},setWidth:function(e){this.$el.css({width:_.isUndefined(e)?"100%":String(Math.floor(e))+"px"})},getPreferableWidth:function(){return this.$el.width()},setHeight:function(e){this._height=Math.floor(_.isUndefined(e)?68+1.05*this._size:e),this.$el.css("height",this._height)},getPreferableHeight:function(){return this._displayMode===i.MODE_PARAGRAPHS?this.$(".pangramme").position().top+this.$(".pangramme").height()+50:this._displayMode===i.MODE_LETTERS?190:void this.setPangrammeMode(l(this))},toTypeTester:function(){return e.isInterfaceLocked()?void 0:(this.model.set("isInTypeTester",!this.model.get("isInTypeTester")),!1)},toFavorites:function(n){return e.isInterfaceLocked()?void 0:(t.trigger("open:favoritesMenu",this.model,{x:n.pageX,y:n.pageY}),!1)},toBucket:function(){return e.isInterfaceLocked()?void 0:(t.trigger("open:cartPopup",this.model),!1)},toPanel:function(){return e.isInterfaceLocked()?void 0:(t.trigger("open:fontstyle",this.model),!1)}});return u}),define("app/views/fontlist/FontSetListView",["app/models/AppModel","backbone","bb.InfiniScroll","jq.mCustomScrollbar","app/views/fontlist/FontSetView","app/models/FontSetModel","app/events/DisplayModeEvent"],function(e,t,n,i,s,o,r){function a(e){function t(){_.each(e._views,function(e){e.setPosition(),e.setWidth(),e.setHeight()})}function n(){var t=420,n=630,i=20,o=20,r=e.$el.width()-2*i-s/2,a=Math.floor(r/(t+s)),l=Math.min(n,Math.floor(r/a-s));_.each(e._views,function(e){e.setWidth(l)});var c=322,d=0,u=i,h=-c+o-s/2;_.each(e._views,function(e){d%a===0&&(u=i,h+=c+s),e.setPosition(u,h),e.setHeight(c),u+=l+s,++d})}function i(){var t=156,n=188,i=20,o=20,r=e._views[0].getPreferableHeight(),a=e.$el.width()-2*i-s/2,l=Math.floor(a/(t+s)),c=Math.min(n,Math.floor(a/l-s)),d=0,u=i,h=-r+o-s/2;_.each(e._views,function(e){d%l===0&&(u=i,h+=r+s),e.setPosition(u,h),e.setWidth(c),e.setHeight(r),u+=c+s,++d})}var s=6;this.onLayout=function(o){e._displayMode===r.MODE_PARAGRAPHS?n(o):e._displayMode===r.MODE_LETTERS?i(o):t(o);var a=e._views[e._views.length-1].$el;e.$el.height(a.position().top+a.height()+2*s),e.$el.closest(".mCustomScrollbar").mCustomScrollbar("update")}}var l=t.View.extend({tagName:"div",className:"FontSetListView",_views:[],_nightMode:!1,_displayMode:r.MODE_LINES,_layoutManager:null,initialize:function(){_.bindAll(this,"render","setNightMode","appendRender","makeScrollable"),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"reset",this.reset),this.listenTo(t,"NightModeEvent",this.setNightMode,this),this.listenTo(t,"DisplayModeEvent",this.setDisplayMode,this),this._displayMode=e.getDisplayMode(),this.render(),this._layoutManager=new a(this),$(window).on("resize",this._layoutManager.onLayout),t.on("invalidate",this._layoutManager.onLayout)},render:function(){return this.$el.attr("id",this.cid),this.$el.empty(),this.populate(),this.setNightMode(this._nightMode),this},populate:function(){_.each(this._views,function(e){e.remove()}),this._views=[];var e=document.createDocumentFragment();this.collection.each(function(t){var n=new s({model:t});e.appendChild(n.el),this._views.push(n)},this),this.$el.append(e)},makeScrollable:function(){this.infiniScroll=new t.InfiniScroll(this.collection,{success:this.appendRender,error:this.appendRender}),this.$el.parent().mCustomScrollbar({theme:"dark",callbacks:{onTotalScroll:this.infiniScroll.fetch}})},reset:function(){this.populate(),this._layoutManager.onLayout()},appendRender:function(e,t){var n=document.createDocumentFragment();_.each(_.pluck(t.fonts,"id"),function(t){var i=new s({model:e.findWhere({id:t})});n.appendChild(i.el),this._views.push(i)},this),this.$el.append(n),this._layoutManager.onLayout()},remove:function(){$(window).off("resize",this._layoutManager.onLayout),this.infiniScroll.destroy(),t.View.prototype.remove.call(this)},setNightMode:function(e){this._nightMode=e,this.$el.removeClass("mode_night mode_day"),this.$el.addClass(e?"mode_night":"mode_day")},setDisplayMode:function(e){this._displayMode=e,this.$el.removeClass("mode_paragraphs mode_letters mode_lines"),this.$el.addClass(e===r.MODE_PARAGRAPHS?"mode_paragraphs":e===r.MODE_LETTERS?"mode_letters":"mode_lines"),setTimeout(this._layoutManager.onLayout,10)}});return l}),define("bb.text!app/../../resources/tpl/switchers/SwitchersPanel.html",[],function(){return'<div class="tr">\n    <div class="left-td">\n        <div id="SwitcherDisplayView"></div>\n        <div id="SwitcherFaceView"></div>\n    </div>\n    <div class="mid-td">\n        <div id="SwitcherPangrammeView"></div>\n        <div id="SwitcherTextView"></div>\n    </div>\n    <div class="right-td">\n        <div id="SwitcherSizeView"></div>\n        <div id="SwitcherNightView"></div>\n    </div>\n</div>\n'}),define("bb.text!app/../../resources/tpl/switchers/SwitcherFace.html",[],function(){return'<div class="highlighter"></div>\n<div class="button sets">Гарнитуры</div>\n<div class="button fonts">Начертания</div>\n'}),function(e){var t=e.GreenSockGlobals||e;if(!t.TweenLite){var n,i,s,o,r,a=function(e){var n,i=e.split("."),s=t;for(n=0;i.length>n;n++)s[i[n]]=s=s[i[n]]||{};return s},l=a("com.greensock"),c=1e-10,d=[].slice,u=function(){},h=function(){var e=Object.prototype.toString,t=e.call([]);return function(n){return null!=n&&(n instanceof Array||"object"==typeof n&&!!n.push&&e.call(n)===t)}}(),p={},f=function(n,i,s,o){this.sc=p[n]?p[n].sc:[],p[n]=this,this.gsClass=null,this.func=s;var r=[];this.check=function(l){for(var c,d,u,h,v=i.length,m=v;--v>-1;)(c=p[i[v]]||new f(i[v],[])).gsClass?(r[v]=c.gsClass,m--):l&&c.sc.push(this);if(0===m&&s)for(d=("com.greensock."+n).split("."),u=d.pop(),h=a(d.join("."))[u]=this.gsClass=s.apply(s,r),o&&(t[u]=h,"function"==typeof define&&define.amd?define((e.GreenSockAMDPath?e.GreenSockAMDPath+"/":"")+n.split(".").join("/"),[],function(){return h}):"undefined"!=typeof module&&module.exports&&(module.exports=h)),v=0;this.sc.length>v;v++)this.sc[v].check()},this.check(!0)},v=e._gsDefine=function(e,t,n,i){return new f(e,t,n,i)},m=l._class=function(e,t,n){return t=t||function(){},v(e,[],function(){return t},n),t};v.globals=t;var g=[0,0,1,1],b=[],y=m("easing.Ease",function(e,t,n,i){this._func=e,this._type=n||0,this._power=i||0,this._params=t?g.concat(t):g},!0),w=y.map={},_=y.register=function(e,t,n,i){for(var s,o,r,a,c=t.split(","),d=c.length,u=(n||"easeIn,easeOut,easeInOut").split(",");--d>-1;)for(o=c[d],s=i?m("easing."+o,null,!0):l.easing[o]||{},r=u.length;--r>-1;)a=u[r],w[o+"."+a]=w[a+o]=s[a]=e.getRatio?e:e[a]||new e};for(s=y.prototype,s._calcEnd=!1,s.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var t=this._type,n=this._power,i=1===t?1-e:2===t?e:.5>e?2*e:2*(1-e);return 1===n?i*=i:2===n?i*=i*i:3===n?i*=i*i*i:4===n&&(i*=i*i*i*i),1===t?1-i:2===t?i:.5>e?i/2:1-i/2},n=["Linear","Quad","Cubic","Quart","Quint,Strong"],i=n.length;--i>-1;)s=n[i]+",Power"+i,_(new y(null,null,1,i),s,"easeOut",!0),_(new y(null,null,2,i),s,"easeIn"+(0===i?",easeNone":"")),_(new y(null,null,3,i),s,"easeInOut");w.linear=l.easing.Linear.easeIn,w.swing=l.easing.Quad.easeInOut;var x=m("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});s=x.prototype,s.addEventListener=function(e,t,n,i,s){s=s||0;var a,l,c=this._listeners[e],d=0;for(null==c&&(this._listeners[e]=c=[]),l=c.length;--l>-1;)a=c[l],a.c===t&&a.s===n?c.splice(l,1):0===d&&s>a.pr&&(d=l+1);c.splice(d,0,{c:t,s:n,up:i,pr:s}),this!==o||r||o.wake()},s.removeEventListener=function(e,t){var n,i=this._listeners[e];if(i)for(n=i.length;--n>-1;)if(i[n].c===t)return void i.splice(n,1)},s.dispatchEvent=function(e){var t,n,i,s=this._listeners[e];if(s)for(t=s.length,n=this._eventTarget;--t>-1;)i=s[t],i.up?i.c.call(i.s||n,{type:e,target:n}):i.c.call(i.s||n)};var k=e.requestAnimationFrame,S=e.cancelAnimationFrame,C=Date.now||function(){return(new Date).getTime()},T=C();for(n=["ms","moz","webkit","o"],i=n.length;--i>-1&&!k;)k=e[n[i]+"RequestAnimationFrame"],S=e[n[i]+"CancelAnimationFrame"]||e[n[i]+"CancelRequestAnimationFrame"];m("Ticker",function(e,t){var n,i,s,a,l,c=this,d=C(),h=t!==!1&&k,p=function(e){T=C(),c.time=(T-d)/1e3;var t,o=c.time-l;(!n||o>0||e===!0)&&(c.frame++,l+=o+(o>=a?.004:a-o),t=!0),e!==!0&&(s=i(p)),t&&c.dispatchEvent("tick")};x.call(c),c.time=c.frame=0,c.tick=function(){p(!0)},c.sleep=function(){null!=s&&(h&&S?S(s):clearTimeout(s),i=u,s=null,c===o&&(r=!1))},c.wake=function(){null!==s&&c.sleep(),i=0===n?u:h&&k?k:function(e){return setTimeout(e,0|1e3*(l-c.time)+1)},c===o&&(r=!0),p(2)},c.fps=function(e){return arguments.length?(n=e,a=1/(n||60),l=this.time+a,void c.wake()):n},c.useRAF=function(e){return arguments.length?(c.sleep(),h=e,void c.fps(n)):h},c.fps(e),setTimeout(function(){h&&(!s||5>c.frame)&&c.useRAF(!1)},1500)}),s=l.Ticker.prototype=new l.events.EventDispatcher,s.constructor=l.Ticker;var E=m("core.Animation",function(e,t){if(this.vars=t=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(t.delay)||0,this._timeScale=1,this._active=t.immediateRender===!0,this.data=t.data,this._reversed=t.reversed===!0,R){r||o.wake();var n=this.vars.useFrames?I:R;n.add(this,n._time),this.vars.paused&&this.paused(!0)}});o=E.ticker=new l.Ticker,s=E.prototype,s._dirty=s._gc=s._initted=s._paused=!1,s._totalTime=s._time=0,s._rawPrevTime=-1,s._next=s._last=s._onUpdate=s._timeline=s.timeline=null,s._paused=!1;var A=function(){r&&C()-T>2e3&&o.wake(),setTimeout(A,2e3)};A(),s.play=function(e,t){return arguments.length&&this.seek(e,t),this.reversed(!1).paused(!1)},s.pause=function(e,t){return arguments.length&&this.seek(e,t),this.paused(!0)},s.resume=function(e,t){return arguments.length&&this.seek(e,t),this.paused(!1)},s.seek=function(e,t){return this.totalTime(Number(e),t!==!1)},s.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,t!==!1,!0)},s.reverse=function(e,t){return arguments.length&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},s.render=function(){},s.invalidate=function(){return this},s.isActive=function(){var e,t=this._timeline,n=this._startTime;return!t||!this._gc&&!this._paused&&t.isActive()&&(e=t.rawTime())>=n&&n+this.totalDuration()/this._timeScale>e},s._enabled=function(e,t){return r||o.wake(),this._gc=!e,this._active=this.isActive(),t!==!0&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},s._kill=function(){return this._enabled(!1,!1)},s.kill=function(e,t){return this._kill(e,t),this},s._uncache=function(e){for(var t=e?this:this.timeline;t;)t._dirty=!0,t=t.timeline;
return this},s._swapSelfInParams=function(e){for(var t=e.length,n=e.concat();--t>-1;)"{self}"===e[t]&&(n[t]=this);return n},s.eventCallback=function(e,t,n,i){if("on"===(e||"").substr(0,2)){var s=this.vars;if(1===arguments.length)return s[e];null==t?delete s[e]:(s[e]=t,s[e+"Params"]=h(n)&&-1!==n.join("").indexOf("{self}")?this._swapSelfInParams(n):n,s[e+"Scope"]=i),"onUpdate"===e&&(this._onUpdate=t)}return this},s.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},s.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},s.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},s.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},s.totalTime=function(e,t,n){if(r||o.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>e&&!n&&(e+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var i=this._totalDuration,s=this._timeline;if(e>i&&!n&&(e=i),this._startTime=(this._paused?this._pauseTime:s._time)-(this._reversed?i-e:e)/this._timeScale,s._dirty||this._uncache(!1),s._timeline)for(;s._timeline;)s._timeline._time!==(s._startTime+s._totalTime)/s._timeScale&&s.totalTime(s._totalTime,!0),s=s._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==e||0===this._duration)&&this.render(e,t,!1)}return this},s.progress=s.totalProgress=function(e,t){return arguments.length?this.totalTime(this.duration()*e,t):this._time/this.duration()},s.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},s.timeScale=function(e){if(!arguments.length)return this._timeScale;if(e=e||c,this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,n=t||0===t?t:this._timeline.totalTime();this._startTime=n-(n-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},s.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},s.paused=function(e){if(!arguments.length)return this._paused;if(e!=this._paused&&this._timeline){r||e||o.wake();var t=this._timeline,n=t.rawTime(),i=n-this._pauseTime;!e&&t.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=e?n:null,this._paused=e,this._active=this.isActive(),!e&&0!==i&&this._initted&&this.duration()&&this.render(t.smoothChildTiming?this._totalTime:(n-this._startTime)/this._timeScale,!0,!0)}return this._gc&&!e&&this._enabled(!0,!1),this};var F=m("core.SimpleTimeline",function(e){E.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});s=F.prototype=new E,s.constructor=F,s.kill()._gc=!1,s._first=s._last=null,s._sortChildren=!1,s.add=s.insert=function(e,t){var n,i;if(e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),n=this._last,this._sortChildren)for(i=e._startTime;n&&n._startTime>i;)n=n._prev;return n?(e._next=n._next,n._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=n,this._timeline&&this._uncache(!0),this},s._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e.timeline=null,e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),this._timeline&&this._uncache(!0)),this},s.render=function(e,t,n){var i,s=this._first;for(this._totalTime=this._time=this._rawPrevTime=e;s;)i=s._next,(s._active||e>=s._startTime&&!s._paused)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(e-s._startTime)*s._timeScale,t,n):s.render((e-s._startTime)*s._timeScale,t,n)),s=i},s.rawTime=function(){return r||o.wake(),this._totalTime};var N=m("TweenLite",function(t,n,i){if(E.call(this,n,i),this.render=N.prototype.render,null==t)throw"Cannot tween a null target.";this.target=t="string"!=typeof t?t:N.selector(t)||t;var s,o,r,a=t.jquery||t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?j[N.defaultOverwrite]:"number"==typeof l?l>>0:j[l],(a||t instanceof Array||t.push&&h(t))&&"number"!=typeof t[0])for(this._targets=r=d.call(t,0),this._propLookup=[],this._siblings=[],s=0;r.length>s;s++)o=r[s],o?"string"!=typeof o?o.length&&o!==e&&o[0]&&(o[0]===e||o[0].nodeType&&o[0].style&&!o.nodeType)?(r.splice(s--,1),this._targets=r=r.concat(d.call(o,0))):(this._siblings[s]=V(o,this,!1),1===l&&this._siblings[s].length>1&&z(o,this,null,1,this._siblings[s])):(o=r[s--]=N.selector(o),"string"==typeof o&&r.splice(s+1,1)):r.splice(s--,1);else this._propLookup={},this._siblings=V(t,this,!1),1===l&&this._siblings.length>1&&z(t,this,null,1,this._siblings);(this.vars.immediateRender||0===n&&0===this._delay&&this.vars.immediateRender!==!1)&&this.render(-this._delay,!1,!0)},!0),M=function(t){return t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType)},$=function(e,t){var n,i={};for(n in e)D[n]||n in t&&"x"!==n&&"y"!==n&&"width"!==n&&"height"!==n&&"className"!==n&&"border"!==n||!(!L[n]||L[n]&&L[n]._autoCSS)||(i[n]=e[n],delete e[n]);e.css=i};s=N.prototype=new E,s.constructor=N,s.kill()._gc=!1,s.ratio=0,s._firstPT=s._targets=s._overwrittenProps=s._startAt=null,s._notifyPluginsOfEnabled=!1,N.version="1.11.4",N.defaultEase=s._ease=new y(null,null,1,1),N.defaultOverwrite="auto",N.ticker=o,N.autoSleep=!0,N.selector=e.$||e.jQuery||function(t){return e.$?(N.selector=e.$,e.$(t)):e.document?e.document.getElementById("#"===t.charAt(0)?t.substr(1):t):t};var P=N._internals={isArray:h,isSelector:M},L=N._plugins={},O=N._tweenLookup={},B=0,D=P.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1},j={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},I=E._rootFramesTimeline=new F,R=E._rootTimeline=new F;R._startTime=o.time,I._startTime=o.frame,R._active=I._active=!0,E._updateRoot=function(){if(R.render((o.time-R._startTime)*R._timeScale,!1,!1),I.render((o.frame-I._startTime)*I._timeScale,!1,!1),!(o.frame%120)){var e,t,n;for(n in O){for(t=O[n].tweens,e=t.length;--e>-1;)t[e]._gc&&t.splice(e,1);0===t.length&&delete O[n]}if(n=R._first,(!n||n._paused)&&N.autoSleep&&!I._first&&1===o._listeners.tick.length){for(;n&&n._paused;)n=n._next;n||o.sleep()}}},o.addEventListener("tick",E._updateRoot);var V=function(e,t,n){var i,s,o=e._gsTweenID;if(O[o||(e._gsTweenID=o="t"+B++)]||(O[o]={target:e,tweens:[]}),t&&(i=O[o].tweens,i[s=i.length]=t,n))for(;--s>-1;)i[s]===t&&i.splice(s,1);return O[o].tweens},z=function(e,t,n,i,s){var o,r,a,l;if(1===i||i>=4){for(l=s.length,o=0;l>o;o++)if((a=s[o])!==t)a._gc||a._enabled(!1,!1)&&(r=!0);else if(5===i)break;return r}var d,u=t._startTime+c,h=[],p=0,f=0===t._duration;for(o=s.length;--o>-1;)(a=s[o])===t||a._gc||a._paused||(a._timeline!==t._timeline?(d=d||H(t,0,f),0===H(a,d,f)&&(h[p++]=a)):u>=a._startTime&&a._startTime+a.totalDuration()/a._timeScale>u&&((f||!a._initted)&&2e-10>=u-a._startTime||(h[p++]=a)));for(o=p;--o>-1;)a=h[o],2===i&&a._kill(n,e)&&(r=!0),(2!==i||!a._firstPT&&a._initted)&&a._enabled(!1,!1)&&(r=!0);return r},H=function(e,t,n){for(var i=e._timeline,s=i._timeScale,o=e._startTime;i._timeline;){if(o+=i._startTime,s*=i._timeScale,i._paused)return-100;i=i._timeline}return o/=s,o>t?o-t:n&&o===t||!e._initted&&2*c>o-t?c:(o+=e.totalDuration()/e._timeScale/s)>t+c?0:o-t-c};s._init=function(){var e,t,n,i,s=this.vars,o=this._overwrittenProps,r=this._duration,a=s.immediateRender,l=s.ease;if(s.startAt){if(this._startAt&&this._startAt.render(-1,!0),s.startAt.overwrite=0,s.startAt.immediateRender=!0,this._startAt=N.to(this.target,0,s.startAt),a)if(this._time>0)this._startAt=null;else if(0!==r)return}else if(s.runBackwards&&0!==r)if(this._startAt)this._startAt.render(-1,!0),this._startAt=null;else{n={};for(i in s)D[i]&&"autoCSS"!==i||(n[i]=s[i]);if(n.overwrite=0,n.data="isFromStart",this._startAt=N.to(this.target,0,n),s.immediateRender){if(0===this._time)return}else this._startAt.render(-1,!0)}if(this._ease=l?l instanceof y?s.easeParams instanceof Array?l.config.apply(l,s.easeParams):l:"function"==typeof l?new y(l,s.easeParams):w[l]||N.defaultEase:N.defaultEase,this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(e=this._targets.length;--e>-1;)this._initProps(this._targets[e],this._propLookup[e]={},this._siblings[e],o?o[e]:null)&&(t=!0);else t=this._initProps(this.target,this._propLookup,this._siblings,o);if(t&&N._onPluginEvent("_onInitAllProps",this),o&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),s.runBackwards)for(n=this._firstPT;n;)n.s+=n.c,n.c=-n.c,n=n._next;this._onUpdate=s.onUpdate,this._initted=!0},s._initProps=function(t,n,i,s){var o,r,a,l,c,d;if(null==t)return!1;this.vars.css||t.style&&t!==e&&t.nodeType&&L.css&&this.vars.autoCSS!==!1&&$(this.vars,t);for(o in this.vars){if(d=this.vars[o],D[o])d&&(d instanceof Array||d.push&&h(d))&&-1!==d.join("").indexOf("{self}")&&(this.vars[o]=d=this._swapSelfInParams(d,this));else if(L[o]&&(l=new L[o])._onInitTween(t,this.vars[o],this)){for(this._firstPT=c={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:!0,n:o,pg:!0,pr:l._priority},r=l._overwriteProps.length;--r>-1;)n[l._overwriteProps[r]]=this._firstPT;(l._priority||l._onInitAllProps)&&(a=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=n[o]=c={_next:this._firstPT,t:t,p:o,f:"function"==typeof t[o],n:o,pg:!1,pr:0},c.s=c.f?t[o.indexOf("set")||"function"!=typeof t["get"+o.substr(3)]?o:"get"+o.substr(3)]():parseFloat(t[o]),c.c="string"==typeof d&&"="===d.charAt(1)?parseInt(d.charAt(0)+"1",10)*Number(d.substr(2)):Number(d)-c.s||0;c&&c._next&&(c._next._prev=c)}return s&&this._kill(s,t)?this._initProps(t,n,i,s):this._overwrite>1&&this._firstPT&&i.length>1&&z(t,this,n,this._overwrite,i)?(this._kill(n,t),this._initProps(t,n,i,s)):a},s.render=function(e,t,n){var i,s,o,r,a=this._time,l=this._duration;if(e>=l)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(i=!0,s="onComplete"),0===l&&(r=this._rawPrevTime,(0===e||0>r||r===c)&&r!==e&&(n=!0,r>c&&(s="onReverseComplete")),this._rawPrevTime=r=!t||e||0===r?e:c);else if(1e-7>e)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==a||0===l&&this._rawPrevTime>c)&&(s="onReverseComplete",i=this._reversed),0>e?(this._active=!1,0===l&&(this._rawPrevTime>=0&&(n=!0),this._rawPrevTime=r=!t||e||0===this._rawPrevTime?e:c)):this._initted||(n=!0);else if(this._totalTime=this._time=e,this._easeType){var d=e/l,u=this._easeType,h=this._easePower;(1===u||3===u&&d>=.5)&&(d=1-d),3===u&&(d*=2),1===h?d*=d:2===h?d*=d*d:3===h?d*=d*d*d:4===h&&(d*=d*d*d*d),this.ratio=1===u?1-d:2===u?d:.5>e/l?d/2:1-d/2}else this.ratio=this._ease.getRatio(e/l);if(this._time!==a||n){if(!this._initted){if(this._init(),!this._initted||this._gc)return;this._time&&!i?this.ratio=this._ease.getRatio(this._time/l):i&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._active||!this._paused&&this._time!==a&&e>=0&&(this._active=!0),0===a&&(this._startAt&&(e>=0?this._startAt.render(e,t,n):s||(s="_dummyGS")),this.vars.onStart&&(0!==this._time||0===l)&&(t||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||b))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>e&&this._startAt&&this._startTime&&this._startAt.render(e,t,n),t||(this._time!==a||i)&&this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||b)),s&&(this._gc||(0>e&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(e,t,n),i&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[s]&&this.vars[s].apply(this.vars[s+"Scope"]||this,this.vars[s+"Params"]||b),0===l&&this._rawPrevTime===c&&r!==c&&(this._rawPrevTime=0)))}},s._kill=function(e,t){if("all"===e&&(e=null),null==e&&(null==t||t===this.target))return this._enabled(!1,!1);t="string"!=typeof t?t||this._targets||this.target:N.selector(t)||t;var n,i,s,o,r,a,l,c;if((h(t)||M(t))&&"number"!=typeof t[0])for(n=t.length;--n>-1;)this._kill(e,t[n])&&(a=!0);else{if(this._targets){for(n=this._targets.length;--n>-1;)if(t===this._targets[n]){r=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],i=this._overwrittenProps[n]=e?this._overwrittenProps[n]||{}:"all";break}}else{if(t!==this.target)return!1;r=this._propLookup,i=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(r){l=e||r,c=e!==i&&"all"!==i&&e!==r&&("object"!=typeof e||!e._tempKill);for(s in l)(o=r[s])&&(o.pg&&o.t._kill(l)&&(a=!0),o.pg&&0!==o.t._overwriteProps.length||(o._prev?o._prev._next=o._next:o===this._firstPT&&(this._firstPT=o._next),o._next&&(o._next._prev=o._prev),o._next=o._prev=null),delete r[s]),c&&(i[s]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return a},s.invalidate=function(){return this._notifyPluginsOfEnabled&&N._onPluginEvent("_onDisable",this),this._firstPT=null,this._overwrittenProps=null,this._onUpdate=null,this._startAt=null,this._initted=this._active=this._notifyPluginsOfEnabled=!1,this._propLookup=this._targets?{}:[],this},s._enabled=function(e,t){if(r||o.wake(),e&&this._gc){var n,i=this._targets;if(i)for(n=i.length;--n>-1;)this._siblings[n]=V(i[n],this,!0);else this._siblings=V(this.target,this,!0)}return E.prototype._enabled.call(this,e,t),this._notifyPluginsOfEnabled&&this._firstPT?N._onPluginEvent(e?"_onEnable":"_onDisable",this):!1},N.to=function(e,t,n){return new N(e,t,n)},N.from=function(e,t,n){return n.runBackwards=!0,n.immediateRender=0!=n.immediateRender,new N(e,t,n)},N.fromTo=function(e,t,n,i){return i.startAt=n,i.immediateRender=0!=i.immediateRender&&0!=n.immediateRender,new N(e,t,i)},N.delayedCall=function(e,t,n,i,s){return new N(t,0,{delay:e,onComplete:t,onCompleteParams:n,onCompleteScope:i,onReverseComplete:t,onReverseCompleteParams:n,onReverseCompleteScope:i,immediateRender:!1,useFrames:s,overwrite:0})},N.set=function(e,t){return new N(e,0,t)},N.getTweensOf=function(e,t){if(null==e)return[];e="string"!=typeof e?e:N.selector(e)||e;var n,i,s,o;if((h(e)||M(e))&&"number"!=typeof e[0]){for(n=e.length,i=[];--n>-1;)i=i.concat(N.getTweensOf(e[n],t));for(n=i.length;--n>-1;)for(o=i[n],s=n;--s>-1;)o===i[s]&&i.splice(n,1)}else for(i=V(e).concat(),n=i.length;--n>-1;)(i[n]._gc||t&&!i[n].isActive())&&i.splice(n,1);return i},N.killTweensOf=N.killDelayedCallsTo=function(e,t,n){"object"==typeof t&&(n=t,t=!1);for(var i=N.getTweensOf(e,t),s=i.length;--s>-1;)i[s]._kill(n,e)};var q=m("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=q.prototype},!0);if(s=q.prototype,q.version="1.10.1",q.API=2,s._firstPT=null,s._addTween=function(e,t,n,i,s,o){var r,a;return null!=i&&(r="number"==typeof i||"="!==i.charAt(1)?Number(i)-n:parseInt(i.charAt(0)+"1",10)*Number(i.substr(2)))?(this._firstPT=a={_next:this._firstPT,t:e,p:t,s:n,c:r,f:"function"==typeof e[t],n:s||t,r:o},a._next&&(a._next._prev=a),a):void 0},s.setRatio=function(e){for(var t,n=this._firstPT,i=1e-6;n;)t=n.c*e+n.s,n.r?t=0|t+(t>0?.5:-.5):i>t&&t>-i&&(t=0),n.f?n.t[n.p](t):n.t[n.p]=t,n=n._next},s._kill=function(e){var t,n=this._overwriteProps,i=this._firstPT;if(null!=e[this._propName])this._overwriteProps=[];else for(t=n.length;--t>-1;)null!=e[n[t]]&&n.splice(t,1);for(;i;)null!=e[i.n]&&(i._next&&(i._next._prev=i._prev),i._prev?(i._prev._next=i._next,i._prev=null):this._firstPT===i&&(this._firstPT=i._next)),i=i._next;return!1},s._roundProps=function(e,t){for(var n=this._firstPT;n;)(e[this._propName]||null!=n.n&&e[n.n.split(this._propName+"_").join("")])&&(n.r=t),n=n._next},N._onPluginEvent=function(e,t){var n,i,s,o,r,a=t._firstPT;if("_onInitAllProps"===e){for(;a;){for(r=a._next,i=s;i&&i.pr>a.pr;)i=i._next;(a._prev=i?i._prev:o)?a._prev._next=a:s=a,(a._next=i)?i._prev=a:o=a,a=r}a=t._firstPT=s}for(;a;)a.pg&&"function"==typeof a.t[e]&&a.t[e]()&&(n=!0),a=a._next;return n},q.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===q.API&&(L[(new e[t])._propName]=e[t]);return!0},v.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var t,n=e.propName,i=e.priority||0,s=e.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},r=m("plugins."+n.charAt(0).toUpperCase()+n.substr(1)+"Plugin",function(){q.call(this,n,i),this._overwriteProps=s||[]},e.global===!0),a=r.prototype=new q(n);a.constructor=r,r.API=e.API;for(t in o)"function"==typeof e[t]&&(a[o[t]]=e[t]);return r.version=e.version,q.activate([r]),r},n=e._gsQueue){for(i=0;n.length>i;i++)n[i]();for(s in p)p[s].func||e.console.log("GSAP encountered missing dependency: com.greensock."+s)}r=!1}}(window),define("gs.TweenLite",function(e){return function(){var t;return t||e.TweenLite}}(this)),define("app/views/switchers/SwitcherFaceView",["backbone","app/models/AppModel","app/events/FaceModeEvent","nunjucks","bb.text!app/../../resources/tpl/switchers/SwitcherFace.html","gs.TweenLite"],function(e,t,n,i,s,o){function r(e,t){e._faceMode===n.MODE_SETS?(e.$el.removeClass("mode_fonts"),t.to(e._highlighter,.2,{left:0,width:103,onComplete:function(){e.$el.addClass("mode_sets")}})):(e.$el.removeClass("mode_sets"),t.to(e._highlighter,.2,{left:102,width:113,onComplete:function(){e.$el.addClass("mode_fonts")}}))}var a=e.View.extend({tagName:"div",className:"SwitcherFaceView",_faceMode:n.MODE_SETS,_highlighter:null,events:{"click .button.sets":"onSetsClick","click .button.fonts":"onFontsClick"},initialize:function(){_.bindAll(this,"render","onSetsClick","onFontsClick"),this.listenTo(e,"FaceModeEvent",function(e){this._faceMode=e,r(this,o)},this),this._faceMode=t.getFaceMode(),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(i.renderString(s)),this._highlighter=this.$(".highlighter"),r(this,o),this},onSetsClick:function(){this._faceMode!==n.MODE_SETS&&this.toggle(n.MODE_SETS)},onFontsClick:function(){this._faceMode!==n.MODE_FONTS&&this.toggle(n.MODE_FONTS)},toggle:function(t){e.trigger("FaceModeEvent",t)}});return a}),define("bb.text!app/../../resources/tpl/switchers/SwitcherDisplay.html",[],function(){return'<div class="highlighter"></div>\n<div class="button lines icon-preview_raws"></div>\n<div class="button paragraphs icon-preview_paragraphs"></div>\n<div class="button letters icon-preview_cards"></div>\n'}),define("app/views/switchers/SwitcherDisplayView",["backbone","app/models/AppModel","app/events/DisplayModeEvent","nunjucks","bb.text!app/../../resources/tpl/switchers/SwitcherDisplay.html","gs.TweenLite"],function(e,t,n,i,s,o){function r(e,t){e.$el.removeClass("mode_letters mode_paragraphs mode_lines"),e._displayMode===n.MODE_LETTERS?t.to(e._highlighter,.2,{left:76,onComplete:function(){e.$el.addClass("mode_letters")}}):e._displayMode===n.MODE_PARAGRAPHS?(e.$el.removeClass("mode_fonts"),t.to(e._highlighter,.2,{left:39,onComplete:function(){e.$el.addClass("mode_paragraphs")}})):(e.$el.removeClass("mode_sets"),t.to(e._highlighter,.2,{left:0,onComplete:function(){e.$el.addClass("mode_lines")}}))}var a=e.View.extend({tagName:"div",className:"SwitcherDisplayView",_displayMode:n.MODE_LINES,events:{"click .button.lines":"onLinesClick","click .button.paragraphs":"onParagraphsClick","click .button.letters":"onLettersClick"},initialize:function(){_.bindAll(this,"render","onLinesClick","onParagraphsClick","onLettersClick"),this._displayMode=t.getDisplayMode(),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(i.renderString(s)),this._highlighter=this.$(".highlighter"),r(this,o),this},onLinesClick:function(){this._displayMode!==n.MODE_LINES&&(this._displayMode=n.MODE_LINES,r(this,o),this.toggle())},onParagraphsClick:function(){this._displayMode!==n.MODE_PARAGRAPHS&&(this._displayMode=n.MODE_PARAGRAPHS,r(this,o),this.toggle())},onLettersClick:function(){this._displayMode!==n.MODE_LETTERS&&(this._displayMode=n.MODE_LETTERS,r(this,o),this.toggle())},toggle:function(){e.trigger("DisplayModeEvent",this._displayMode)}});return a}),define("app/events/NightModeEvent",[],function(){var e={MODE_NIGHT:"NightModeEvenr:NIGHT_MODE_NIGHT",MODE_DAY:"NIGHTModeEvent:NIGHT_MODE_DAY"};return e}),define("bb.text!app/../../resources/tpl/switchers/SwitcherNight.html",[],function(){return'<div class="highlighter"></div>\n<div class="button day icon-bg_light"></div>\n<div class="button night icon-bg_dark"></div>\n'}),(window._gsQueue||(window._gsQueue=[])).push(function(){window._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(e,t){var n,i,s,o,r=function(){e.call(this,"css"),this._overwriteProps.length=0,this.setRatio=r.prototype.setRatio},a={},l=r.prototype=new e("css");l.constructor=r,r.version="1.11.4",r.API=2,r.defaultTransformPerspective=0,l="px",r.suffixMap={top:l,right:l,bottom:l,left:l,width:l,height:l,fontSize:l,padding:l,margin:l,perspective:l,lineHeight:""};var c,d,u,h,p,f,v=/(?:\d|\-\d|\.\d|\-\.\d)+/g,m=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,g=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,b=/[^\d\-\.]/g,y=/(?:\d|\-|\+|=|#|\.)*/g,w=/opacity *= *([^)]*)/,_=/opacity:([^;]*)/,x=/alpha\(opacity *=.+?\)/i,k=/^(rgb|hsl)/,S=/([A-Z])/g,C=/-([a-z])/gi,T=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,E=function(e,t){return t.toUpperCase()},A=/(?:Left|Right|Width)/i,F=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,N=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,M=/,(?=[^\)]*(?:\(|$))/gi,$=Math.PI/180,P=180/Math.PI,L={},O=document,B=O.createElement("div"),D=O.createElement("img"),j=r._internals={_specialProps:a},I=navigator.userAgent,R=function(){var e,t=I.indexOf("Android"),n=O.createElement("div");return u=-1!==I.indexOf("Safari")&&-1===I.indexOf("Chrome")&&(-1===t||Number(I.substr(t+8,1))>3),p=u&&6>Number(I.substr(I.indexOf("Version/")+8,1)),h=-1!==I.indexOf("Firefox"),/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(I)&&(f=parseFloat(RegExp.$1)),n.innerHTML="<a style='top:1px;opacity:.55;'>a</a>",e=n.getElementsByTagName("a")[0],e?/^0.55/.test(e.style.opacity):!1}(),V=function(e){return w.test("string"==typeof e?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},z=function(e){window.console&&console.log(e)},H="",q="",U=function(e,t){t=t||B;var n,i,s=t.style;if(void 0!==s[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),n=["O","Moz","ms","Ms","Webkit"],i=5;--i>-1&&void 0===s[n[i]+e];);return i>=0?(q=3===i?"ms":n[i],H="-"+q.toLowerCase()+"-",q+e):null},X=O.defaultView?O.defaultView.getComputedStyle:function(){},W=r.getStyle=function(e,t,n,i,s){var o;return R||"opacity"!==t?(!i&&e.style[t]?o=e.style[t]:(n=n||X(e,null))?(e=n.getPropertyValue(t.replace(S,"-$1").toLowerCase()),o=e||n.length?e:n[t]):e.currentStyle&&(o=e.currentStyle[t]),null==s||o&&"none"!==o&&"auto"!==o&&"auto auto"!==o?o:s):V(e)},Y=function(e,t,n,i,s){if("px"===i||!i)return n;if("auto"===i||!n)return 0;var o,r=A.test(t),a=e,l=B.style,c=0>n;return c&&(n=-n),"%"===i&&-1!==t.indexOf("border")?o=n/100*(r?e.clientWidth:e.clientHeight):(l.cssText="border:0 solid red;position:"+W(e,"position")+";line-height:0;","%"!==i&&a.appendChild?l[r?"borderLeftWidth":"borderTopWidth"]=n+i:(a=e.parentNode||O.body,l[r?"width":"height"]=n+i),a.appendChild(B),o=parseFloat(B[r?"offsetWidth":"offsetHeight"]),a.removeChild(B),0!==o||s||(o=Y(e,t,n,i,!0))),c?-o:o},K=function(e,t,n){if("absolute"!==W(e,"position",n))return 0;var i="left"===t?"Left":"Top",s=W(e,"margin"+i,n);return e["offset"+i]-(Y(e,t,parseFloat(s),s.replace(y,""))||0)},G=function(e,t){var n,i,s={};if(t=t||X(e,null))if(n=t.length)for(;--n>-1;)s[t[n].replace(C,E)]=t.getPropertyValue(t[n]);else for(n in t)s[n]=t[n];else if(t=e.currentStyle||e.style)for(n in t)"string"==typeof n&&void 0!==s[n]&&(s[n.replace(C,E)]=t[n]);return R||(s.opacity=V(e)),i=kt(e,t,!1),s.rotation=i.rotation,s.skewX=i.skewX,s.scaleX=i.scaleX,s.scaleY=i.scaleY,s.x=i.x,s.y=i.y,xt&&(s.z=i.z,s.rotationX=i.rotationX,s.rotationY=i.rotationY,s.scaleZ=i.scaleZ),s.filters&&delete s.filters,s},Q=function(e,t,n,i,s){var o,r,a,l={},c=e.style;for(r in n)"cssText"!==r&&"length"!==r&&isNaN(r)&&(t[r]!==(o=n[r])||s&&s[r])&&-1===r.indexOf("Origin")&&("number"==typeof o||"string"==typeof o)&&(l[r]="auto"!==o||"left"!==r&&"top"!==r?""!==o&&"auto"!==o&&"none"!==o||"string"!=typeof t[r]||""===t[r].replace(b,"")?o:0:K(e,r),void 0!==c[r]&&(a=new ut(c,r,c[r],a)));if(i)for(r in i)"className"!==r&&(l[r]=i[r]);return{difs:l,firstMPT:a}},J={width:["Left","Right"],height:["Top","Bottom"]},Z=["marginLeft","marginRight","marginTop","marginBottom"],et=function(e,t,n){var i=parseFloat("width"===t?e.offsetWidth:e.offsetHeight),s=J[t],o=s.length;for(n=n||X(e,null);--o>-1;)i-=parseFloat(W(e,"padding"+s[o],n,!0))||0,i-=parseFloat(W(e,"border"+s[o]+"Width",n,!0))||0;return i},tt=function(e,t){(null==e||""===e||"auto"===e||"auto auto"===e)&&(e="0 0");var n=e.split(" "),i=-1!==e.indexOf("left")?"0%":-1!==e.indexOf("right")?"100%":n[0],s=-1!==e.indexOf("top")?"0%":-1!==e.indexOf("bottom")?"100%":n[1];return null==s?s="0":"center"===s&&(s="50%"),("center"===i||isNaN(parseFloat(i))&&-1===(i+"").indexOf("="))&&(i="50%"),t&&(t.oxp=-1!==i.indexOf("%"),t.oyp=-1!==s.indexOf("%"),t.oxr="="===i.charAt(1),t.oyr="="===s.charAt(1),t.ox=parseFloat(i.replace(b,"")),t.oy=parseFloat(s.replace(b,""))),i+" "+s+(n.length>2?" "+n[2]:"")},nt=function(e,t){return"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)},it=function(e,t){return null==e?t:"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*Number(e.substr(2))+t:parseFloat(e)},st=function(e,t,n,i){var s,o,r,a,l=1e-6;return null==e?a=t:"number"==typeof e?a=e:(s=360,o=e.split("_"),r=Number(o[0].replace(b,""))*(-1===e.indexOf("rad")?1:P)-("="===e.charAt(1)?0:t),o.length&&(i&&(i[n]=t+r),-1!==e.indexOf("short")&&(r%=s,r!==r%(s/2)&&(r=0>r?r+s:r-s)),-1!==e.indexOf("_cw")&&0>r?r=(r+9999999999*s)%s-(0|r/s)*s:-1!==e.indexOf("ccw")&&r>0&&(r=(r-9999999999*s)%s-(0|r/s)*s)),a=t+r),l>a&&a>-l&&(a=0),a},ot={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},rt=function(e,t,n){return e=0>e?e+1:e>1?e-1:e,0|255*(1>6*e?t+6*(n-t)*e:.5>e?n:2>3*e?t+6*(n-t)*(2/3-e):t)+.5},at=function(e){var t,n,i,s,o,r;return e&&""!==e?"number"==typeof e?[e>>16,255&e>>8,255&e]:(","===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),ot[e]?ot[e]:"#"===e.charAt(0)?(4===e.length&&(t=e.charAt(1),n=e.charAt(2),i=e.charAt(3),e="#"+t+t+n+n+i+i),e=parseInt(e.substr(1),16),[e>>16,255&e>>8,255&e]):"hsl"===e.substr(0,3)?(e=e.match(v),s=Number(e[0])%360/360,o=Number(e[1])/100,r=Number(e[2])/100,n=.5>=r?r*(o+1):r+o-r*o,t=2*r-n,e.length>3&&(e[3]=Number(e[3])),e[0]=rt(s+1/3,t,n),e[1]=rt(s,t,n),e[2]=rt(s-1/3,t,n),e):(e=e.match(v)||ot.transparent,e[0]=Number(e[0]),e[1]=Number(e[1]),e[2]=Number(e[2]),e.length>3&&(e[3]=Number(e[3])),e)):ot.black},lt="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(l in ot)lt+="|"+l+"\\b";lt=RegExp(lt+")","gi");var ct=function(e,t,n,i){if(null==e)return function(e){return e};var s,o=t?(e.match(lt)||[""])[0]:"",r=e.split(o).join("").match(g)||[],a=e.substr(0,e.indexOf(r[0])),l=")"===e.charAt(e.length-1)?")":"",c=-1!==e.indexOf(" ")?" ":",",d=r.length,u=d>0?r[0].replace(v,""):"";return d?s=t?function(e){var t,h,p,f;if("number"==typeof e)e+=u;else if(i&&M.test(e)){for(f=e.replace(M,"|").split("|"),p=0;f.length>p;p++)f[p]=s(f[p]);return f.join(",")}if(t=(e.match(lt)||[o])[0],h=e.split(t).join("").match(g)||[],p=h.length,d>p--)for(;d>++p;)h[p]=n?h[0|(p-1)/2]:r[p];return a+h.join(c)+c+t+l+(-1!==e.indexOf("inset")?" inset":"")}:function(e){var t,o,h;if("number"==typeof e)e+=u;else if(i&&M.test(e)){for(o=e.replace(M,"|").split("|"),h=0;o.length>h;h++)o[h]=s(o[h]);return o.join(",")}if(t=e.match(g)||[],h=t.length,d>h--)for(;d>++h;)t[h]=n?t[0|(h-1)/2]:r[h];return a+t.join(c)+l}:function(e){return e}},dt=function(e){return e=e.split(","),function(t,n,i,s,o,r,a){var l,c=(n+"").split(" ");for(a={},l=0;4>l;l++)a[e[l]]=c[l]=c[l]||c[(l-1)/2>>0];return s.parse(t,a,o,r)}},ut=(j._setPluginRatio=function(e){this.plugin.setRatio(e);for(var t,n,i,s,o=this.data,r=o.proxy,a=o.firstMPT,l=1e-6;a;)t=r[a.v],a.r?t=t>0?0|t+.5:0|t-.5:l>t&&t>-l&&(t=0),a.t[a.p]=t,a=a._next;if(o.autoRotate&&(o.autoRotate.rotation=r.rotation),1===e)for(a=o.firstMPT;a;){if(n=a.t,n.type){if(1===n.type){for(s=n.xs0+n.s+n.xs1,i=1;n.l>i;i++)s+=n["xn"+i]+n["xs"+(i+1)];n.e=s}}else n.e=n.s+n.xs0;a=a._next}},function(e,t,n,i,s){this.t=e,this.p=t,this.v=n,this.r=s,i&&(i._prev=this,this._next=i)}),ht=(j._parseToProxy=function(e,t,n,i,s,o){var r,a,l,c,d,u=i,h={},p={},f=n._transform,v=L;for(n._transform=null,L=t,i=d=n.parse(e,t,i,s),L=v,o&&(n._transform=f,u&&(u._prev=null,u._prev&&(u._prev._next=null)));i&&i!==u;){if(1>=i.type&&(a=i.p,p[a]=i.s+i.c,h[a]=i.s,o||(c=new ut(i,"s",a,c,i.r),i.c=0),1===i.type))for(r=i.l;--r>0;)l="xn"+r,a=i.p+"_"+l,p[a]=i.data[l],h[a]=i[l],o||(c=new ut(i,l,a,c,i.rxp[l]));i=i._next}return{proxy:h,end:p,firstMPT:c,pt:d}},j.CSSPropTween=function(e,t,i,s,r,a,l,c,d,u,h){this.t=e,this.p=t,this.s=i,this.c=s,this.n=l||t,e instanceof ht||o.push(this.n),this.r=c,this.type=a||0,d&&(this.pr=d,n=!0),this.b=void 0===u?i:u,this.e=void 0===h?i+s:h,r&&(this._next=r,r._prev=this)}),pt=r.parseComplex=function(e,t,n,i,s,o,r,a,l,d){n=n||o||"",r=new ht(e,t,0,0,r,d?2:1,null,!1,a,n,i),i+="";var u,h,p,f,g,b,y,w,_,x,S,C,T=n.split(", ").join(",").split(" "),E=i.split(", ").join(",").split(" "),A=T.length,F=c!==!1;for((-1!==i.indexOf(",")||-1!==n.indexOf(","))&&(T=T.join(" ").replace(M,", ").split(" "),E=E.join(" ").replace(M,", ").split(" "),A=T.length),A!==E.length&&(T=(o||"").split(" "),A=T.length),r.plugin=l,r.setRatio=d,u=0;A>u;u++)if(f=T[u],g=E[u],w=parseFloat(f),w||0===w)r.appendXtra("",w,nt(g,w),g.replace(m,""),F&&-1!==g.indexOf("px"),!0);else if(s&&("#"===f.charAt(0)||ot[f]||k.test(f)))C=","===g.charAt(g.length-1)?"),":")",f=at(f),g=at(g),_=f.length+g.length>6,_&&!R&&0===g[3]?(r["xs"+r.l]+=r.l?" transparent":"transparent",r.e=r.e.split(E[u]).join("transparent")):(R||(_=!1),r.appendXtra(_?"rgba(":"rgb(",f[0],g[0]-f[0],",",!0,!0).appendXtra("",f[1],g[1]-f[1],",",!0).appendXtra("",f[2],g[2]-f[2],_?",":C,!0),_&&(f=4>f.length?1:f[3],r.appendXtra("",f,(4>g.length?1:g[3])-f,C,!1)));else if(b=f.match(v)){if(y=g.match(m),!y||y.length!==b.length)return r;for(p=0,h=0;b.length>h;h++)S=b[h],x=f.indexOf(S,p),r.appendXtra(f.substr(p,x-p),Number(S),nt(y[h],S),"",F&&"px"===f.substr(x+S.length,2),0===h),p=x+S.length;r["xs"+r.l]+=f.substr(p)}else r["xs"+r.l]+=r.l?" "+f:f;if(-1!==i.indexOf("=")&&r.data){for(C=r.xs0+r.data.s,u=1;r.l>u;u++)C+=r["xs"+u]+r.data["xn"+u];
r.e=C+r["xs"+u]}return r.l||(r.type=-1,r.xs0=r.e),r.xfirst||r},ft=9;for(l=ht.prototype,l.l=l.pr=0;--ft>0;)l["xn"+ft]=0,l["xs"+ft]="";l.xs0="",l._next=l._prev=l.xfirst=l.data=l.plugin=l.setRatio=l.rxp=null,l.appendXtra=function(e,t,n,i,s,o){var r=this,a=r.l;return r["xs"+a]+=o&&a?" "+e:e||"",n||0===a||r.plugin?(r.l++,r.type=r.setRatio?2:1,r["xs"+r.l]=i||"",a>0?(r.data["xn"+a]=t+n,r.rxp["xn"+a]=s,r["xn"+a]=t,r.plugin||(r.xfirst=new ht(r,"xn"+a,t,n,r.xfirst||r,0,r.n,s,r.pr),r.xfirst.xs0=0),r):(r.data={s:t+n},r.rxp={},r.s=t,r.c=n,r.r=s,r)):(r["xs"+a]+=t+(i||""),r)};var vt=function(e,t){t=t||{},this.p=t.prefix?U(e)||e:e,a[e]=a[this.p]=this,this.format=t.formatter||ct(t.defaultValue,t.color,t.collapsible,t.multi),t.parser&&(this.parse=t.parser),this.clrs=t.color,this.multi=t.multi,this.keyword=t.keyword,this.dflt=t.defaultValue,this.pr=t.priority||0},mt=j._registerComplexSpecialProp=function(e,t,n){"object"!=typeof t&&(t={parser:n});var i,s,o=e.split(","),r=t.defaultValue;for(n=n||[r],i=0;o.length>i;i++)t.prefix=0===i&&t.prefix,t.defaultValue=n[i]||r,s=new vt(o[i],t)},gt=function(e){if(!a[e]){var t=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";mt(e,{parser:function(e,n,i,s,o,r,l){var c=(window.GreenSockGlobals||window).com.greensock.plugins[t];return c?(c._cssRegister(),a[i].parse(e,n,i,s,o,r,l)):(z("Error: "+t+" js file not loaded."),o)}})}};l=vt.prototype,l.parseComplex=function(e,t,n,i,s,o){var r,a,l,c,d,u,h=this.keyword;if(this.multi&&(M.test(n)||M.test(t)?(a=t.replace(M,"|").split("|"),l=n.replace(M,"|").split("|")):h&&(a=[t],l=[n])),l){for(c=l.length>a.length?l.length:a.length,r=0;c>r;r++)t=a[r]=a[r]||this.dflt,n=l[r]=l[r]||this.dflt,h&&(d=t.indexOf(h),u=n.indexOf(h),d!==u&&(n=-1===u?l:a,n[r]+=" "+h));t=a.join(", "),n=l.join(", ")}return pt(e,this.p,t,n,this.clrs,this.dflt,i,this.pr,s,o)},l.parse=function(e,t,n,i,o,r){return this.parseComplex(e.style,this.format(W(e,this.p,s,!1,this.dflt)),this.format(t),o,r)},r.registerSpecialProp=function(e,t,n){mt(e,{parser:function(e,i,s,o,r,a){var l=new ht(e,s,0,0,r,2,s,!1,n);return l.plugin=a,l.setRatio=t(e,i,o._tween,s),l},priority:n})};var bt="scaleX,scaleY,scaleZ,x,y,z,skewX,rotation,rotationX,rotationY,perspective".split(","),yt=U("transform"),wt=H+"transform",_t=U("transformOrigin"),xt=null!==U("perspective"),kt=function(e,t,n,i){if(e._gsTransform&&n&&!i)return e._gsTransform;var s,o,a,l,c,d,u,h,p,f,v,m,g,b=n?e._gsTransform||{skewY:0}:{skewY:0},y=0>b.scaleX,w=2e-5,_=1e5,x=179.99,k=x*$,S=xt?parseFloat(W(e,_t,t,!1,"0 0 0").split(" ")[2])||b.zOrigin||0:0;for(yt?s=W(e,wt,t,!0):e.currentStyle&&(s=e.currentStyle.filter.match(F),s=s&&4===s.length?[s[0].substr(4),Number(s[2].substr(4)),Number(s[1].substr(4)),s[3].substr(4),b.x||0,b.y||0].join(","):""),o=(s||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],a=o.length;--a>-1;)l=Number(o[a]),o[a]=(c=l-(l|=0))?(0|c*_+(0>c?-.5:.5))/_+l:l;if(16===o.length){var C=o[8],T=o[9],E=o[10],A=o[12],N=o[13],M=o[14];if(b.zOrigin&&(M=-b.zOrigin,A=C*M-o[12],N=T*M-o[13],M=E*M+b.zOrigin-o[14]),!n||i||null==b.rotationX){var L,O,B,D,j,I,R,V=o[0],z=o[1],H=o[2],q=o[3],U=o[4],X=o[5],Y=o[6],K=o[7],G=o[11],Q=Math.atan2(Y,E),J=-k>Q||Q>k;b.rotationX=Q*P,Q&&(D=Math.cos(-Q),j=Math.sin(-Q),L=U*D+C*j,O=X*D+T*j,B=Y*D+E*j,C=U*-j+C*D,T=X*-j+T*D,E=Y*-j+E*D,G=K*-j+G*D,U=L,X=O,Y=B),Q=Math.atan2(C,V),b.rotationY=Q*P,Q&&(I=-k>Q||Q>k,D=Math.cos(-Q),j=Math.sin(-Q),L=V*D-C*j,O=z*D-T*j,B=H*D-E*j,T=z*j+T*D,E=H*j+E*D,G=q*j+G*D,V=L,z=O,H=B),Q=Math.atan2(z,X),b.rotation=Q*P,Q&&(R=-k>Q||Q>k,D=Math.cos(-Q),j=Math.sin(-Q),V=V*D+U*j,O=z*D+X*j,X=z*-j+X*D,Y=H*-j+Y*D,z=O),R&&J?b.rotation=b.rotationX=0:R&&I?b.rotation=b.rotationY=0:I&&J&&(b.rotationY=b.rotationX=0),b.scaleX=(0|Math.sqrt(V*V+z*z)*_+.5)/_,b.scaleY=(0|Math.sqrt(X*X+T*T)*_+.5)/_,b.scaleZ=(0|Math.sqrt(Y*Y+E*E)*_+.5)/_,b.skewX=0,b.perspective=G?1/(0>G?-G:G):0,b.x=A,b.y=N,b.z=M}}else if(!(xt&&!i&&o.length&&b.x===o[4]&&b.y===o[5]&&(b.rotationX||b.rotationY)||void 0!==b.x&&"none"===W(e,"display",t))){var Z=o.length>=6,et=Z?o[0]:1,tt=o[1]||0,nt=o[2]||0,it=Z?o[3]:1;b.x=o[4]||0,b.y=o[5]||0,d=Math.sqrt(et*et+tt*tt),u=Math.sqrt(it*it+nt*nt),h=et||tt?Math.atan2(tt,et)*P:b.rotation||0,p=nt||it?Math.atan2(nt,it)*P+h:b.skewX||0,f=d-Math.abs(b.scaleX||0),v=u-Math.abs(b.scaleY||0),Math.abs(p)>90&&270>Math.abs(p)&&(y?(d*=-1,p+=0>=h?180:-180,h+=0>=h?180:-180):(u*=-1,p+=0>=p?180:-180)),m=(h-b.rotation)%180,g=(p-b.skewX)%180,(void 0===b.skewX||f>w||-w>f||v>w||-w>v||m>-x&&x>m&&!1|m*_||g>-x&&x>g&&!1|g*_)&&(b.scaleX=d,b.scaleY=u,b.rotation=h,b.skewX=p),xt&&(b.rotationX=b.rotationY=b.z=0,b.perspective=parseFloat(r.defaultTransformPerspective)||0,b.scaleZ=1)}b.zOrigin=S;for(a in b)w>b[a]&&b[a]>-w&&(b[a]=0);return n&&(e._gsTransform=b),b},St=function(e){var t,n,i=this.data,s=-i.rotation*$,o=s+i.skewX*$,r=1e5,a=(0|Math.cos(s)*i.scaleX*r)/r,l=(0|Math.sin(s)*i.scaleX*r)/r,c=(0|Math.sin(o)*-i.scaleY*r)/r,d=(0|Math.cos(o)*i.scaleY*r)/r,u=this.t.style,h=this.t.currentStyle;if(h){n=l,l=-c,c=-n,t=h.filter,u.filter="";var p,v,m=this.t.offsetWidth,g=this.t.offsetHeight,b="absolute"!==h.position,_="progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+l+", M21="+c+", M22="+d,x=i.x,k=i.y;if(null!=i.ox&&(p=(i.oxp?.01*m*i.ox:i.ox)-m/2,v=(i.oyp?.01*g*i.oy:i.oy)-g/2,x+=p-(p*a+v*l),k+=v-(p*c+v*d)),b?(p=m/2,v=g/2,_+=", Dx="+(p-(p*a+v*l)+x)+", Dy="+(v-(p*c+v*d)+k)+")"):_+=", sizingMethod='auto expand')",u.filter=-1!==t.indexOf("DXImageTransform.Microsoft.Matrix(")?t.replace(N,_):_+" "+t,(0===e||1===e)&&1===a&&0===l&&0===c&&1===d&&(b&&-1===_.indexOf("Dx=0, Dy=0")||w.test(t)&&100!==parseFloat(RegExp.$1)||-1===t.indexOf("gradient("&&t.indexOf("Alpha"))&&u.removeAttribute("filter")),!b){var S,C,T,E=8>f?1:-1;for(p=i.ieOffsetX||0,v=i.ieOffsetY||0,i.ieOffsetX=Math.round((m-((0>a?-a:a)*m+(0>l?-l:l)*g))/2+x),i.ieOffsetY=Math.round((g-((0>d?-d:d)*g+(0>c?-c:c)*m))/2+k),ft=0;4>ft;ft++)C=Z[ft],S=h[C],n=-1!==S.indexOf("px")?parseFloat(S):Y(this.t,C,parseFloat(S),S.replace(y,""))||0,T=n!==i[C]?2>ft?-i.ieOffsetX:-i.ieOffsetY:2>ft?p-i.ieOffsetX:v-i.ieOffsetY,u[C]=(i[C]=Math.round(n-T*(0===ft||2===ft?1:E)))+"px"}}},Ct=function(){var e,t,n,i,s,o,r,a,l,c,d,u,p,f,v,m,g,b,y,w,_,x,k,S=this.data,C=this.t.style,T=S.rotation*$,E=S.scaleX,A=S.scaleY,F=S.scaleZ,N=S.perspective;if(h){var M=1e-4;M>E&&E>-M&&(E=F=2e-5),M>A&&A>-M&&(A=F=2e-5),!N||S.z||S.rotationX||S.rotationY||(N=0)}if(T||S.skewX)b=Math.cos(T),y=Math.sin(T),e=b,s=y,S.skewX&&(T-=S.skewX*$,b=Math.cos(T),y=Math.sin(T)),t=-y,o=b;else{if(!(S.rotationY||S.rotationX||1!==F||N))return void(C[yt]="translate3d("+S.x+"px,"+S.y+"px,"+S.z+"px)"+(1!==E||1!==A?" scale("+E+","+A+")":""));e=o=1,t=s=0}d=1,n=i=r=a=l=c=u=p=f=0,v=N?-1/N:0,m=S.zOrigin,g=1e5,T=S.rotationY*$,T&&(b=Math.cos(T),y=Math.sin(T),l=d*-y,p=v*-y,n=e*y,r=s*y,d*=b,v*=b,e*=b,s*=b),T=S.rotationX*$,T&&(b=Math.cos(T),y=Math.sin(T),w=t*b+n*y,_=o*b+r*y,x=c*b+d*y,k=f*b+v*y,n=t*-y+n*b,r=o*-y+r*b,d=c*-y+d*b,v=f*-y+v*b,t=w,o=_,c=x,f=k),1!==F&&(n*=F,r*=F,d*=F,v*=F),1!==A&&(t*=A,o*=A,c*=A,f*=A),1!==E&&(e*=E,s*=E,l*=E,p*=E),m&&(u-=m,i=n*u,a=r*u,u=d*u+m),i=(w=(i+=S.x)-(i|=0))?(0|w*g+(0>w?-.5:.5))/g+i:i,a=(w=(a+=S.y)-(a|=0))?(0|w*g+(0>w?-.5:.5))/g+a:a,u=(w=(u+=S.z)-(u|=0))?(0|w*g+(0>w?-.5:.5))/g+u:u,C[yt]="matrix3d("+[(0|e*g)/g,(0|s*g)/g,(0|l*g)/g,(0|p*g)/g,(0|t*g)/g,(0|o*g)/g,(0|c*g)/g,(0|f*g)/g,(0|n*g)/g,(0|r*g)/g,(0|d*g)/g,(0|v*g)/g,i,a,u,N?1+-u/N:1].join(",")+")"},Tt=function(e){var t,n,i,s,o,r=this.data,a=this.t,l=a.style;return r.rotationX||r.rotationY||r.z||r.force3D?(this.setRatio=Ct,void Ct.call(this,e)):void(r.rotation||r.skewX?(t=r.rotation*$,n=t-r.skewX*$,i=1e5,s=r.scaleX*i,o=r.scaleY*i,l[yt]="matrix("+(0|Math.cos(t)*s)/i+","+(0|Math.sin(t)*s)/i+","+(0|Math.sin(n)*-o)/i+","+(0|Math.cos(n)*o)/i+","+r.x+","+r.y+")"):l[yt]="matrix("+r.scaleX+",0,0,"+r.scaleY+","+r.x+","+r.y+")")};mt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,transformPerspective,directionalRotation,parseTransform,force3D",{parser:function(e,t,n,i,o,r,a){if(i._transform)return o;var l,c,d,u,h,p,f,v=i._transform=kt(e,s,!0,a.parseTransform),m=e.style,g=1e-6,b=bt.length,y=a,w={};if("string"==typeof y.transform&&yt)d=m.cssText,m[yt]=y.transform,m.display="block",l=kt(e,null,!1),m.cssText=d;else if("object"==typeof y){if(l={scaleX:it(null!=y.scaleX?y.scaleX:y.scale,v.scaleX),scaleY:it(null!=y.scaleY?y.scaleY:y.scale,v.scaleY),scaleZ:it(y.scaleZ,v.scaleZ),x:it(y.x,v.x),y:it(y.y,v.y),z:it(y.z,v.z),perspective:it(y.transformPerspective,v.perspective)},f=y.directionalRotation,null!=f)if("object"==typeof f)for(d in f)y[d]=f[d];else y.rotation=f;l.rotation=st("rotation"in y?y.rotation:"shortRotation"in y?y.shortRotation+"_short":"rotationZ"in y?y.rotationZ:v.rotation,v.rotation,"rotation",w),xt&&(l.rotationX=st("rotationX"in y?y.rotationX:"shortRotationX"in y?y.shortRotationX+"_short":v.rotationX||0,v.rotationX,"rotationX",w),l.rotationY=st("rotationY"in y?y.rotationY:"shortRotationY"in y?y.shortRotationY+"_short":v.rotationY||0,v.rotationY,"rotationY",w)),l.skewX=null==y.skewX?v.skewX:st(y.skewX,v.skewX),l.skewY=null==y.skewY?v.skewY:st(y.skewY,v.skewY),(c=l.skewY-v.skewY)&&(l.skewX+=c,l.rotation+=c)}for(xt&&null!=y.force3D&&(v.force3D=y.force3D,p=!0),h=v.force3D||v.z||v.rotationX||v.rotationY||l.z||l.rotationX||l.rotationY||l.perspective,h||null==y.scale||(l.scaleZ=1);--b>-1;)n=bt[b],u=l[n]-v[n],(u>g||-g>u||null!=L[n])&&(p=!0,o=new ht(v,n,v[n],u,o),n in w&&(o.e=w[n]),o.xs0=0,o.plugin=r,i._overwriteProps.push(o.n));return u=y.transformOrigin,(u||xt&&h&&v.zOrigin)&&(yt?(p=!0,n=_t,u=(u||W(e,n,s,!1,"50% 50%"))+"",o=new ht(m,n,0,0,o,-1,"transformOrigin"),o.b=m[n],o.plugin=r,xt?(d=v.zOrigin,u=u.split(" "),v.zOrigin=(u.length>2&&(0===d||"0px"!==u[2])?parseFloat(u[2]):d)||0,o.xs0=o.e=m[n]=u[0]+" "+(u[1]||"50%")+" 0px",o=new ht(v,"zOrigin",0,0,o,-1,o.n),o.b=d,o.xs0=o.e=v.zOrigin):o.xs0=o.e=m[n]=u):tt(u+"",v)),p&&(i._transformType=h||3===this._transformType?3:2),o},prefix:!0}),mt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),mt("borderRadius",{defaultValue:"0px",parser:function(e,t,n,o,r){t=this.format(t);var a,l,c,d,u,h,p,f,v,m,g,b,y,w,_,x,k=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],S=e.style;for(v=parseFloat(e.offsetWidth),m=parseFloat(e.offsetHeight),a=t.split(" "),l=0;k.length>l;l++)this.p.indexOf("border")&&(k[l]=U(k[l])),u=d=W(e,k[l],s,!1,"0px"),-1!==u.indexOf(" ")&&(d=u.split(" "),u=d[0],d=d[1]),h=c=a[l],p=parseFloat(u),b=u.substr((p+"").length),y="="===h.charAt(1),y?(f=parseInt(h.charAt(0)+"1",10),h=h.substr(2),f*=parseFloat(h),g=h.substr((f+"").length-(0>f?1:0))||""):(f=parseFloat(h),g=h.substr((f+"").length)),""===g&&(g=i[n]||b),g!==b&&(w=Y(e,"borderLeft",p,b),_=Y(e,"borderTop",p,b),"%"===g?(u=100*(w/v)+"%",d=100*(_/m)+"%"):"em"===g?(x=Y(e,"borderLeft",1,"em"),u=w/x+"em",d=_/x+"em"):(u=w+"px",d=_+"px"),y&&(h=parseFloat(u)+f+g,c=parseFloat(d)+f+g)),r=pt(S,k[l],u+" "+d,h+" "+c,!1,"0px",r);return r},prefix:!0,formatter:ct("0px 0px 0px 0px",!1,!0)}),mt("backgroundPosition",{defaultValue:"0 0",parser:function(e,t,n,i,o,r){var a,l,c,d,u,h,p="background-position",v=s||X(e,null),m=this.format((v?f?v.getPropertyValue(p+"-x")+" "+v.getPropertyValue(p+"-y"):v.getPropertyValue(p):e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY)||"0 0"),g=this.format(t);if(-1!==m.indexOf("%")!=(-1!==g.indexOf("%"))&&(h=W(e,"backgroundImage").replace(T,""),h&&"none"!==h)){for(a=m.split(" "),l=g.split(" "),D.setAttribute("src",h),c=2;--c>-1;)m=a[c],d=-1!==m.indexOf("%"),d!==(-1!==l[c].indexOf("%"))&&(u=0===c?e.offsetWidth-D.width:e.offsetHeight-D.height,a[c]=d?parseFloat(m)/100*u+"px":100*(parseFloat(m)/u)+"%");m=a.join(" ")}return this.parseComplex(e.style,m,g,o,r)},formatter:tt}),mt("backgroundSize",{defaultValue:"0 0",formatter:tt}),mt("perspective",{defaultValue:"0px",prefix:!0}),mt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),mt("transformStyle",{prefix:!0}),mt("backfaceVisibility",{prefix:!0}),mt("userSelect",{prefix:!0}),mt("margin",{parser:dt("marginTop,marginRight,marginBottom,marginLeft")}),mt("padding",{parser:dt("paddingTop,paddingRight,paddingBottom,paddingLeft")}),mt("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(e,t,n,i,o,r){var a,l,c;return 9>f?(l=e.currentStyle,c=8>f?" ":",",a="rect("+l.clipTop+c+l.clipRight+c+l.clipBottom+c+l.clipLeft+")",t=this.format(t).split(",").join(c)):(a=this.format(W(e,this.p,s,!1,this.dflt)),t=this.format(t)),this.parseComplex(e.style,a,t,o,r)}}),mt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),mt("autoRound,strictUnits",{parser:function(e,t,n,i,s){return s}}),mt("border",{defaultValue:"0px solid #000",parser:function(e,t,n,i,o,r){return this.parseComplex(e.style,this.format(W(e,"borderTopWidth",s,!1,"0px")+" "+W(e,"borderTopStyle",s,!1,"solid")+" "+W(e,"borderTopColor",s,!1,"#000")),this.format(t),o,r)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(lt)||["#000"])[0]}}),mt("borderWidth",{parser:dt("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),mt("float,cssFloat,styleFloat",{parser:function(e,t,n,i,s){var o=e.style,r="cssFloat"in o?"cssFloat":"styleFloat";return new ht(o,r,0,0,s,-1,n,!1,0,o[r],t)}});var Et=function(e){var t,n=this.t,i=n.filter||W(this.data,"filter"),s=0|this.s+this.c*e;100===s&&(-1===i.indexOf("atrix(")&&-1===i.indexOf("radient(")&&-1===i.indexOf("oader(")?(n.removeAttribute("filter"),t=!W(this.data,"filter")):(n.filter=i.replace(x,""),t=!0)),t||(this.xn1&&(n.filter=i=i||"alpha(opacity="+s+")"),-1===i.indexOf("opacity")?0===s&&this.xn1||(n.filter=i+" alpha(opacity="+s+")"):n.filter=i.replace(w,"opacity="+s))};mt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(e,t,n,i,o,r){var a=parseFloat(W(e,"opacity",s,!1,"1")),l=e.style,c="autoAlpha"===n;return"string"==typeof t&&"="===t.charAt(1)&&(t=("-"===t.charAt(0)?-1:1)*parseFloat(t.substr(2))+a),c&&1===a&&"hidden"===W(e,"visibility",s)&&0!==t&&(a=0),R?o=new ht(l,"opacity",a,t-a,o):(o=new ht(l,"opacity",100*a,100*(t-a),o),o.xn1=c?1:0,l.zoom=1,o.type=2,o.b="alpha(opacity="+o.s+")",o.e="alpha(opacity="+(o.s+o.c)+")",o.data=e,o.plugin=r,o.setRatio=Et),c&&(o=new ht(l,"visibility",0,0,o,-1,null,!1,0,0!==a?"inherit":"hidden",0===t?"hidden":"inherit"),o.xs0="inherit",i._overwriteProps.push(o.n),i._overwriteProps.push(n)),o}});var At=function(e,t){t&&(e.removeProperty?e.removeProperty(t.replace(S,"-$1").toLowerCase()):e.removeAttribute(t))},Ft=function(e){if(this.t._gsClassPT=this,1===e||0===e){this.t.className=0===e?this.b:this.e;for(var t=this.data,n=this.t.style;t;)t.v?n[t.p]=t.v:At(n,t.p),t=t._next;1===e&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.className!==this.e&&(this.t.className=this.e)};mt("className",{parser:function(e,t,i,o,r,a,l){var c,d,u,h,p,f=e.className,v=e.style.cssText;if(r=o._classNamePT=new ht(e,i,0,0,r,2),r.setRatio=Ft,r.pr=-11,n=!0,r.b=f,d=G(e,s),u=e._gsClassPT){for(h={},p=u.data;p;)h[p.p]=1,p=p._next;u.setRatio(1)}return e._gsClassPT=r,r.e="="!==t.charAt(1)?t:f.replace(RegExp("\\s*\\b"+t.substr(2)+"\\b"),"")+("+"===t.charAt(0)?" "+t.substr(2):""),o._tween._duration&&(e.className=r.e,c=Q(e,d,G(e),l,h),e.className=f,r.data=c.firstMPT,e.style.cssText=v,r=r.xfirst=o.parse(e,c.difs,r,a)),r}});var Nt=function(e){if((1===e||0===e)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var t,n,i,s,o=this.t.style,r=a.transform.parse;if("all"===this.e)o.cssText="",s=!0;else for(t=this.e.split(","),i=t.length;--i>-1;)n=t[i],a[n]&&(a[n].parse===r?s=!0:n="transformOrigin"===n?_t:a[n].p),At(o,n);s&&(At(o,yt),this.t._gsTransform&&delete this.t._gsTransform)}};for(mt("clearProps",{parser:function(e,t,i,s,o){return o=new ht(e,i,0,0,o,2),o.setRatio=Nt,o.e=t,o.pr=-10,o.data=s._tween,n=!0,o}}),l="bezier,throwProps,physicsProps,physics2D".split(","),ft=l.length;ft--;)gt(l[ft]);l=r.prototype,l._firstPT=null,l._onInitTween=function(e,t,a){if(!e.nodeType)return!1;this._target=e,this._tween=a,this._vars=t,c=t.autoRound,n=!1,i=t.suffixMap||r.suffixMap,s=X(e,""),o=this._overwriteProps;var l,h,f,v,m,g,b,y,w,x=e.style;if(d&&""===x.zIndex&&(l=W(e,"zIndex",s),("auto"===l||""===l)&&(x.zIndex=0)),"string"==typeof t&&(v=x.cssText,l=G(e,s),x.cssText=v+";"+t,l=Q(e,l,G(e)).difs,!R&&_.test(t)&&(l.opacity=parseFloat(RegExp.$1)),t=l,x.cssText=v),this._firstPT=h=this.parse(e,t,null),this._transformType){for(w=3===this._transformType,yt?u&&(d=!0,""===x.zIndex&&(b=W(e,"zIndex",s),("auto"===b||""===b)&&(x.zIndex=0)),p&&(x.WebkitBackfaceVisibility=this._vars.WebkitBackfaceVisibility||(w?"visible":"hidden"))):x.zoom=1,f=h;f&&f._next;)f=f._next;y=new ht(e,"transform",0,0,null,2),this._linkCSSP(y,null,f),y.setRatio=w&&xt?Ct:yt?Tt:St,y.data=this._transform||kt(e,s,!0),o.pop()}if(n){for(;h;){for(g=h._next,f=v;f&&f.pr>h.pr;)f=f._next;(h._prev=f?f._prev:m)?h._prev._next=h:v=h,(h._next=f)?f._prev=h:m=h,h=g}this._firstPT=v}return!0},l.parse=function(e,t,n,o){var r,l,d,u,h,p,f,v,m,g,b=e.style;for(r in t)p=t[r],l=a[r],l?n=l.parse(e,p,r,this,n,o,t):(h=W(e,r,s)+"",m="string"==typeof p,"color"===r||"fill"===r||"stroke"===r||-1!==r.indexOf("Color")||m&&k.test(p)?(m||(p=at(p),p=(p.length>3?"rgba(":"rgb(")+p.join(",")+")"),n=pt(b,r,h,p,!0,"transparent",n,0,o)):!m||-1===p.indexOf(" ")&&-1===p.indexOf(",")?(d=parseFloat(h),f=d||0===d?h.substr((d+"").length):"",(""===h||"auto"===h)&&("width"===r||"height"===r?(d=et(e,r,s),f="px"):"left"===r||"top"===r?(d=K(e,r,s),f="px"):(d="opacity"!==r?0:1,f="")),g=m&&"="===p.charAt(1),g?(u=parseInt(p.charAt(0)+"1",10),p=p.substr(2),u*=parseFloat(p),v=p.replace(y,"")):(u=parseFloat(p),v=m?p.substr((u+"").length)||"":""),""===v&&(v=r in i?i[r]:f),p=u||0===u?(g?u+d:u)+v:t[r],f!==v&&""!==v&&(u||0===u)&&(d||0===d)&&(d=Y(e,r,d,f),"%"===v?(d/=Y(e,r,100,"%")/100,t.strictUnits!==!0&&(h=d+"%")):"em"===v?d/=Y(e,r,1,"em"):(u=Y(e,r,u,v),v="px"),g&&(u||0===u)&&(p=u+d+v)),g&&(u+=d),!d&&0!==d||!u&&0!==u?void 0!==b[r]&&(p||"NaN"!=p+""&&null!=p)?(n=new ht(b,r,u||d||0,0,n,-1,r,!1,0,h,p),n.xs0="none"!==p||"display"!==r&&-1===r.indexOf("Style")?p:h):z("invalid "+r+" tween value: "+t[r]):(n=new ht(b,r,d,u-d,n,0,r,c!==!1&&("px"===v||"zIndex"===r),0,h,p),n.xs0=v)):n=pt(b,r,h,p,!0,null,n,0,o)),o&&n&&!n.plugin&&(n.plugin=o);return n},l.setRatio=function(e){var t,n,i,s=this._firstPT,o=1e-6;if(1!==e||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(e||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;s;){if(t=s.c*e+s.s,s.r?t=t>0?0|t+.5:0|t-.5:o>t&&t>-o&&(t=0),s.type)if(1===s.type)if(i=s.l,2===i)s.t[s.p]=s.xs0+t+s.xs1+s.xn1+s.xs2;else if(3===i)s.t[s.p]=s.xs0+t+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3;else if(4===i)s.t[s.p]=s.xs0+t+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3+s.xn3+s.xs4;else if(5===i)s.t[s.p]=s.xs0+t+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3+s.xn3+s.xs4+s.xn4+s.xs5;else{for(n=s.xs0+t+s.xs1,i=1;s.l>i;i++)n+=s["xn"+i]+s["xs"+(i+1)];s.t[s.p]=n}else-1===s.type?s.t[s.p]=s.xs0:s.setRatio&&s.setRatio(e);else s.t[s.p]=t+s.xs0;s=s._next}else for(;s;)2!==s.type?s.t[s.p]=s.b:s.setRatio(e),s=s._next;else for(;s;)2!==s.type?s.t[s.p]=s.e:s.setRatio(e),s=s._next},l._enableTransforms=function(e){this._transformType=e||3===this._transformType?3:2,this._transform=this._transform||kt(this._target,s,!0)},l._linkCSSP=function(e,t,n,i){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next,i=!0),n?n._next=e:i||null!==this._firstPT||(this._firstPT=e),e._next=t,e._prev=n),e},l._kill=function(t){var n,i,s,o=t;if(t.autoAlpha||t.alpha){o={};for(i in t)o[i]=t[i];o.opacity=1,o.autoAlpha&&(o.visibility=1)}return t.className&&(n=this._classNamePT)&&(s=n.xfirst,s&&s._prev?this._linkCSSP(s._prev,n._next,s._prev._prev):s===this._firstPT&&(this._firstPT=n._next),n._next&&this._linkCSSP(n._next,n._next._next,s._prev),this._classNamePT=null),e.prototype._kill.call(this,o)};var Mt=function(e,t,n){var i,s,o,r;if(e.slice)for(s=e.length;--s>-1;)Mt(e[s],t,n);else for(i=e.childNodes,s=i.length;--s>-1;)o=i[s],r=o.type,o.style&&(t.push(G(o)),n&&n.push(o)),1!==r&&9!==r&&11!==r||!o.childNodes.length||Mt(o,t,n)};return r.cascadeTo=function(e,n,i){var s,o,r,a=t.to(e,n,i),l=[a],c=[],d=[],u=[],h=t._internals.reservedProps;for(e=a._targets||a.target,Mt(e,c,u),a.render(n,!0),Mt(e,d),a.render(0,!0),a._enabled(!0),s=u.length;--s>-1;)if(o=Q(u[s],c[s],d[s]),o.firstMPT){o=o.difs;for(r in i)h[r]&&(o[r]=i[r]);l.push(t.to(u[s],n,o))}return l},e.activate([r]),r},!0)}),window._gsDefine&&window._gsQueue.pop()(),define("gs.CSSPlugin",["gs.TweenLite"],function(){}),define("app/views/switchers/SwitcherNightView",["backbone","app/models/AppModel","app/events/NightModeEvent","nunjucks","bb.text!app/../../resources/tpl/switchers/SwitcherNight.html","gs.TweenLite","gs.CSSPlugin"],function(e,t,n,i,s,o){function r(e,t){e._nightMode?(e.$el.removeClass("mode_day"),t.to(e._highlighter,.2,{css:{left:0},onComplete:function(){e.$el.addClass("mode_night")}})):(e.$el.removeClass("mode_night"),t.to(e._highlighter,.2,{css:{left:43},onComplete:function(){e.$el.addClass("mode_day")}}))}var a=e.View.extend({tagName:"div",className:"SwitcherNightView",_nightMode:!1,_highlighter:null,events:{"click .button.day":"onDayClick","click .button.night":"onNightClick"},initialize:function(){_.bindAll(this,"render","toggle","onDayClick","onNightClick"),this._nightMode=t.getNightMode(),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(i.renderString(s)),this._highlighter=this.$(".highlighter"),r(this,o),this},onDayClick:function(){this._nightMode&&this.toggle(!1)},onNightClick:function(){this._nightMode||this.toggle(!0)},toggle:function(t){this._nightMode=t,r(this,o),e.trigger("NightModeEvent",t)}});return a}),define("bb.text!app/../../resources/tpl/switchers/SwitcherPangramme.html",[],function(){return'<div class="wrapper"><input class="own" type="text" value="{{own.text}}"/></div>\n<div class="button dropdown"><div class="arrow icon-littlearrow_down"></div></div>\n<div class="select" >\n    {% for p in pangrammes %}\n    <div class="option" id="{{loop.index0}}">{{p.text}}<div class="icon-check tick"></div></div>\n    {% endfor %}\n</div>\n'}),define("app/views/switchers/SwitcherPangrammeView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/switchers/SwitcherPangramme.html"],function(e,t,n){function i(e,t){e.$(".option").removeClass("selected"),e.$(".option#"+t).addClass("selected")}var s=e.View.extend({tagName:"div",className:"SwitcherPangrammeView",_pangramme:null,events:{"click .dropdown":"onDropDown","click .option":"onSelect","change .own":"onEnter","focus .own":"onFocus"},initialize:function(){_.bindAll(this,"render","invalidate","onDropDown","onCollapce"),this._pangrammes=t.getPangrammes("line"),this._pangramme=this._pangrammes[0],this.render()},render:function(){this.$el.attr("id",this.cid);var e=t.nunjucks.renderString(n,{own:this._pangramme,pangrammes:this._pangrammes});return this.$el.html(e),i(this,0),this},invalidate:function(){i(this,_.indexOf(this._pangrammes,t.getPangramme("line"))),this.delegateEvents()},onDropDown:function(){this.$el.addClass("opened");var e=this;setTimeout(function(){e.$el.on("mouseleave",e.onCollapce)},100)},onCollapce:function(){this.$el.removeClass("opened"),$("body").off("click",this.onCollapce)},onSelect:function(e){this.$el.removeClass("opened");var t=parseInt(e.currentTarget.id,10);this._pangramme=this._pangrammes[t],i(this,t),this.$(".own").val(this._pangramme.text),this.toggle(this._pangramme)},onFocus:function(){var e=this;setTimeout(function(){return e.$(".own").select(),!1},100)},onEnter:function(){this._pangramme={text:this.$(".own").val()},i(this,-1),this.toggle(this._pangramme)},toggle:function(t){e.trigger("PangrammeModeEvent",t)}});return s}),define("bb.text!app/../../resources/tpl/switchers/SwitcherText.html",[],function(){return'<div class="wrapper"><input class="own" type="text" disabled value="{{own.name}}"/></div>\n<div class="button dropdown"><div class="arrow"></div></div>\n<div class="select" >\n    {% for p in pangrammes %}\n    <div class="option" id="{{loop.index0}}">{{p.name}}<div class="tick"></div></div>\n    {% endfor %}\n</div>\n'}),define("app/views/switchers/SwitcherTextView",["backbone","app/models/AppModel","nunjucks","bb.text!app/../../resources/tpl/switchers/SwitcherText.html"],function(e,t,n,i){function s(e,t){e.$(".option").removeClass("selected"),e.$(".option#"+t).addClass("selected")}var o=e.View.extend({tagName:"div",className:"SwitcherTextView",_pangramme:"",events:{"click .dropdown":"onDropDown","click .option":"onSelect"},initialize:function(){_.bindAll(this,"render","onCollapce"),this._pangrammes=t.getPangrammes("paragraph"),this._pangramme=this._pangrammes[0],this.render()},render:function(){this.$el.attr("id",this.cid),n.configure({autoescape:!0});var e=n.renderString(i,{own:this._pangramme,pangrammes:this._pangrammes});return this.$el.html(e),this},onDropDown:function(){this.$el.addClass("opened");var e=this;setTimeout(function(){e.$el.on("mouseleave",e.onCollapce)},100)},onCollapce:function(){this.$el.removeClass("opened"),$("body").off("click",this.onCollapce)},onSelect:function(e){this.$el.removeClass("opened");var t=parseInt(e.currentTarget.id,10);this._pangramme=this._pangrammes[t],s(this,t),this.$(".own").val(this._pangramme.name),this.toggle(this._pangramme)},toggle:function(t){e.trigger("PangrammeModeEvent",t)}});return o}),function(e){if(e.zepto&&!e.fn.removeData)throw new ReferenceError("Zepto is loaded without the data module.");e.fn.noUiSlider=function(t,n){function i(e,t){return 100*t/(e[1]-e[0])}function s(e,t){return i(e,e[0]<0?t+Math.abs(e[0]):t-e[0])}function o(e,t){return t*(e[1]-e[0])/100+e[0]}function r(t){return t instanceof e||e.zepto&&e.zepto.isZ(t)}function a(e){return!isNaN(parseFloat(e))&&isFinite(e)}function l(t,n){e.isArray(t)||(t=[t]),e.each(t,function(){"function"==typeof this&&this.call(n)})}function c(t,n){return function(){var i=[null,null];i[n]=e(this).val(),t.val(i,!0)}}function d(e,t){return Math.round(e/t)*t}function u(e,t){return e=e.toFixed(t.decimals),0===parseFloat(e)&&(e=e.replace("-0","0")),e.replace(".",t.serialization.mark)}function h(e,t,n){if(1===e.length)return e[0];var i=e[0].offset()[n]+e[1].offset()[n];return e[i/2>t?0:1]}function p(e,t){return parseFloat(e.toFixed(t))}function f(t){t.preventDefault();var n,i,s=0===t.type.indexOf("touch"),o=0===t.type.indexOf("mouse"),r=0===t.type.indexOf("pointer"),a=t;return 0===t.type.indexOf("MSPointer")&&(r=!0),t.originalEvent&&(t=t.originalEvent),s&&(n=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY),(o||r)&&(r||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),n=t.clientX+window.pageXOffset,i=t.clientY+window.pageYOffset),e.extend(a,{pointX:n,pointY:i,cursor:o})}function v(e,t,n,i){var s=i.target;return e=e.replace(/\s/g,B+" ")+B,t.on(e,function(e){var t=s.attr("disabled");return t=!(void 0===t||null===t),s.hasClass("noUi-state-tap")||t?!1:void n(f(e),i,s.data("base").data("options"))})}function m(t){var n=this.target;return void 0===t?this.element.data("value"):(t===!0?t=this.element.data("value"):this.element.data("value",t),void(void 0!==t&&e.each(this.elements,function(){"function"==typeof this?this.call(n,t):this[0][this[1]](t)})))}function g(t,n,i){if(r(n)){var s=[],o=t.data("target");return t.data("options").direction&&(i=i?0:1),n.each(function(){e(this).on("change"+B,c(o,i)),s.push([e(this),"val"])}),s}return"string"==typeof n&&(n=[e('<input type="hidden" name="'+n+'">').appendTo(t).addClass(j[3]).change(function(e){e.stopPropagation()}),"val"]),[n]}function b(t,n,i){var s=[];return e.each(i.to[n],function(e){s=s.concat(g(t,i.to[n][e],n))}),{element:t,elements:s,target:t.data("target"),val:m}}function y(e,t){var n=e.data("target");n.hasClass(j[14])||(t||(n.addClass(j[15]),setTimeout(function(){n.removeClass(j[15])},450)),n.addClass(j[14]),l(e.data("options").block,n))}function w(e,t){var n=e.data("options");t=p(t,7),e.data("target").removeClass(j[14]),e.css(n.style,t+"%").data("pct",t),e.is(":first-child")&&e.toggleClass(j[13],t>50),n.direction&&(t=100-t),e.data("store").val(u(o(n.range,t),n))}function _(e,t){var n=e.data("base"),i=n.data("options"),s=n.data("handles"),o=0,r=100;return a(t)?(i.step&&(t=d(t,i.step)),s.length>1&&(e[0]!==s[0][0]?o=p(s[0].data("pct")+i.margin,7):r=p(s[1].data("pct")-i.margin,7)),t=Math.min(Math.max(t,o),0>r?100:r),t===e.data("pct")?[o?o:!1,100===r?!1:r]:(w(e,t),!0)):!1}function x(e,t,n,i){e.addClass(j[5]),setTimeout(function(){e.removeClass(j[5])},300),_(t,n),l(i,e.data("target")),e.data("target").change()}function k(t,n,i){var s,o=n.handles,r=t[n.point]-n.start[n.point];if(r=100*r/n.size,1===o.length){if(s=_(o[0],n.positions[0]+r),s!==!0)return void(e.inArray(o[0].data("pct"),s)>=0&&y(n.base,!i.margin))}else{var a,c,u,h;if(i.step&&(r=d(r,i.step)),a=u=n.positions[0]+r,c=h=n.positions[1]+r,0>a?(c+=-1*a,a=0):c>100&&(a-=c-100,c=100),0>u&&!a&&!o[0].data("pct"))return;if(100===c&&h>100&&100===o[1].data("pct"))return;w(o[0],a),w(o[1],c)}l(i.slide,n.target)}function S(e,t,n){1===t.handles.length&&t.handles[0].data("grab").removeClass(j[4]),e.cursor&&O.css("cursor","").off(B),L.off(B),t.target.removeClass(j[14]+" "+j[20]).change(),l(n.set,t.target)}function C(t,n,i){1===n.handles.length&&n.handles[0].data("grab").addClass(j[4]),t.stopPropagation(),v(I.move,L,k,{start:t,base:n.base,target:n.target,handles:n.handles,positions:[n.handles[0].data("pct"),n.handles[n.handles.length-1].data("pct")],point:i.orientation?"pointY":"pointX",size:i.orientation?n.base.height():n.base.width()}),v(I.end,L,S,{target:n.target,handles:n.handles}),t.cursor&&(O.css("cursor",e(t.target).css("cursor")),n.handles.length>1&&n.target.addClass(j[20]),O.on("selectstart"+B,function(){return!1}))}function T(e,t,n){var i,s,o,r,a=t.base;e.stopPropagation(),n.orientation?(o=e.pointY,r=a.height()):(o=e.pointX,r=a.width()),i=h(a.data("handles"),o,n.style),s=100*(o-a.offset()[n.style])/r,x(a,i,s,[n.slide,n.set])}function E(e,t,n){var i,s,o=t.base.data("handles");s=n.orientation?e.pointY:e.pointX,s=s<t.base.offset()[n.style],i=s?0:100,s=s?0:o.length-1,x(t.base,o[s],i,[n.slide,n.set])}function A(t,n){function s(e){return 2!==e.length?!1:(e=[parseFloat(e[0]),parseFloat(e[1])],a(e[0])&&a(e[1])?e[1]<e[0]?!1:e:!1)}var o={resolution:function(e,t){switch(e){case 1:case.1:case.01:case.001:case 1e-4:case 1e-5:e=e.toString().split("."),t.decimals="1"===e[0]?0:e[1].length;break;case void 0:t.decimals=2;break;default:return!1}return!0},mark:function(e,t,n){if(!e)return t[n].mark=".",!0;switch(e){case".":case",":return!0;default:return!1}},to:function(t,n,i){function s(e){return r(e)||"string"==typeof e||"function"==typeof e||e===!1||r(e[0])&&"function"==typeof e[0][e[1]]}function o(t){var n=[[],[]];return s(t)?n[0].push(t):e.each(t,function(e,t){e>1||(s(t)?n[e].push(t):n[e]=n[e].concat(t))}),n}if(t){var a,l;for(t=o(t),n.direction&&t[1].length&&t.reverse(),a=0;a<n.handles;a++)for(l=0;l<t[a].length;l++){if(!s(t[a][l]))return!1;t[a][l]||t[a].splice(l,1)}n[i].to=t}else n[i].to=[[],[]];return!0}},l={handles:{r:!0,t:function(e){return e=parseInt(e,10),1===e||2===e}},range:{r:!0,t:function(e,t,n){return t[n]=s(e),t[n]&&t[n][0]!==t[n][1]}},start:{r:!0,t:function(t,n,i){return 1===n.handles?(e.isArray(t)&&(t=t[0]),t=parseFloat(t),n.start=[t],a(t)):(n[i]=s(t),!!n[i])}},connect:{r:!0,t:function(e,t,n){if("lower"===e)t[n]=1;else if("upper"===e)t[n]=2;else if(e===!0)t[n]=3;else{if(e!==!1)return!1;t[n]=0}return!0}},orientation:{t:function(e,t,n){switch(e){case"horizontal":t[n]=0;break;case"vertical":t[n]=1;break;default:return!1}return!0}},margin:{r:!0,t:function(e,t,n){return e=parseFloat(e),t[n]=i(t.range,e),a(e)}},direction:{r:!0,t:function(e,t,n){switch(e){case"ltr":t[n]=0;break;case"rtl":t[n]=1,t.connect=[0,2,1,3][t.connect];
break;default:return!1}return!0}},behaviour:{r:!0,t:function(e,t,n){return t[n]={tap:e!==(e=e.replace("tap","")),extend:e!==(e=e.replace("extend","")),drag:e!==(e=e.replace("drag","")),fixed:e!==(e=e.replace("fixed",""))},!e.replace("none","").replace(/\-/g,"")}},serialization:{r:!0,t:function(e,t,n){return o.to(e.to,t,n)&&o.resolution(e.resolution,t)&&o.mark(e.mark,t,n)}},slide:{t:function(t){return e.isFunction(t)}},set:{t:function(t){return e.isFunction(t)}},block:{t:function(t){return e.isFunction(t)}},step:{t:function(e,t,n){return e=parseFloat(e),t[n]=i(t.range,e),a(e)}}};e.each(l,function(e,i){var s=t[e],o=void 0!==s;if(i.r&&!o||o&&!i.t(s,t,e))throw window.console&&console.log&&console.group&&(console.group("Invalid noUiSlider initialisation:"),console.log("Option:	",e),console.log("Value:	",s),console.log("Slider(s):	",n),console.groupEnd()),new RangeError("noUiSlider")})}function F(t){return this.data("options",e.extend(!0,{},t)),t=e.extend({handles:2,margin:0,connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},t),t.serialization=t.serialization||{},A(t,this),t.style=t.orientation?"top":"left",this.each(function(){var n,i,s,o=e(this),r=[],a=e("<div/>").appendTo(o);if(o.data("base"))throw new Error("Slider was already initialized.");for(o.data("base",a).addClass([j[6],j[16+t.direction],j[10+t.orientation]].join(" ")),n=0;n<t.handles;n++)s=e("<div><div/></div>").appendTo(a),s.addClass(j[1]),s.children().addClass([j[2],j[2]+j[7+t.direction+(t.direction?-1*n:n)]].join(" ")),s.data({base:a,target:o,options:t,grab:s.children(),pct:-1}).attr("data-style",t.style),s.data({store:b(s,n,t.serialization)}),r.push(s);switch(t.connect){case 1:o.addClass(j[9]),r[0].addClass(j[12]);break;case 3:r[1].addClass(j[12]);case 2:r[0].addClass(j[9]);case 0:o.addClass(j[12])}if(a.addClass(j[0]).data({target:o,options:t,handles:r}),o.val(t.start),!t.behaviour.fixed)for(n=0;n<r.length;n++)v(I.start,r[n].children(),C,{base:a,target:o,handles:[r[n]]});t.behaviour.tap&&v(I.start,a,T,{base:a,target:o}),t.behaviour.extend&&(o.addClass(j[19]),t.behaviour.tap&&v(I.start,o,E,{base:a,target:o})),t.behaviour.drag&&(i=a.find("."+j[9]).addClass(j[18]),t.behaviour.fixed&&(i=i.add(a.children().not(i).data("grab"))),v(I.start,i,C,{base:a,target:o,handles:r}))})}function N(){var t=e(this).data("base"),n=[];return e.each(t.data("handles"),function(){n.push(e(this).data("store").val())}),1===n.length?n[0]:t.data("options").direction?n.reverse():n}function M(t,n){return e.isArray(t)||(t=[t]),this.each(function(){var i,o,r=e(this).data("base"),a=Array.prototype.slice.call(r.data("handles"),0),c=r.data("options");for(a.length>1&&(a[2]=a[0]),c.direction&&t.reverse(),o=0;o<a.length;o++)i=t[o%2],null!==i&&void 0!==i&&("string"===e.type(i)&&(i=i.replace(",",".")),i=s(c.range,parseFloat(i)),c.direction&&(i=100-i),_(a[o],i)!==!0&&a[o].data("store").val(!0),n===!0&&l(c.set,e(this)))})}function $(t){var n=[[t,""]];e.each(t.data("base").data("handles"),function(){n=n.concat(e(this).data("store").elements)}),e.each(n,function(){this.length>1&&this[0].off(B)}),t.removeClass(j.join(" ")),t.empty().removeData("base options")}function P(t){return this.each(function(){var n=e(this).val()||!1,i=e(this).data("options"),s=e.extend({},i,t);n!==!1&&$(e(this)),t&&(e(this).noUiSlider(s),n!==!1&&s.start===i.start&&e(this).val(n))})}var L=e(document),O=e("body"),B=".nui",D=e.fn.val,j=["noUi-base","noUi-origin","noUi-handle","noUi-input","noUi-active","noUi-state-tap","noUi-target","-lower","-upper","noUi-connect","noUi-horizontal","noUi-vertical","noUi-background","noUi-stacking","noUi-block","noUi-state-blocked","noUi-ltr","noUi-rtl","noUi-dragable","noUi-extended","noUi-state-drag"],I=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"};return e.fn.val=function(){return this.hasClass(j[6])?arguments.length?M.apply(this,arguments):N.apply(this):D.apply(this,arguments)},(n?P:F).call(this,t)}}(window.jQuery||window.Zepto),define("jq.noUiSlider",["jQuery"],function(){}),define("bb.text!app/../../resources/tpl/switchers/SwitcherSize.html",[],function(){return'<!--div class="slider">\n    <div class="track"></div>\n    <div class="fill"></div>\n    <div class="knob"><div></div></div>\n    <div class="letter"></div>\n</div>\n<input class="value" type="text" value="{{size}}" maxlength="2"/-->\n\n\n<div class="sliderBox" data-from="10" data-to="50">\n    <div class="icon fontSize"></div>\n    <input type="text" value="{{ size }}" maxlength="2"/>\n    <div class="slider"></div>\n</div>\n'}),function(e){e.fn.dragable=function(t){function n(n){var i=c.parent().offset().left+t.x,s=c.parent().offset().top+t.y;e(".draggable").offset({top:Math.floor(Math.max(s,Math.min(s+t.height,n.pageY+a-o))),left:Math.floor(Math.max(i,Math.min(i+t.width,n.pageX+l-r)))}),t.onMouseMove&&t.onMouseMove(c)}function i(){e("body").off("mousemove",n),""===t.handle?e(this).removeClass("draggable"):e(this).removeClass("active-handle").parent().removeClass("draggable"),t.onMouseUp&&t.onMouseUp(c)}t=e.extend({handle:"",cursor:"move"},t);var s;s=""===t.handle?this:this.find(t.handle),void 0===t.x&&(t.x=0),void 0===t.y&&(t.y=0),void 0===t.width&&(t.width=99999),void 0===t.height&&(t.height=99999);var o,r,a,l,c;return s.on("mousedown",function(s){c=""===t.handle?e(this).addClass("draggable"):e(this).addClass("active-handle").parent().addClass("draggable"),o=c.outerHeight(),r=c.outerWidth(),a=Math.floor(c.offset().top+o-s.pageY),l=Math.floor(c.offset().left+r-s.pageX),e("body").on("mousemove",n),e("body").on("mouseup",i),s.preventDefault()}),s}}(jQuery),define("jq.dragable",["jQuery"],function(e){return function(){var t;return t||e.$.fn.dragable}}(this)),define("app/views/switchers/SwitcherSizeView",["backbone","app/models/AppModel","nunjucks","jq.noUiSlider","bb.text!app/../../resources/tpl/switchers/SwitcherSize.html","jq.dragable"],function(e,t,n,i,s){function o(e){return function(){var t=Math.floor(this.val());e.onChange(t),this.parent().find("input").val(t)}}var r=10,a=50,l=e.View.extend({tagName:"div",className:"SwitcherSizeView",size:16,events:{"change input":"onChangeInput","keyup input":"onChangeInput"},initialize:function(){_.bindAll(this,"render","invalidate","onChange"),this._size=t.getSizeMode(),this._setTo=o(this),this.render()},onChangeInput:function(e){var t=parseInt(e.target.value,10);isNaN(t)||(this.size=Math.max(r,Math.min(a,t)),this.$(".slider").val(this.size),this.toggle(this.size))},render:function(){return this.$el.attr("id",this.cid),this.$el.html(n.renderString(s,{size:this.size})),_.each(this.$(".slider"),function(e){var t=e.parentNode;t=$(t),$(e).noUiSlider({handles:1,step:1,range:[parseInt(t.attr("data-from"),10),parseInt(t.attr("data-to"),10)],start:this._size,connect:"lower",slide:this._setTo})},this),this},invalidate:function(){this.render()},onChange:function(e){this.size=Math.max(r,Math.min(a,e)),this.toggle(this.size)},toggle:function(t){e.trigger("SizeModeEvent",t)}});return l}),define("app/views/switchers/SwitchersPanelView",["backbone","nunjucks","bb.text!app/../../resources/tpl/switchers/SwitchersPanel.html","app/views/switchers/SwitcherFaceView","app/views/switchers/SwitcherDisplayView","app/views/switchers/SwitcherNightView","app/views/switchers/SwitcherPangrammeView","app/views/switchers/SwitcherTextView","app/views/switchers/SwitcherSizeView","app/events/DisplayModeEvent","app/models/AppModel"],function(e,t,n,i,s,o,r,a,l,c,d){var u=e.View.extend({tagName:"div",className:"SwitchersPanelView",_displayMode:null,initialize:function(){_.bindAll(this,"render","onDisplayModeEvent"),e.on("DisplayModeEvent",this.onDisplayModeEvent),this.swFace=new i,this.swMode=new s,this.swNight=new o,this.swPangramme=new r,this.swText=new a,this.swSize=new l,this._displayMode=d.getDisplayMode(),this.onDisplayModeEvent(this._displayMode),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.renderString(n)),this.$("#SwitcherFaceView").append(this.swFace.el),this.$("#SwitcherDisplayView").append(this.swMode.el),this.$("#SwitcherNightView").append(this.swNight.el),this.$("#SwitcherPangrammeView").append(this.swPangramme.el),this.$("#SwitcherTextView").append(this.swText.el),this.$("#SwitcherSizeView").append(this.swSize.el),this.onDisplayModeEvent(this._displayMode),this},onDisplayModeEvent:function(e){this.$el.removeClass("mode_letters mode_lines mode_paragraphs"),e===c.MODE_LETTERS?(this.$el.addClass("mode_letters"),this.swPangramme.$el.parent().addClass("hidden"),this.swPangramme.$el.parent().addClass("hidden"),this.swText.$el.parent().addClass("hidden"),this.swSize.$el.parent().addClass("hidden")):e===c.MODE_PARAGRAPHS?(this.$el.addClass("mode_paragraphs"),this.swText.$el.parent().removeClass("hidden"),this.swPangramme.$el.parent().addClass("hidden"),this.swSize.$el.parent().addClass("hidden")):(this.$el.addClass("mode_lines"),this.swPangramme.$el.parent().removeClass("hidden"),this.swText.$el.parent().addClass("hidden"),this.swSize.$el.parent().removeClass("hidden"))}});return u}),define("bb.text!app/../../resources/tpl/leftpanel/Catalogue.html",[],function(){return'<div class="panel">\n    <div class="header"><div class="button icon-back back"></div><div class="button icon-close close"></div></div>\n    <div class="filters"></div>\n</div>\n'}),define("bb.text!app/../../resources/tpl/leftpanel/Filters.html",[],function(){return'<div class="subPanel p_{{prefix}}">\n    {%for section in filters %}\n        {% if section.filters %}\n        <div id="catalogue_{% if prefix %}{{prefix}}-{% endif %}{{ loop.index0 }}" class="section" {% if section.name %}data-name="{{section.name}}" data-label="{{section.label}}"{%endif%}>\n                {{ section.label }}\n                {% if section.name and section.filters %}<div class="list"><b class="icon-classification_more"></b><b class="icon-classification_more"></b></div>{% endif %}\n            </div>\n        {% elif section.type %}\n        <div id="{{section.name}}" class="filter {{section.type}}">\n                {% if section.edges %}\n                    <div class="label left"> {{ section.edges[0] }}</div>\n                    <div class="label right">{{ section.edges[1] }}</div>\n                {% endif %}\n                {% if section.icons %}\n                    <div class="icon left {{ section.icons[0] }}" ></div>\n                    <div class="icon right {{ section.icons[1] }}" ></div>\n                    {% if section.label %}\n                        <div class="label">{{ section.label }}</div>\n                    {% endif %}\n                {% endif %}\n                <div class="slider"></div>\n            </div>\n        {% else %}\n            <div id="{{section.name}}" data-name="{{section.name}}" class="filter boolean">{{ section.label }}</div>\n        {% endif %}\n    {% endfor %}\n</div>\n'}),define("app/views/leftpanel/CatalogueView",["backbone","gs.TweenLite","jq.mCustomScrollbar","jq.noUiSlider","app/models/AppModel","app/events/FilterEvent","bb.text!app/../../resources/tpl/leftpanel/Catalogue.html","bb.text!app/../../resources/tpl/leftpanel/Filters.html"],function(e,t,n,i,s,o,r,a){function l(){e.trigger(o.ADD,{name:this.attr("data-name"),label:this.attr("data-label"),from:this.val()[0],to:this.val()[1],type:"range"})}function c(){e.trigger(o.ADD,{name:this.attr("data-name"),label:this.attr("data-label"),value:this.val(),to:this.val(),type:"number"})}function d(){var t=$(this);t.hasClass("selected")?(e.trigger(o.DEL,t.data("name")),t.removeClass("selected")):(t.addClass("selected"),e.trigger(o.ADD,{name:t.attr("data-name"),label:t.attr("data-label")}))}var u=/catalogue_([\d-]*)/,h=e.View.extend({tagName:"div",className:"CatalogueView",_filters:null,_curFilters:null,_section:-1,_filter:-1,_prefix:"",$filters:null,_searchTree:{},events:{"click .button.back":"shiftPanel","click .section":"onSectionSelect"},initialize:function(){_.bindAll(this,"render","onSectionSelect","open","close","shiftPanel","highlight","onAdd","onDelete"),this._filters={filters:s.getCachedFilters()},this.collectNodes(this._filters,this._searchTree,""),this._curFilters=this._filters,this.listenTo(e,o.ADD,this.onAdd),this.listenTo(e,o.DEL,this.onDelete)},collectNodes:function(e,t,n){if(e.filters)for(var i=0,s=e.filters.length;s>i;i++)this.collectNodes(e.filters[i],t,n?n+"-"+i:""+i);e.name&&(e.path=n,t[e.name]=e)},highlightPath:function(e,t){if(e){t?this.$(".filter#"+e.name).addClass("selected"):this.$(".filter#"+e.name).removeClass("selected");var n=e.path.split("-");for(n.length--;n.length>0;){var i=$(document.getElementById("catalogue_"+n.join("-")));t?i.addClass("selected"):i.removeClass("selected"),n.length--}}},highlight:function(){for(var e=s.getFilters().pluck("name"),t=0,n=e.length;n>t;t++)this.highlightPath(this._searchTree[e[t]],!0)},onAdd:function(e){if(_.isArray(e))for(var t=0,n=e.length;n>t;t++)this.highlightPath(this._searchTree[e[t].name],!0);else this.highlightPath(this._searchTree[e.name],!0)},onDelete:function(e){this.highlightPath(this._searchTree[e],!1),this.clearDecendeants(this._searchTree[e])},clearDecendeants:function(t){if(t&&t.filters)for(var n=0,i=t.filters.length;i>n;n++)e.trigger(o.DEL,t.filters[n].name)},render:function(){this.$el.attr("id",this.cid),this.$el.html(s.nunjucks.renderString(r)),this.$filters=this.$(".filters"),this.addRender()},addRender:function(){this.$(".filters").append(s.nunjucks.renderString(a,{filters:this._curFilters.filters,prefix:this._prefix}));for(var e=0,n=this._curFilters.filters.length;n>e;e++){var i=this._curFilters.filters[e];if(!i.filters){var o="#"+i.name,r=this.$(o),u=s.getFilters().findWhere({name:i.name});u&&r.addClass("selected");var h;"number"===i.type?(h=this.$(o+" .slider"),h.attr("data-name",i.name),h.attr("data-label",i.label),h.noUiSlider({handles:1,step:i.step,range:[0,100],start:u?u.get("value"):50,connect:"lower",set:c})):"range"===i.type?(h=this.$(o+" .slider"),h.attr("data-name",i.name),h.attr("data-label",i.label),h.noUiSlider({step:i.step,range:[0,100],start:[u?u.get("from"):0,u?u.get("to"):100],connect:!0,set:l})):(r.attr("data-name",i.name),r.attr("data-label",i.label),r.bind("click",d))}this.highlight()}return this.$(".subPanel.p_"+this._prefix).mCustomScrollbar(),this._prefix&&(t.to(this.$filters,.4,{left:-275*this._prefix.split("-").length}),this.$(".header .back").show()),this},open:function(){this.render(),this.highlight(),this.delegateEvents()},close:function(){this._prefix="",this._curFilters=this._filters,this.undelegateEvents(),this.$el.empty()},shiftPanel:function(){var e=this.$filters.find(".subPanel.p_"+this._prefix);this._prefix=this._prefix.substr(0,this._prefix.lastIndexOf("-")),this._curFilters=this.getFiltersByPath(this._prefix),t.to(this.$filters,.4,{left:this._prefix?-275*this._prefix.split("-").length:0,onComplete:function(e){e.remove()},onCompleteParams:[e]}),this._prefix||this.$(".header .back").hide()},getFiltersByPath:function(e){if(""===e)return this._filters;for(var t=e.split("-"),n=this._filters.filters,i=0;i<t.length-1;i++)n=n[parseInt(t[i],10)].filters;return n[t[t.length-1]]},onSectionSelect:function(e){if(0===$(e.target).closest(".section").find(".list").length||$(e.target).closest(".list").length>0){var t=$(e.target).closest(".section")[0].id,n=t.match(u)[1],i=this.getFiltersByPath(n);i.filters&&(this._curFilters=i,this._prefix=n,this.addRender())}else d.call($(e.target).closest(".section"))}});return h}),define("bb.text!app/../../resources/tpl/leftpanel/Adviser.html",[],function(){return'<div class="subPanel p_{{prefix}}">\n    <div class="question" data-id="{{question.id}}">{{question.question}}</div>\n    {%for answer in question.answers %}\n    <div class="answer {% if answer.selected %} selected {% endif %}" data-id="{{loop.index0}}">{{answer.label}}</div>\n    {% endfor %}\n    {% if question.skip %}\n        <div class="next" style="display: none;">дальше</div>\n        <div class="skip">пропустить</div>\n    {% else %}\n        <div class="reset">начать заново</div>\n    {% endif %}\n</div>\n'}),define("app/views/leftpanel/AdviserView",["backbone","gs.TweenLite","jq.mCustomScrollbar","app/models/AppModel","app/events/FilterEvent","bb.text!app/../../resources/tpl/leftpanel/Catalogue.html","bb.text!app/../../resources/tpl/leftpanel/Adviser.html"],function(e,t,n,i,s,o,r){var a=e.View.extend({tagName:"div",className:"CatalogueView AdviserView",$filters:null,_prefix:"",_currentQuestions:null,events:{"click .button.back":"shiftPanel","click .answer":"onAnswer","click .skip":"onSkip","click .next":"onNext","click .reset":function(){this.reset()}},initialize:function(){_.bindAll(this,"render","open","close","shiftPanel","onAdd","clearTag"),this._currentQuestions=[i.getCachedAdviser()[0]],this.listenTo(e,s.ADD,this.onAdd),this.listenTo(e,s.DEL,this.clearTag),this.render()},onAdd:function(){},reset:function(t){this._isEmpty=!0;for(var n=0,i=this._currentQuestions.length;i>n;n++)this.clearQuestion(this._currentQuestions[n]);t||e.trigger(s.DEL),this._currentQuestions.length=1,this.render()},render:function(){this.$el.attr("id",this.cid),this.$el.html(i.nunjucks.renderString(o)),this.$filters=this.$(".filters"),this.$(".header .back").hide(),this.addRender()},addRender:function(){var e=this._currentQuestions[this._currentQuestions.length-1];return this.$(".filters").append(i.nunjucks.renderString(r,{question:e,prefix:e.id})),this.$(".subPanel.p_"+e.id).mCustomScrollbar(),t.to(this.$filters,.4,{left:-275*(this._currentQuestions.length-1)}),1===this._currentQuestions.length?this.$(".header .back").hide():this.$(".header .back").show(),this},open:function(){1!==this._currentQuestions.length||_.findWhere(this._currentQuestions[0].answers,{selected:!0})||e.trigger(s.DEL);var t=this;setTimeout(function(){t.$(".subPanel").mCustomScrollbar("destroy"),t.$(".subPanel").mCustomScrollbar(),t.delegateEvents()},100)},close:function(){this._prefix="",this.this._currentQuestions.length=1,this.undelegateEvents(),this.$el.empty()},clearTag:function(e){if(e){for(var t=i.getCachedAdviser(),n=0,s=t.length;s>n;n++)for(var o=t[n],r=0,a=o.answers.length;a>r;r++)o.answers[r].name===e&&o.answers[r].selected&&(o.answers[r].selected=!1,this.$(".subPanel.p_"+o.id+" .answer[data-id="+r+"]").removeClass("selected"));this.setNextButton()}else this.reset(!0)},setNextButton:function(){var e=this._currentQuestions[this._currentQuestions.length-1],t=this.$(".subPanel.p_"+e.id);_.findWhere(e.answers,{selected:!0})?(t.find(".skip").hide(),t.find(".next").show()):(t.find(".skip").show(),t.find(".next").hide())},clearQuestion:function(t,n){for(var i=0,o=t.answers.length;o>i;i++)t.answers[i].selected&&(t.answers[i].selected=!1,n&&e.trigger(s.DEL,t.answers[i].name))},shiftPanel:function(){var e=this._currentQuestions.pop();this.clearQuestion(e,!0);var n=this.$filters.find(".subPanel.p_"+e.id);t.to(this.$filters,.4,{left:-275*(this._currentQuestions.length-1),onComplete:function(e){e.remove()},onCompleteParams:[n]}),1===this._currentQuestions.length&&this.$(".header .back").hide()},onSkip:function(){var e=this._currentQuestions[this._currentQuestions.length-1],t=_.findWhere(i.getCachedAdviser(),{id:e.skip});this._currentQuestions.push(t),this.addRender()},onNext:function(){var e=this._currentQuestions[this._currentQuestions.length-1],t=_.min(_.pluck(_.where(e.answers,{selected:!0}),"nextId"));if(t>=0){var n=_.findWhere(i.getCachedAdviser(),{id:t});this._currentQuestions.push(n),this.addRender()}},onAnswer:function(t){var n=this._currentQuestions[this._currentQuestions.length-1],i=$(t.target).closest(".answer"),o=parseInt(i.attr("data-id"),10),r=n.answers[o];r.selected=!r.selected,r.selected?(i.addClass("selected"),e.trigger(s.ADD,{name:r.name,label:r.label})):(i.removeClass("selected"),e.trigger(s.DEL,r.name)),this.setNextButton()},fill:function(t){this.reset(),_.each(t,function(t){t.selected=!0,e.trigger(s.ADD,{name:t.name,label:t.label})}),this.render(),this.setNextButton(),this.onNext()}});return a}),define("bb.text!app/../../resources/tpl/leftpanel/LeftPanel.html",[],function(){return'<div class="buttonPanel">\n    <div class="button logoLetter">\n        f\n    </div>\n    <div class="hr"></div>\n    {%for button in [["search","поиск", "icon-search"], ["catalogue","каталог<br/>шрифтов", "icon-catalogue"], ["tester","попробовать<br/>шрифт", "icon-typetester"], ["advice","подсказать<br/>шрифт", "icon-fontadvisor"]] %}\n        <div class="button {{ button[0] }}">\n            <div class="buttonInner">\n                <div class="icon {{ button[0] }} {{ button[2] }}"></div>\n                <div class="hover"><div class="label"> {{ button[1]|safe }}</div></div>\n            </div>\n        </div>\n    {% endfor %}\n</div>\n'}),define("app/views/leftpanel/LeftPanelView",["backbone","nunjucks","app/models/AppModel","app/views/leftpanel/CatalogueView","app/views/leftpanel/AdviserView","bb.text!app/../../resources/tpl/leftpanel/LeftPanel.html"],function(e,t,n,i,s,o){var r=e.View.extend({_viewMode:null,tagName:"div",className:"LeftPanelView",_catalogue:null,_adviser:null,$logoLetter:null,events:{"click .button.close":"closePanel","click .button.catalogue":"openCatalogue","click .button.advice":"openAdviser","click .button.tester":"openTypetester"},initialize:function(){_.bindAll(this,"render","openCatalogue","openTypetester"),this.listenTo(e,"close:typetester",this.closePanel),this.listenTo(e,"change:logo",this.onChangeLogo,this),this.listenTo(e,"open:adviser",this.onOpenAdviser,this),this._catalogue=new i,this._adviser=new s,this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.renderString(o)),this.$logoLetter=this.$(".logoLetter"),this.onChangeLogo(n.getLogoFont()),this},onChangeLogo:function(e){e&&this.$logoLetter.css({"font-family":e})},closePanel:function(){this._catalogue.close(),this.$el.removeClass("opened"),this.$(".button.selected").removeClass("selected"),this.$(">:not(.buttonPanel)").remove(),e.trigger("close:leftpanel"),e.trigger("invalidate")},openCatalogue:function(){this.closePanel(),e.trigger("close:typetester"),this.trigger("close:typetester"),this.$el.addClass("opened"),this.$el.prepend(this._catalogue.$el),this._catalogue.open(),this.$(".button.catalogue").addClass("selected"),this.delegateEvents(),e.trigger("open:leftpanel"),e.trigger("invalidate"),this._viewMode="catalogue"},openTypetester:function(){this.closePanel(),this.$(".button.tester").addClass("selected"),e.trigger("open:leftpanel"),e.trigger("open:typetester"),this._viewMode="typetester"},onOpenAdviser:function(e){this.openAdviser(),this._adviser.fill(e)},openAdviser:function(){this.closePanel(),e.trigger("close:typetester"),this.trigger("close:typetester"),this.$el.addClass("opened"),this.$el.prepend(this._adviser.$el),this._adviser.open(),this.$(".button.advice").addClass("selected"),this.delegateEvents(),e.trigger("open:leftpanel"),e.trigger("invalidate"),this._viewMode="catalogue"}});return r}),define("bb.text!app/../../resources/tpl/bucket/FontSet.html",[],function(){return'\n{% macro expandable(licence) %}\n    <div class="extendedLicences">\n        <div class="licence"><b></b>{{licence.expands}}</div>\n        <div class="licenceList">\n        {% for sublicence in licenceList %}\n            {% if sublicence.extends and sublicence.extends == licence.id and not licences[sublicence.id] %}\n                <div class="licence" id="{{sublicence.id}}">{{sublicence.title}}</div>\n            {% endif %}\n        {% endfor %}\n        </div>\n    </div>\n{% endmacro %}\n\n\n\n<div class="topLine">\n    <div class="tr {% if subSets %} border {%endif%}">\n        <div class="td left">\n            {% if subSets %}<div class="icon icon-fontpack">&nbsp;</div>{% endif %}\n            <div class="fullName">{{fullName}}</div>\n        </div>\n\n            {% if subSets %}\n        <div class="td middle button openSubSets">\n            <div class="subsetcount">{{subSets|length}}&nbsp;{{ subSets|length|decline ("начертаний", "начертание", "начертания") }}<div class="tri down">&nbsp;</div></div>\n        </div>\n            {% endif %}\n\n        <div class="td right">\n            <div class="button delete icon-delete">&nbsp;</div>\n            <div class="price">{{price|money(0)}}&nbsp;&#x20B7;</div>\n        </div>\n    </div>\n</div>\n\n{% if subSets %}\n<div class="subsets">\n    {% for subSet in subSets %}\n        <span class="subset">{{subSet.name}}</span>\n        {% if not loop.last %},{% endif %}\n    {% endfor %}\n</div>\n{% endif %}\n\n\n<div class="licences">\n    {{ licences.length }}\n    {% for id, licence in licences %}\n    <div class="tb">\n        <div class="tr licence">\n            <div class="td left name">\n                {{licence.title}}\n            </div>\n            {% for param in licence.parameters %}\n                    {% if param.type == "number" %}\n                        <div class="td middle">\n                                <input type="text" id="{{licence.id}}:{{param.id}}" value="{{ param.value }}"/><span class="label">{{ param.value|decline( param.title ) }}</span>\n                        </div>\n                    {% endif %}\n\n                    {% if param.type == "select" %}\n                        <div class="td middle forSelector">\n                            <div class="selector">\n                                <div class="value"> {% if param.id == "lang" %}{{languages[param.value].name}}{% else %}{{ param.options[param.value].title }}{% endif %} <span class="tri"></span></div>\n                                <div class="select" >\n                                    {% if param.id == "lang" %}\n                                        {% for lang in languages %}\n                                        <div class="option {% if param.value == lang.id %} selected {% endif %}" id="{{licence.id}}:{{param.id}}:{{loop.index0}}">{{lang.name}}</div>\n                                        {% endfor %}\n                                    {% else %}\n                                        {% for option in param.options %}\n                                        <div class="option {% if param.value == option.value %} selected {% endif %}" id="{{licence.id}}:{{param.id}}:{{option.value}}">{{option.title}}</div>\n                                        {% endfor %}\n                                    {% endif %}\n                                </div>\n                            </div>\n                        </div>\n                    {% endif %}\n\n            {% endfor %}\n            <div class="td right">\n                <div id="{{licence.id}}:delete" class="button delete icon-licence_delete">&nbsp;</div>\n                <div class="price">{{price|money(0)}}&nbsp;&#x20B7;</div>\n            </div>\n        </div>\n    </div>\n    {% endfor %}\n</div>\n<div class="licenceList">\n    {% for licence in licenceList %}\n        {% if not licence.extends and not licences[licence.id] %}\n            <div class="licence" id="{{licence.id}}">{{licence.title}}</div>\n        {% endif %}\n    {% endfor %}\n\n    <!-- для открытия добавить класс opened -->\n    {% for licence in licenceList %}\n        {% if licence.expands %}\n            {{ expandable(licence) }}\n        {% endif %}\n    {% endfor %}\n\n</div>\n<div class="bottomline">\n    <div class="addLicence open"><div class="icon">&nbsp;</div><span class="label open">Добавить лицензию</span><span class="label close">Отменить</span></div>\n    <div class="icon help">&nbsp;</div>\n</div>\n'}),function(e){e.fn.numeric=function(t,n){"boolean"==typeof t&&(t={decimal:t}),t=t||{},"undefined"==typeof t.negative&&(t.negative=!0);var i=t.decimal===!1?"":t.decimal||".",s=t.negative===!0?!0:!1;return n="function"==typeof n?n:function(){},this.data("numeric.decimal",i).data("numeric.negative",s).data("numeric.callback",n).keypress(e.fn.numeric.keypress).keyup(e.fn.numeric.keyup).blur(e.fn.numeric.blur)},e.fn.numeric.keypress=function(t){var n=e.data(this,"numeric.decimal"),i=e.data(this,"numeric.negative"),s=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(13==s&&"input"==this.nodeName.toLowerCase())return!0;if(13==s)return!1;var o=!1;if(t.ctrlKey&&97==s||t.ctrlKey&&65==s)return!0;if(t.ctrlKey&&120==s||t.ctrlKey&&88==s)return!0;if(t.ctrlKey&&99==s||t.ctrlKey&&67==s)return!0;if(t.ctrlKey&&122==s||t.ctrlKey&&90==s)return!0;if(t.ctrlKey&&118==s||t.ctrlKey&&86==s||t.shiftKey&&45==s)return!0;if(48>s||s>57){var r=e(this).val();if(0!==r.indexOf("-")&&i&&45==s&&(0===r.length||0===parseInt(e.fn.getSelectionStart(this),10)))return!0;n&&s==n.charCodeAt(0)&&-1!=r.indexOf(n)&&(o=!1),8!=s&&9!=s&&13!=s&&35!=s&&36!=s&&37!=s&&39!=s&&46!=s?o=!1:"undefined"!=typeof t.charCode&&(t.keyCode==t.which&&0!==t.which?(o=!0,46==t.which&&(o=!1)):0!==t.keyCode&&0===t.charCode&&0===t.which&&(o=!0)),n&&s==n.charCodeAt(0)&&(o=-1==r.indexOf(n)?!0:!1)}else o=!0;return o},e.fn.numeric.keyup=function(){var t=e(this).val();if(t&&t.length>0){var n=e.fn.getSelectionStart(this),i=e.fn.getSelectionEnd(this),s=e.data(this,"numeric.decimal"),o=e.data(this,"numeric.negative");if(""!==s&&null!==s){var r=t.indexOf(s);0===r&&(this.value="0"+t),1==r&&"-"==t.charAt(0)&&(this.value="-0"+t.substring(1)),t=this.value}for(var a=[0,1,2,3,4,5,6,7,8,9,"-",s],l=t.length,c=l-1;c>=0;c--){var d=t.charAt(c);0!==c&&"-"==d?t=t.substring(0,c)+t.substring(c+1):0!==c||o||"-"!=d||(t=t.substring(1));for(var u=!1,h=0;h<a.length;h++)if(d==a[h]){u=!0;break}u&&" "!=d||(t=t.substring(0,c)+t.substring(c+1))}var p=t.indexOf(s);if(p>0)for(var f=l-1;f>p;f--){var v=t.charAt(f);v==s&&(t=t.substring(0,f)+t.substring(f+1))}this.value=t,e.fn.setSelection(this,[n,i])}},e.fn.numeric.blur=function(){var t=e.data(this,"numeric.decimal"),n=e.data(this,"numeric.callback"),i=this.value;if(""!==i){var s=new RegExp("^\\d+$|^\\d*"+t+"\\d+$");s.exec(i)||n.apply(this)}},e.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.callback",null).unbind("keypress",e.fn.numeric.keypress).unbind("blur",e.fn.numeric.blur)},e.fn.getSelectionStart=function(e){if(e.createTextRange){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""===t.text?e.value.length:e.value.lastIndexOf(t.text)}return e.selectionStart},e.fn.getSelectionEnd=function(e){if(e.createTextRange){var t=document.selection.createRange().duplicate();return t.moveStart("character",-e.value.length),t.text.length}return e.selectionEnd},e.fn.setSelection=function(e,t){if("number"==typeof t&&(t=[t,t]),t&&t.constructor==Array&&2==t.length)if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t[0]),n.moveEnd("character",t[1]),n.select()}else e.setSelectionRange&&(e.focus(),e.setSelectionRange(t[0],t[1]))}}(jQuery),define("jq.numeric",["jQuery"],function(e){return function(){var t;return t||e.$.fn.numeric}}(this)),define("app/views/bucket/BucketFontSetView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/bucket/FontSet.html","jq.numeric"],function(e,t,n){var i=e.View.extend({tagName:"div",className:"BucketFontSetView",events:{"mouseover .topLine .delete":"onOverDelete","mouseout .topLine .delete":"onOutDelete","click .topLine .delete":"onDelete","click .openSubSets":"onOpenSubSets","click .addLicence":"onAddLicence","click .licenceList .licence":"onLicence","click .delete":"onLicenceDelete","mouseover .licence .delete":"onOverLicDelete","mouseout .licence .delete":"onOutLicDelete","click .select .option":"onOption","change input[type=text]":"onChange","click .extendedLicences":"onOpenExtended"},initialize:function(){_.bindAll(this,"render","onOverDelete","onAddLicence","onLicence"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(n,_.extend(this.model.toJSON(),{licenceList:t.getLicenceList()}))),this.$("input").numeric(),this.trigger("invalidate"),this
},onOverDelete:function(){this.$(".topLine").addClass("over")},onOutDelete:function(){this.$(".topLine").removeClass("over")},onDelete:function(){this.trigger("Bucket:FontSet:delete",this)},onOpenSubSets:function(){var e=this.$(".subsets"),t=this.$(".openSubSets .tri");"none"===e.css("display")?(e.show(),t.removeClass("down"),t.addClass("up")):(e.hide(),t.removeClass("up"),t.addClass("down")),this.trigger("invalidate")},onAddLicence:function(){var e=this.$(".addLicence"),t=this.$(".licenceList");"none"===t.css("display")?(t.show(),e.removeClass("open"),e.addClass("close")):(t.hide(),e.removeClass("close"),e.addClass("open")),this.trigger("invalidate")},onLicence:function(e){if(e.target.id){var n=_.findWhere(t.getLicenceList(),{id:e.target.id});if(n){if(n.extends&&!this.model.get("licences")[n.extends]){var i=_.findWhere(t.getLicenceList(),{id:n.extends});this.model.get("licences")[n.extends]=_.clone(i)}this.model.get("licences")[n.id]=_.clone(n),this.onAddLicence(e),this.render()}}},onLicenceDelete:function(e){var t=e.target.id.split(":")[0],n=_.where(this.model.get("licences"),{"extends":t});_.each(n,function(e){delete this.model.get("licences")[e.id]},this),delete this.model.get("licences")[t],this.render()},onOpenExtended:function(e){$(e.target).closest(".extendedLicences").toggleClass("opened")},onOverLicDelete:function(e){$(e.target).parent().parent().addClass("over")},onOutLicDelete:function(e){$(e.target).parent().parent().removeClass("over")},onOption:function(e){var t=e.target.id.split(":"),n=this.model.get("licences")[t[0]],i=_.findWhere(n.parameters,{id:t[1]}),s=t[2];i.value=s,this.render()},onChange:function(e){var t=e.target.id.split(":"),n=this.model.get("licences")[t[0]],i=_.findWhere(n.parameters,{id:t[1]});i.value=parseInt(e.target.value,10),this.render()}});return i}),define("bb.text!app/../../resources/tpl/bucket/Bucket.html",[],function(){return'<div class="content">\n    <div class="items">\n    </div>\n\n    <div class="bottomRow">\n        <div class="priceButton">\n            <div class="white"><div class="price">{{price|money(0)}}&nbsp;&#x20B7;</div></div>\n            <div class="red">Оформить заказ</div>\n        </div>\n\n        <div class="promoCode">\n            <div class="icon help"></div>\n            Если у вас есть промо-код, введите его, чтобы получить скидку\n            <input type="text" value="{% if promoCode[0] == "-" %}{{promoCode|replace(\'-\',\'\')}}{% else %}{{ promoCode }}{% endif %}"/>\n            {% if promoCode and promoCode[0] == "-" %}\n            <div class="notFound">\n                <b></b>Промокод не найден\n            </div>\n            {% endif %}\n            {% if promoCode and promoCode.length > 0  and promoCode[0] != "-" %}\n            <div class="accepted">\n                <b></b>Промокод применён\n            </div>\n            {% endif %}\n        </div>\n\n        <div class="promoCode link">\n            <div class="icon link"></div>\n            Копировать ссылку на эту корзину\n        </div>\n    </div>\n</div>\n'}),define("app/views/bucket/BucketView",["backbone","app/models/AppModel","app/models/BucketModel","app/views/bucket/BucketFontSetView","nunjucks","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/bucket/Bucket.html"],function(e,t,n,i,s,o,r){var a=e.View.extend({tagName:"div",className:"BucketView",_views:[],events:{"click .selector":"onClickSelector","click .priceButton":"onSubmit"},initialize:function(){_.bindAll(this,"render","onCloseSelector","invalidate"),console.log(this.model),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(r,this.model.toJSON())),_.each(this._views,function(e){e.remove()}),this._views=[];var e=document.createDocumentFragment();return this.model.getFontSets().each(function(t){var n=new i({model:t});e.appendChild(n.el),this._views.push(n),this.listenTo(n,"Bucket:FontSet:delete",this.onFontSetDelete),this.listenTo(n,"invalidate",this.invalidate)},this),this.$(".items").append(e),this.$el.mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$el.mCustomScrollbar("update"),this.delegateEvents()},onFontSetDelete:function(e){e.model.set("isInBucket",!1),this.render()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onSubmit:function(){this.trigger("payment")}});return a}),define("bb.text!app/../../resources/tpl/bucket/Payment.html",[],function(){return'<div class="conditions">\n<form action="">\n    <div class="topRow">\n            <div class="button top"><span class="topArrow"></span>редактировать корзину</div>\n            <div class="price">{{price|money(0)}}&nbsp;&#x20B7;</div>\n    </div>\n    <div class="tb">\n        <div class="tr">\n            <div class="td header">Лицензиат</div>\n            <div class="td header">Плательщик</div>\n        </div>\n        <div class="tr">\n            <div class="td">Физическое или юридическое лицо, которому будут принадлежать права на шрифт</div>\n            <div class="td">Физическое или юридическое лицо, которому будут принадлежать права на шрифт</div>\n        </div>\n        <div class="tr">\n            <div class="td">\n                <div class="selector">\n                    <div class="value">Red Keds <span class="tri"></span></div>\n                    <div class="select" >\n                        {% for lic in ["Red Keds", "Ked Reds"] %}\n                        <div class="option {% if loop.index0 == 1 or loop.index0 == 2 %} selected {% endif %}" id="{{lang.id}}">{{lic}}</div>\n                        {% endfor %}\n                        <div class="option add" id="add_lic"><div class="icon add"></div>Добавить лицензиата</div>\n                    </div>\n                </div>\n            </div>\n            <div class="td">\n                <div class="selector">\n                    <div class="value">Red Keds <span class="tri"></span></div>\n                    <div class="select" >\n                        {% for lic in ["Red Keds", "Ked Reds"] %}\n                        <div class="option {% if loop.index0 == 1 or loop.index0 == 2 %} selected {% endif %}" id="{{lang.id}}">{{lic}}</div>\n                        {% endfor %}\n                        <div class="option add" id="add_lic"><div class="icon add"></div>Добавить лицензиата</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="hr"></div>\n    <div class="tb">\n        <div class="tr">\n            <div class="td header">\n                Способ оплаты\n            </div>\n        </div>\n        <div class="tr">\n            <div class="td">\n                <input type="radio" id="bucket_radio_bank" name="payment_way"/><label for="bucket_radio_bank">Банковским переводом</label>\n                <br/>\n                <div class="about">Физическое или юридическое лицо, которому будут принадлежать права на шрифт</div>\n            </div>\n            <div class="td">\n                <input type="radio" id="bucket_radio_card" name="payment_way"/><label for="bucket_radio_card">Банковской картой</label>\n                <br/>\n                <div class="about">Физическое или юридическое лицо, которому будут принадлежать права на шрифт</div>\n            </div>\n        </div>\n        <div class="tr">\n            <div class="td">\n                <input type="radio" id="bucket_radio_yandex" name="payment_way"/><label for="bucket_radio_yandex">Яндекс-Деньги</label>\n                <br/>\n                <div class="about">Физическое или юридическое лицо, которому будут принадлежать права на шрифт</div>\n            </div>\n            <div class="td">\n                <input type="radio" id="bucket_radio_paypal" name="payment_way"/><label for="bucket_radio_paypal">PayPal</label>\n                <br/>\n                <div class="about">Физическое или юридическое лицо, которому будут принадлежать права на шрифт</div>\n            </div>\n        </div>\n    </div>\n    <div class="bottomRow">\n        <div class="button submit">Оплатить заказ</div>\n    </div>\n</form>\n</div>\n'}),define("app/views/bucket/PaymentView",["backbone","app/models/AppModel","app/models/BucketModel","nunjucks","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/bucket/Payment.html"],function(e,t,n,i,s,o){var r=e.View.extend({tagName:"div",className:"PaymentView",_views:[],events:{"click .selector":"onClickSelector","click .button.submit":"onSubmit","click .button.top":"onTop"},initialize:function(){_.bindAll(this,"render","onCloseSelector","invalidate","onTop"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(o,this.model.toJSON())),this.$el.mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$el.mCustomScrollbar("update"),this.delegateEvents()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onTop:function(){this.trigger("bucket")},onSubmit:function(){}});return r}),define("bb.text!app/../../resources/tpl/profile/ProfileEdit.html",[],function(){return'\n                    <div class="ProfileView">\n                        <div class="profileTop">\n                            <div class="profileTabs">\n                                <ul>\n                                    <li><div>Информация<br>об аккаунте</div></li>\n                                    <li class="active"><div>лицензиаты<br> и плательщики</div></li>\n                                </ul>\n                            </div>\n                            <div class="topBtns">\n                                <div class="changePass">Сменить пароль</div>\n                                <div class="logout">Выйти из аккаунта</div>\n                            </div>\n                        </div>\n                        <div class="profileScrollHolder">\n                            <div class="profileContent">\n                                <div class="profileInfo">\n                                    <div>\n                                        Здесь вы можете добавлять физических и юридических лиц, которые будут доступны<br>при оформлении заказа в качестве лицензиатов шрифтов и плательщиков\n                                    </div>\n                                </div>\n                                <div class="accounts">\n                                    <div class="account gray">\n                                        <div class="accountOwner">\n                                            Владелец аккаунта\n                                        </div>\n                                        Red Keds\n                                    </div>\n                                    <div class="account">\n                                        <div class="accountEdit">\n                                            Редактировать запись\n                                        </div>\n                                        Павел Череванин\n                                    </div>\n                                </div>\n                                <div class="fieldset">\n                                    <div class="title">\n                                        <input type="radio" disabled/><label>Физическое лицо</label>\n                                        <input type="radio"/><label>Юридическое лицо</label>\n                                    </div>\n                                    <div class="columnLeft">\n                                        <div class="input">\n                                            <input type="text" placeholder="Название"/>\n                                            <div class="success"></div>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="E-mail компании"/>\n                                            <div class="error">\n                                                <div>Oшибка<br>в формате<br>e-mail</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div class="columnRight">\n                                        <div class="input">\n                                            <input type="text" placeholder="Телефон компании"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="ИНН"/>\n                                        </div>\n                                    </div>\n                                    <div class="smallTitle">\n                                        Юридический адрес\n                                    </div>\n                                    <div class="columnLeft">\n                                        <div class="input">\n                                            <input type="text" placeholder="Страна"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="Город"/>\n                                        </div>\n                                    </div>\n                                    <div class="columnRight">\n                                        <div class="input">\n                                            <input type="text" placeholder="Адрес"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="Индекс"/>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="fieldset">\n                                    <div class="title">\n                                        Фактический адрес\n                                        <div class="sameAddress">\n                                            <input type="checkbox"/><label>Совпадает с юридическим</label>\n                                        </div>\n                                    </div>\n                                    <div class="columnLeft">\n                                        <div class="input">\n                                            <input type="text" placeholder="Страна"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="Город"/>\n                                        </div>\n                                    </div>\n                                    <div class="columnRight">\n                                        <div class="input">\n                                            <input type="text" placeholder="Адрес"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="Индекс"/>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="fieldset">\n                                    <div class="title">\n                                        Контактное лицо\n                                    </div>\n                                    <div class="columnLeft">\n                                        <div class="input">\n                                            <input type="text" placeholder="Имя"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="Фамилия"/>\n                                        </div>\n                                    </div>\n                                    <div class="columnRight">\n                                        <div class="input">\n                                            <input type="text" placeholder="E-mail"/>\n                                        </div>\n                                        <div class="input">\n                                            <input type="text" placeholder="Телефон"/>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="buttonWrapper">\n                                    <div class="button">\n                                        <button>Завершить регистрацию</button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n'}),define("app/views/profile/ProfileView",["backbone","app/models/AppModel","app/models/BucketModel","nunjucks","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/profile/ProfileEdit.html"],function(e,t,n,i,s,o){var r=e.View.extend({tagName:"div",className:"ProfileView",_views:[],events:{"click .selector":"onClickSelector","click .button.submit":"onSubmit","click .button.top":"onTop"},initialize:function(){_.bindAll(this,"render","onCloseSelector","invalidate","onTop"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(o,{})),this.$(".profileScrollHolder").mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$(".profileScrollHolder").mCustomScrollbar("update"),this.delegateEvents()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onTop:function(){this.trigger("bucket")},onSubmit:function(){}});return r}),define("bb.text!app/../../resources/tpl/favorites/FavoritesView.html",[],function(){return'                    <div class="favoritesTop">\r\n                        <div class="title">\r\n                            Избранное\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="favoritesScrollHolder">\r\n                    <div class="favoritesContent">\r\n                        <div class="collections">\r\n\r\n                            {% for favorite in favorites %}\r\n                                <div class="item" id="favorite_{{ favorite.id }}">\r\n                                    <div class="itemLeft">\r\n                                        <div class="button edit icon-edit"></div>\r\n                                        <div class="button save icon-save"></div>\r\n                                        <div class="button share icon-share_collection"></div>\r\n                                        <div class="button close icon-share_close"></div>\r\n                                        <div class="button delete icon-delete"></div>\r\n                                    </div>\r\n                                    <div class="itemContent">\r\n                                        <div class="itemTitle">\r\n                                            <textarea disabled>{{ favorite.title }}</textarea>\r\n                                        </div>\r\n                                        <div class="itemFonts">\r\n                                            {% for i in range(0, 4) %}\r\n                                                {% if favorite.fonts[i] %}\r\n                                                <div style="font-family:{{favorite.fonts[i].fontFace}}"><b></b>{{favorite.fonts[i].fullName | truncate(2, true, "") }}</div>\r\n                                                {% else %}\r\n                                                    <div></div>\r\n                                                {% endif %}\r\n                                            {%- endfor %}\r\n                                        </div>\r\n\r\n                                        <div class="itemShare">\r\n                                            <div class="shareBtn fb icon-share_fb"></div>\r\n                                            <div class="shareBtn tw icon-share_twitter"></div>\r\n                                            <div class="shareBtn vk icon-share_vk"></div>\r\n                                            <div class="shareBtn link icon-share_link"></div>\r\n                                            <div class="shareBtn ok icon-share_complete"></div>\r\n                                            <div class="msg">\r\n                                                Ссылка на коллекцию скопирована\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            {% endfor %}\r\n                            \r\n                            {% if  favorites.length < 4 %}\r\n                            {% for  i in range(0, 4-favorites.length) %}\r\n                                <div class="item empty">\r\n                                    <div class="itemContent">\r\n                                        <div class="itemTitle">\r\n                                            Ваша следующая коллекция\r\n                                        </div>\r\n                                        <div class="itemFonts">\r\n                                            {% for j in range(0, 5) %}\r\n                                                <div></div>\r\n                                            {%- endfor %}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            {% endfor %}\r\n                            {% endif %}\r\n\r\n                    </div>\r\n                    </div>\r\n\r\n                </div>\r\n'}),function(){function e(e){return e.replace(/,/g,".").replace(/[^0-9\.]/g,"")}function t(t){return parseFloat(e(t))>=10}var n,i={bridge:null,version:"0.0.0",disabled:null,outdated:null,ready:null},s={},o=0,r={},a=0,l={},c=null,d=null,u=function(){var e,t,n,i,s="ZeroClipboard.swf";if(document.currentScript&&(i=document.currentScript.src));else{var o=document.getElementsByTagName("script");if("readyState"in o[0])for(e=o.length;e--&&("interactive"!==o[e].readyState||!(i=o[e].src)););else if("loading"===document.readyState)i=o[o.length-1].src;else{for(e=o.length;e--;){if(n=o[e].src,!n){t=null;break}if(n=n.split("#")[0].split("?")[0],n=n.slice(0,n.lastIndexOf("/")+1),null==t)t=n;else if(t!==n){t=null;break}}null!==t&&(i=t)}}return i&&(i=i.split("#")[0].split("?")[0],s=i.slice(0,i.lastIndexOf("/")+1)+s),s}(),h=function(){var e=/\-([a-z])/g,t=function(e,t){return t.toUpperCase()};return function(n){return n.replace(e,t)}}(),p=function(e,t){var n,i,s;return window.getComputedStyle?n=window.getComputedStyle(e,null).getPropertyValue(t):(i=h(t),n=e.currentStyle?e.currentStyle[i]:e.style[i]),"cursor"!==t||n&&"auto"!==n||(s=e.tagName.toLowerCase(),"a"!==s)?n:"pointer"},f=function(e){e||(e=window.event);var t;this!==window?t=this:e.target?t=e.target:e.srcElement&&(t=e.srcElement),L.activate(t)},v=function(e,t,n){e&&1===e.nodeType&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n))},m=function(e,t,n){e&&1===e.nodeType&&(e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n))},g=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&"string"==typeof t){var n=(t||"").split(/\s+/);if(1===e.nodeType)if(e.className){for(var i=" "+e.className+" ",s=e.className,o=0,r=n.length;r>o;o++)i.indexOf(" "+n[o]+" ")<0&&(s+=" "+n[o]);e.className=s.replace(/^\s+|\s+$/g,"")}else e.className=t}return e},b=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if(t&&"string"==typeof t||void 0===t){var n=(t||"").split(/\s+/);if(1===e.nodeType&&e.className)if(t){for(var i=(" "+e.className+" ").replace(/[\n\t]/g," "),s=0,o=n.length;o>s;s++)i=i.replace(" "+n[s]+" "," ");e.className=i.replace(/^\s+|\s+$/g,"")}else e.className=""}return e},y=function(){var e,t,n,i=1;return"function"==typeof document.body.getBoundingClientRect&&(e=document.body.getBoundingClientRect(),t=e.right-e.left,n=document.body.offsetWidth,i=Math.round(t/n*100)/100),i},w=function(e,t){var n={left:0,top:0,width:0,height:0,zIndex:T(t)-1};if(e.getBoundingClientRect){var i,s,o,r=e.getBoundingClientRect();"pageXOffset"in window&&"pageYOffset"in window?(i=window.pageXOffset,s=window.pageYOffset):(o=y(),i=Math.round(document.documentElement.scrollLeft/o),s=Math.round(document.documentElement.scrollTop/o));var a=document.documentElement.clientLeft||0,l=document.documentElement.clientTop||0;n.left=r.left+i-a,n.top=r.top+s-l,n.width="width"in r?r.width:r.right-r.left,n.height="height"in r?r.height:r.bottom-r.top}return n},_=function(e,t){var n=null==t||t&&t.cacheBust===!0&&t.useNoCache===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+(new Date).getTime():""},x=function(e){var t,n,i,s=[],o=[],r=[];if(e.trustedOrigins&&("string"==typeof e.trustedOrigins?o.push(e.trustedOrigins):"object"==typeof e.trustedOrigins&&"length"in e.trustedOrigins&&(o=o.concat(e.trustedOrigins))),e.trustedDomains&&("string"==typeof e.trustedDomains?o.push(e.trustedDomains):"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(o=o.concat(e.trustedDomains))),o.length)for(t=0,n=o.length;n>t;t++)if(o.hasOwnProperty(t)&&o[t]&&"string"==typeof o[t]){if(i=F(o[t]),!i)continue;if("*"===i){r=[i];break}r.push.apply(r,[i,"//"+i,window.location.protocol+"//"+i])}return r.length&&s.push("trustedOrigins="+encodeURIComponent(r.join(","))),"string"==typeof e.jsModuleId&&e.jsModuleId&&s.push("jsModuleId="+encodeURIComponent(e.jsModuleId)),s.join("&")},k=function(e,t,n){if("function"==typeof t.indexOf)return t.indexOf(e,n);var i,s=t.length;for("undefined"==typeof n?n=0:0>n&&(n=s+n),i=n;s>i;i++)if(t.hasOwnProperty(i)&&t[i]===e)return i;return-1},S=function(e){if("string"==typeof e)throw new TypeError("ZeroClipboard doesn't accept query strings.");return e.length?e:[e]},C=function(e,t,n,i){i?window.setTimeout(function(){e.apply(t,n)},0):e.apply(t,n)},T=function(e){var t,n;return e&&("number"==typeof e&&e>0?t=e:"string"==typeof e&&(n=parseInt(e,10))&&!isNaN(n)&&n>0&&(t=n)),t||("number"==typeof D.zIndex&&D.zIndex>0?t=D.zIndex:"string"==typeof D.zIndex&&(n=parseInt(D.zIndex,10))&&!isNaN(n)&&n>0&&(t=n)),t||0},E=function(e,t){if(e&&t!==!1&&"undefined"!=typeof console&&console&&(console.warn||console.log)){var n="`"+e+"` is deprecated. See docs for more info:\n    https://github.com/zeroclipboard/zeroclipboard/blob/master/docs/instructions.md#deprecations";console.warn?console.warn(n):console.log(n)}},A=function(){var e,t,n,i,s,o,r=arguments[0]||{};for(e=1,t=arguments.length;t>e;e++)if(null!=(n=arguments[e]))for(i in n)if(n.hasOwnProperty(i)){if(s=r[i],o=n[i],r===o)continue;void 0!==o&&(r[i]=o)}return r},F=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},N=function(){var e=function(e,t){var n,i,s;if(null!=e&&"*"!==t[0]&&("string"==typeof e&&(e=[e]),"object"==typeof e&&"length"in e))for(n=0,i=e.length;i>n;n++)if(e.hasOwnProperty(n)&&(s=F(e[n]))){if("*"===s){t.length=0,t.push("*");break}-1===k(s,t)&&t.push(s)}},t={always:"always",samedomain:"sameDomain",never:"never"};return function(n,i){var s,o=i.allowScriptAccess;if("string"==typeof o&&(s=o.toLowerCase())&&/^always|samedomain|never$/.test(s))return t[s];var r=F(i.moviePath);null===r&&(r=n);var a=[];e(i.trustedOrigins,a),e(i.trustedDomains,a);var l=a.length;if(l>0){if(1===l&&"*"===a[0])return"always";if(-1!==k(n,a))return 1===l&&n===r?"sameDomain":"always"}return"never"}}(),M=function(e){if(null==e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},$=function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&delete e[t];return e},P=function(){var e=!1;if("boolean"==typeof i.disabled)e=i.disabled===!1;else{if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(t){}!e&&navigator.mimeTypes["application/x-shockwave-flash"]&&(e=!0)}return e},L=function(e,t){return this instanceof L?(this.id=""+o++,r[this.id]={instance:this,elements:[],handlers:{}},e&&this.clip(e),"undefined"!=typeof t&&(E("new ZeroClipboard(elements, options)",D.debug),L.config(t)),this.options=L.config(),"boolean"!=typeof i.disabled&&(i.disabled=!P()),void(i.disabled===!1&&i.outdated!==!0&&null===i.bridge&&(i.outdated=!1,i.ready=!1,j()))):new L(e,t)};L.prototype.setText=function(e){return e&&""!==e&&(s["text/plain"]=e,i.ready===!0&&i.bridge&&i.bridge.setText(e)),this},L.prototype.setSize=function(e,t){return i.ready===!0&&i.bridge&&i.bridge.setSize(e,t),this};var O=function(e){i.ready===!0&&i.bridge&&i.bridge.setHandCursor(e)};L.prototype.destroy=function(){this.unclip(),this.off(),delete r[this.id]};var B=function(){var e,t,n,i=[],s=M(r);for(e=0,t=s.length;t>e;e++)n=r[s[e]].instance,n&&n instanceof L&&i.push(n);return i};L.version="1.3.2";var D={swfPath:u,trustedDomains:window.location.host?[window.location.host]:[],cacheBust:!0,forceHandCursor:!1,zIndex:999999999,debug:!0,title:null,autoActivate:!0};L.config=function(e){"object"==typeof e&&null!==e&&A(D,e);{if("string"!=typeof e||!e){var t={};for(var n in D)D.hasOwnProperty(n)&&(t[n]="object"==typeof D[n]&&null!==D[n]?"length"in D[n]?D[n].slice(0):A({},D[n]):D[n]);return t}if(D.hasOwnProperty(e))return D[e]}},L.destroy=function(){L.deactivate();for(var e in r)if(r.hasOwnProperty(e)&&r[e]){var t=r[e].instance;t&&"function"==typeof t.destroy&&t.destroy()}var n=I(i.bridge);n&&n.parentNode&&(n.parentNode.removeChild(n),i.ready=null,i.bridge=null)},L.activate=function(e){n&&(b(n,D.hoverClass),b(n,D.activeClass)),n=e,g(e,D.hoverClass),R();var t=D.title||e.getAttribute("title");if(t){var s=I(i.bridge);s&&s.setAttribute("title",t)}var o=D.forceHandCursor===!0||"pointer"===p(e,"cursor");O(o)},L.deactivate=function(){var e=I(i.bridge);e&&(e.style.left="0px",e.style.top="-9999px",e.removeAttribute("title")),n&&(b(n,D.hoverClass),b(n,D.activeClass),n=null)};var j=function(){var e,t,n=document.getElementById("global-zeroclipboard-html-bridge");if(!n){var s=L.config();s.jsModuleId="string"==typeof c&&c||"string"==typeof d&&d||null;var o=N(window.location.host,D),r=x(s),a=D.moviePath+_(D.moviePath,D),l='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+a+'"/>         <param name="allowScriptAccess" value="'+o+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+r+'"/>         <embed src="'+a+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="'+o+'"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+r+'"           scale="exactfit">         </embed>       </object>';
n=document.createElement("div"),n.id="global-zeroclipboard-html-bridge",n.setAttribute("class","global-zeroclipboard-container"),n.style.position="absolute",n.style.left="0px",n.style.top="-9999px",n.style.width="15px",n.style.height="15px",n.style.zIndex=""+T(D.zIndex),document.body.appendChild(n),n.innerHTML=l}e=document["global-zeroclipboard-flash-bridge"],e&&(t=e.length)&&(e=e[t-1]),i.bridge=e||n.children[0].lastElementChild},I=function(e){for(var t=/^OBJECT|EMBED$/,n=e&&e.parentNode;n&&t.test(n.nodeName)&&n.parentNode;)n=n.parentNode;return n||null},R=function(){if(n){var e=w(n,D.zIndex),t=I(i.bridge);t&&(t.style.top=e.top+"px",t.style.left=e.left+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.zIndex=e.zIndex+1),i.ready===!0&&i.bridge&&i.bridge.setSize(e.width,e.height)}return this};L.prototype.on=function(e,t){var n,s,o,a={},l=r[this.id]&&r[this.id].handlers;if("string"==typeof e&&e)o=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)e.hasOwnProperty(n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(o&&o.length){for(n=0,s=o.length;s>n;n++)e=o[n].replace(/^on/,""),a[e]=!0,l[e]||(l[e]=[]),l[e].push(t);a.noflash&&i.disabled&&H.call(this,"noflash",{}),a.wrongflash&&i.outdated&&H.call(this,"wrongflash",{flashVersion:i.version}),a.load&&i.ready&&H.call(this,"load",{flashVersion:i.version})}return this},L.prototype.off=function(e,t){var n,i,s,o,a,l=r[this.id]&&r[this.id].handlers;if(0===arguments.length)o=M(l);else if("string"==typeof e&&e)o=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)e.hasOwnProperty(n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(o&&o.length)for(n=0,i=o.length;i>n;n++)if(e=o[n].toLowerCase().replace(/^on/,""),a=l[e],a&&a.length)if(t)for(s=k(t,a);-1!==s;)a.splice(s,1),s=k(t,a,s);else l[e].length=0;return this},L.prototype.handlers=function(e){var t,n=null,i=r[this.id]&&r[this.id].handlers;if(i){if("string"==typeof e&&e)return i[e]?i[e].slice(0):null;n={};for(t in i)i.hasOwnProperty(t)&&i[t]&&(n[t]=i[t].slice(0))}return n};var V=function(e,t,n,i){var s=r[this.id]&&r[this.id].handlers[e];if(s&&s.length){var o,a,l,c=t||this;for(o=0,a=s.length;a>o;o++)l=s[o],t=c,"string"==typeof l&&"function"==typeof window[l]&&(l=window[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(t=l,l=l.handleEvent),"function"==typeof l&&C(l,t,n,i)}return this};L.prototype.clip=function(e){e=S(e);for(var t=0;t<e.length;t++)if(e.hasOwnProperty(t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===k(this.id,l[e[t].zcClippingId])&&l[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+a++,l[e[t].zcClippingId]=[this.id],D.autoActivate===!0&&v(e[t],"mouseover",f));var n=r[this.id].elements;-1===k(e[t],n)&&n.push(e[t])}return this},L.prototype.unclip=function(e){var t=r[this.id];if(t){var n,i=t.elements;e="undefined"==typeof e?i.slice(0):S(e);for(var s=e.length;s--;)if(e.hasOwnProperty(s)&&e[s]&&1===e[s].nodeType){for(n=0;-1!==(n=k(e[s],i,n));)i.splice(n,1);var o=l[e[s].zcClippingId];if(o){for(n=0;-1!==(n=k(this.id,o,n));)o.splice(n,1);0===o.length&&(D.autoActivate===!0&&m(e[s],"mouseover",f),delete e[s].zcClippingId)}}}return this},L.prototype.elements=function(){var e=r[this.id];return e&&e.elements?e.elements.slice(0):[]};var z=function(e){var t,n,i,s,o,a=[];if(e&&1===e.nodeType&&(t=e.zcClippingId)&&l.hasOwnProperty(t)&&(n=l[t],n&&n.length))for(i=0,s=n.length;s>i;i++)o=r[n[i]].instance,o&&o instanceof L&&a.push(o);return a};D.hoverClass="zeroclipboard-is-hover",D.activeClass="zeroclipboard-is-active",D.trustedOrigins=null,D.allowScriptAccess=null,D.useNoCache=!0,D.moviePath="ZeroClipboard.swf",L.detectFlashSupport=function(){return E("ZeroClipboard.detectFlashSupport",D.debug),P()},L.dispatch=function(e,t){if("string"==typeof e&&e){var i=e.toLowerCase().replace(/^on/,"");if(i)for(var s=n?z(n):B(),o=0,r=s.length;r>o;o++)H.call(s[o],i,t)}},L.prototype.setHandCursor=function(e){return E("ZeroClipboard.prototype.setHandCursor",D.debug),e="boolean"==typeof e?e:!!e,O(e),D.forceHandCursor=e,this},L.prototype.reposition=function(){return E("ZeroClipboard.prototype.reposition",D.debug),R()},L.prototype.receiveEvent=function(e,t){if(E("ZeroClipboard.prototype.receiveEvent",D.debug),"string"==typeof e&&e){var n=e.toLowerCase().replace(/^on/,"");n&&H.call(this,n,t)}},L.prototype.setCurrent=function(e){return E("ZeroClipboard.prototype.setCurrent",D.debug),L.activate(e),this},L.prototype.resetBridge=function(){return E("ZeroClipboard.prototype.resetBridge",D.debug),L.deactivate(),this},L.prototype.setTitle=function(e){if(E("ZeroClipboard.prototype.setTitle",D.debug),e=e||D.title||n&&n.getAttribute("title")){var t=I(i.bridge);t&&t.setAttribute("title",e)}return this},L.setDefaults=function(e){E("ZeroClipboard.setDefaults",D.debug),L.config(e)},L.prototype.addEventListener=function(e,t){return E("ZeroClipboard.prototype.addEventListener",D.debug),this.on(e,t)},L.prototype.removeEventListener=function(e,t){return E("ZeroClipboard.prototype.removeEventListener",D.debug),this.off(e,t)},L.prototype.ready=function(){return E("ZeroClipboard.prototype.ready",D.debug),i.ready===!0};var H=function(o,r){o=o.toLowerCase().replace(/^on/,"");var a=r&&r.flashVersion&&e(r.flashVersion)||null,l=n,c=!0;switch(o){case"load":if(a){if(!t(a))return void H.call(this,"onWrongFlash",{flashVersion:a});i.outdated=!1,i.ready=!0,i.version=a}break;case"wrongflash":a&&!t(a)&&(i.outdated=!0,i.ready=!1,i.version=a);break;case"mouseover":g(l,D.hoverClass);break;case"mouseout":D.autoActivate===!0&&L.deactivate();break;case"mousedown":g(l,D.activeClass);break;case"mouseup":b(l,D.activeClass);break;case"datarequested":var d=l.getAttribute("data-clipboard-target"),u=d?document.getElementById(d):null;if(u){var h=u.value||u.textContent||u.innerText;h&&this.setText(h)}else{var p=l.getAttribute("data-clipboard-text");p&&this.setText(p)}c=!1;break;case"complete":$(s)}var f=l,v=[this,r];return V.call(this,o,f,v,c)};"function"==typeof define&&define.amd?define("ZeroClipboard",["require","exports","module"],function(e,t,n){return c=n&&n.id||null,L}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?(d=module.id||null,module.exports=L):window.ZeroClipboard=L}(),define("app/views/favorites/FavoritesView",["backbone","app/models/AppModel","app/models/BucketModel","nunjucks","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/favorites/FavoritesView.html","ZeroClipboard"],function(e,t,n,i,s,o,r){var a=e.View.extend({tagName:"div",className:"FavoritesView",_isEditing:!1,_clippers:[],events:{"click .button.delete":"onDeleteFavorite","click .button.edit":"onEdit","click .button.save":"onEdited","click .button.share":"onOpenShare","click .button.close":"onCloseShare","click .selector":"onClickSelector","click .itemContent":"onContent","click .button.top":"onTop","click .shareBtn":"onShare"},initialize:function(){_.bindAll(this,"render","onCloseSelector","invalidate","onContent","onNotEdited"),this.listenTo(t.getFavoritesCollection(),"all",this.render),this.listenTo(t.getFavoritesCollection(),"change",this.render),r.config({moviePath:"resources/images/ZeroClipboard.swf",hoverClass:"hover"}),this.render()},remove:function(){_.each(this._clippers,function(e){e.destroy()}),this._clippers.length=0,e.View.prototype.remove.call(this)},render:function(){return this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(o,{favorites:t.getFavoritesCollection().toJSON()})),this.$(".favoritesScrollHolder").mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$(".favoritesScrollHolder").mCustomScrollbar("update"),this.delegateEvents()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onContent:function(e){var n=$(e.target).closest(".shareBtn");if(!(this._isEditing||n.length>0)){var i=$(e.target).closest(".item")[0].id.split("_")[1];this.trigger("favorite",t.getFavoritesCollection().findWhere({id:i}))}},onOpenShare:function(e){var n=$(e.target).closest(".item");n.addClass("shareable");var i=t.baseUrl+"/favorite/"+n[0].id.split("_")[1],s=n.find(".shareBtn.link"),o=new r(s);o.on("dataRequested",function(e){e.setText(i)}),o.on("load",function(e){e.on("complete",function(){n.addClass("copied"),setTimeout(function(){n.removeClass("copied")},2e3)})}),this._clippers.push(o)},onCloseShare:function(e){$(e.target).closest(".item").removeClass("shareable")},onDeleteFavorite:function(e){var n=$(e.target).closest(".item")[0].id.split("_")[1],i=t.getFavoritesCollection().findWhere({id:n});t.getFavoritesCollection().remove(i,{silent:!1}),i.destroy(),$(e.target).closest(".item").remove()},onEdit:function(e){var t=$(e.target).closest(".item")[0].id;this.$("#"+t).addClass("editing");var n=this;this.$("#"+t+" textarea").prop("disabled",!1).focus().blur(function(e){setTimeout(n.onNotEdited,500,e)}),this._isEditing=!0},onNotEdited:function(e){var n=$(e.target).closest(".item")[0].id,i=n.split("_")[1];this.$("#"+n).removeClass("editing"),this.$("#"+n+" textarea").prop("disabled",!0),this.$("#"+n+" textarea").val(t.getFavoritesCollection().findWhere({id:i}).get("title")),this._isEditing=!1},onEdited:function(e){var n=$(e.target).closest(".item")[0].id,i=n.split("_")[1];this.$("#"+n).removeClass("editing"),this.$("#"+n+" textarea").prop("disabled",!0);var s=t.getFavoritesCollection().findWhere({id:i});s.set("title",this.$("#"+n+" textarea").val()),s.save(),this._isEditing=!1},onShare:function(n){var i=$(n.target).closest(".shareBtn"),s=$(n.target).closest(".item")[0].id,o=s.split("_")[1],r=t.getFavoritesCollection().findWhere({id:o});i.hasClass("fb")?e.trigger("share:favorite","facebook",r):i.hasClass("tw")?e.trigger("share:favorite","twitter",r):i.hasClass("vk")&&e.trigger("share:favorite","vkontakte",r)}});return a}),define("bb.text!app/../../resources/tpl/favorites/FontSet.html",[],function(){return'<div class="pangrammeCrop">\n    {% if css %}\n    <div class="pangramme" {% if fontFace %} style="font-family:\'{{fontFace}}\',\'Arial Black\';" {% endif %} >{{pangramme|safe}}</div>\n    {% else %}\n        <img class="pangramme" />\n    {% endif %}\n</div>\n<div class="gradient"></div>\n\n<div class="hr"><div></div></div>\n\n<div class="topLine">\n    <span class="fullName">{{fullName}}</span>\n        <span class="match">{{match}}&nbsp;\n            {{ match|decline ("начертаний", "начертание", "начертания") }}\n            &nbsp;из&nbsp;{{subSets.length}}</span>\n        <span class="price"> от&nbsp;{{price}}&nbsp;&#x20B7;</span>\n</div>\n<div class="buttonLine">\n    <div class="remove icon-delete"></div>\n    <div class="toTypeTester icon-in_typetester {% if isInTypeTester %} selected {% endif %}"></div>\n    {% if isInBucket %}\n        <div class="toBucket selected"><span class="icon-check_big"></span>В корзине</div>\n    {% else %}\n        <div class="toBucket"><span class="icon-in_cart"></span>{{price}}&nbsp;&#x20B7;</div>\n    {% endif %}\n</div>\n'}),define("app/views/favorites/FontSetView",["backbone","app/views/fontlist/FontSetView","app/events/FaceModeEvent","app/events/DisplayModeEvent","bb.text!app/../../resources/tpl/favorites/FontSet.html"],function(e,t,n,i,s){var o=t.extend({events:{"click .remove":"onDeleteFavorite","click .toTypeTester":"toTypeTester","click .toBucket":"toBucket"},initialize:function(){this._template=s,t.prototype.initialize.call(this),this._nightMode=!1,this._displayMode=i.MODE_LINES},onDeleteFavorite:function(){this.trigger("delete",this)},setNightMode:function(){this._nightMode=!1},setDisplayMode:function(){this._displayMode=i.MODE_LINES,t.prototype.setDisplayMode.call(this,i.MODE_LINES)},render:function(){this._nightMode=!1,this._displayMode=i.MODE_LINES,t.prototype.render.call(this)}});return o}),define("bb.text!app/../../resources/tpl/favorites/FavoritesCollectionView.html",[],function(){return'<div class="favoritesTop">\r\n    <div class="collectionTitle">\r\n        <div class="back"><b class="icon-arrow_back"></b>Избранное:</div>{{ title }}</div>\r\n    <div class="share">\r\n        <div class="shareOpen icon-share"></div>\r\n        <div class="shareContent">\r\n            <div class="msg">\r\n                <div class="shareFolder">Поделиться папкой</div>\r\n            </div>\r\n            <div class="shareBtn fb icon-share_fb"></div>\r\n            <div class="shareBtn tw icon-share_twitter"></div>\r\n            <div class="shareBtn vk icon-share_vk"></div>\r\n            <div class="shareBtn link icon-share_link"></div>\r\n            <div class="shareClose icon-share_close"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="SwitchersPanelView bgWhite">\r\n    <div id="SwitcherPangrammeView"></div>\r\n    <div id="SwitcherSizeView"></div>\r\n</div>\r\n<div class="favoritesScrollHolder">\r\n<div class="favoritesContent">\r\n\r\n</div>\r\n</div>\r\n'}),define("app/views/favorites/FavoritesListView",["backbone","app/models/AppModel","app/views/favorites/FontSetView","app/views/switchers/SwitcherPangrammeView","app/views/switchers/SwitcherSizeView","nunjucks","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/favorites/FavoritesCollectionView.html","ZeroClipboard"],function(e,t,n,i,s,o,r,a,l){var c=e.View.extend({tagName:"div",className:"FavoritesListView",_views:[],events:{"click .back":"onTop","click .shareOpen":"shareOpen","click .shareClose":"shareClose","click .shareBtn":"onShare"},initialize:function(){_.bindAll(this,"render","onCloseSelector","invalidate","onTop"),this.swPangramme=new i,this.swSize=new s,this.render()},remove:function(){this.clipBoardClient&&(this.clipBoardClient.destroy(),this.clipBoardClient=null),e.View.prototype.remove.call(this)},render:function(){this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(a,this.model.toJSON())),this.$("#SwitcherPangrammeView").append(this.swPangramme.el),this.$("#SwitcherSizeView").append(this.swSize.el),_.each(this._views,function(e){e.remove()}),this._views=[];var e=document.createDocumentFragment();return this.model.fonts.each(function(t){var i=new n({model:t});e.appendChild(i.el),this._views.push(i),this.listenTo(i,"delete",this.onFontSetDelete)},this),this.$(".favoritesContent").append(e),this.$(".favoritesScrollHolder").mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$(".favoritesScrollHolder").mCustomScrollbar("update"),this.delegateEvents(),this.swPangramme.invalidate(),this.swSize.invalidate()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onTop:function(){this.trigger("favorites")},onSubmit:function(){},shareOpen:function(){this.$(".share").addClass("opened");var e=t.baseUrl+"/favorite/"+this.model.get("id"),n=this.$(".shareBtn.link");this.clipBoardClient=new l(n),this.clipBoardClient.on("dataRequested",function(t){t.setText(e)}),this.clipBoardClient.on("load",function(e){e.on("complete",function(){})})},shareClose:function(){this.clipBoardClient&&(this.clipBoardClient.destroy(),this.clipBoardClient=null),this.$(".share").removeClass("opened")},onFontSetDelete:function(e){this.model.fonts.remove(e.model),this.model.save(),e.remove(),this.invalidate()},onShare:function(t){var n=$(t.target).closest(".shareBtn");n.hasClass("fb")?e.trigger("share:favorite","facebook",this.model):n.hasClass("tw")?e.trigger("share:favorite","twitter",this.model):n.hasClass("vk")&&e.trigger("share:favorite","vkontakte",this.model)}});return c}),define("bb.text!app/../../resources/tpl/archive/ArchiveView.html",[],function(){return'<div class="archiveTop">\r\n    <div class="title">\r\n        Архив заказов\r\n    </div>\r\n</div>\r\n\r\n<div class="archiveScrollHolder">\r\n    <div class="archiveContent">\r\n        <div class="collections">\r\n            {% for order in archive %}\r\n                <div class="item" data-id="{{ order.id }}">\r\n                    {%for font in order.fonts %} {{font.fullName}}, {%endfor%}\r\n\r\n                    | ID:&nbsp;{{order.id}}\r\n                    | {{order.date|strftime("%D.%M.%y")}}\r\n                    | {{order.price|money(0)}}&nbsp;&#x20B7;\r\n                    | <span class="{% if order.paid %}icon-licence_paid{% else %}icon-licence_notpaid{%endif%}"></span>\r\n                </div>\r\n            {% endfor %}\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("app/views/archive/ArchiveView",["backbone","app/models/AppModel","app/models/BucketModel","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/archive/ArchiveView.html"],function(e,t,n,i,s){var o=e.View.extend({tagName:"div",className:"ArchiveView",events:{"click .item":"onItem"},initialize:function(){_.bindAll(this,"render","invalidate"),this.listenTo(t.getArchiveCollection(),"all",this.render),this.listenTo(t.getArchiveCollection(),"change",this.render),this.render()},remove:function(){e.View.prototype.remove.call(this)},render:function(){return this.$el.attr("id",this.cid),console.log(t.getArchiveCollection().toJSON()),this.$el.html(t.nunjucks.renderString(s,{archive:t.getArchiveCollection().toJSON()})),this.$(".archiveScrollHolder").mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$(".archiveScrollHolder").mCustomScrollbar("update"),this.delegateEvents()},onItem:function(e){var n=String($(e.target).closest(".item").data("id")),i=t.getArchiveCollection().findWhere({id:n});this.trigger("archive",i)}});return o}),define("bb.text!app/../../resources/tpl/archive/FontSet.html",[],function(){return'\n{% macro expandable(licence) %}\n    <div class="extendedLicences">\n        <div class="licence"><b></b>{{licence.expands}}</div>\n        <div class="licenceList">\n        {% for sublicence in licenceList %}\n            {% if sublicence.extends and sublicence.extends == licence.id and not licences[sublicence.id] %}\n                <div class="licence" id="{{sublicence.id}}">{{sublicence.title}}</div>\n            {% endif %}\n        {% endfor %}\n        </div>\n    </div>\n{% endmacro %}\n\n\n\n<div class="topLine">\n    <div class="tr {% if subSets %} border {%endif%}">\n        <div class="td left">\n            {% if subSets %}<div class="icon icon-fontpack">&nbsp;</div>{% endif %}\n            <div class="fullName">{{fullName}}</div>\n        </div>\n    </div>\n</div>\n\n\n<div class="licences">\n    {{ licences.length }}\n    {% for id, licence in licences %}\n    <div class="tb">\n        <div class="tr licence">\n            <div class="td left name">\n                {{licence.title}}\n            </div>\n            {% for param in licence.parameters %}\n                    <div class="td middle">\n                        {% if param.type == "number" %}\n                            {% if paid %}<span class="icon-edit"></span>{%endif%}<span class="label">{{ param.value }}&nbsp;{{ param.value|decline( param.title ) }}</span>\n                        {% endif %}\n\n                        {% if param.type == "select" %}\n                        {% if paid %}<span class="icon-edit"></span>{%endif%}<div class="label"> {% if param.id == "lang" %}{{languages[param.value].name}}{% else %}{{ param.options[param.value].title }}{% endif %}</div>\n                        {% endif %}\n                    </div>\n\n            {% endfor %}\n            {% if paid %}\n                <div class="td right">\n                    <a class="licenece" href="{{licenceURL}}"><div class="icon-licence_pay"></div></a>\n                </div>\n                <div class="td right">\n                    <a class="archive"  href="{{archiveURL}}"><div class="icon-licence_download"></div></a>\n                </div>\n            {%else%}\n                <div class="td right">\n                    <div class="price">{{price|money(0)}}&nbsp;&#x20B7;</div>\n                </div>\n            {%endif%}\n        </div>\n    </div>\n    {% endfor %}\n</div>\n{% if paid %}\n<div class="licenceList">\n    {% for licence in licenceList %}\n        {% if not licence.extends and not licences[licence.id] %}\n            <div class="licence" id="{{licence.id}}">{{licence.title}}</div>\n        {% endif %}\n    {% endfor %}\n\n    <!-- для открытия добавить класс opened -->\n    {% for licence in licenceList %}\n        {% if licence.expands %}\n            {{ expandable(licence) }}\n        {% endif %}\n    {% endfor %}\n\n</div>\n<div class="bottomline">\n    <div class="addLicence open"><div class="icon">&nbsp;</div><span class="label open">Добавить лицензию</span><span class="label close">Отменить</span></div>\n</div>\n{% endif %}\n'}),define("app/views/archive/ArchiveFontSetView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/archive/FontSet.html","jq.numeric"],function(e,t,n){var i=e.View.extend({tagName:"div",className:"BucketFontSetView",events:{"mouseover .topLine .delete":"onOverDelete","mouseout .topLine .delete":"onOutDelete","click .topLine .delete":"onDelete","click .openSubSets":"onOpenSubSets","click .addLicence":"onAddLicence","click .licenceList .licence":"onLicence","click .delete":"onLicenceDelete","mouseover .licence .delete":"onOverLicDelete","mouseout .licence .delete":"onOutLicDelete","click .select .option":"onOption","change input[type=text]":"onChange","click .extendedLicences":"onOpenExtended"},initialize:function(){_.bindAll(this,"render","onOverDelete","onAddLicence","onLicence"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(n,_.extend(this.model.toJSON(),{licenceList:t.getLicenceList()}))),this.$("input").numeric(),this.trigger("invalidate"),this},onOverDelete:function(){this.$(".topLine").addClass("over")},onOutDelete:function(){this.$(".topLine").removeClass("over")},onDelete:function(){this.trigger("Bucket:FontSet:delete",this)},onOpenSubSets:function(){var e=this.$(".subsets"),t=this.$(".openSubSets .tri");"none"===e.css("display")?(e.show(),t.removeClass("down"),t.addClass("up")):(e.hide(),t.removeClass("up"),t.addClass("down")),this.trigger("invalidate")},onAddLicence:function(){var e=this.$(".addLicence"),t=this.$(".licenceList");"none"===t.css("display")?(t.show(),e.removeClass("open"),e.addClass("close")):(t.hide(),e.removeClass("close"),e.addClass("open")),this.trigger("invalidate")},onLicence:function(e){if(e.target.id){var n=_.findWhere(t.getLicenceList(),{id:e.target.id});if(n){if(n.extends&&!this.model.get("licences")[n.extends]){var i=_.findWhere(t.getLicenceList(),{id:n.extends});this.model.get("licences")[n.extends]=_.clone(i)}this.model.get("licences")[n.id]=_.clone(n),this.onAddLicence(e),this.render()}}},onLicenceDelete:function(e){var t=e.target.id.split(":")[0],n=_.where(this.model.get("licences"),{"extends":t});_.each(n,function(e){delete this.model.get("licences")[e.id]},this),delete this.model.get("licences")[t],this.render()},onOpenExtended:function(e){$(e.target).closest(".extendedLicences").toggleClass("opened")},onOverLicDelete:function(e){$(e.target).parent().parent().addClass("over")},onOutLicDelete:function(e){$(e.target).parent().parent().removeClass("over")},onOption:function(e){var t=e.target.id.split(":"),n=this.model.get("licences")[t[0]],i=_.findWhere(n.parameters,{id:t[1]}),s=t[2];i.value=s,this.render()},onChange:function(e){var t=e.target.id.split(":"),n=this.model.get("licences")[t[0]],i=_.findWhere(n.parameters,{id:t[1]});i.value=parseInt(e.target.value,10),this.render()}});return i}),define("bb.text!app/../../resources/tpl/archive/ArchiveItemView.html",[],function(){return'<div class="archiveTop">\r\n    <div class="collectionTitle">\r\n        <div class="back"><b class="icon-arrow_back"></b>Архив заказов:</div> {%for font in fonts %} {{font.fullName}}, {%endfor%} </div>\r\n</div>\r\n<span class="button edit">чтоб редактировать заказ верните его в корзину</span>\r\n<span><span class="icon-mailto"></span>Уже оплатили? <a href="mailto:bla@bla.com?Subject=check#{{id}}&body=Дорогая редакция...">Сообщите нам</a></span>\r\n<span class="button remove"><span class="icon-delete"></span>Удалить заказ</span>\r\n\r\n<br/>\r\n<style>\r\n    table{\r\n        width: 100%;\r\n    }\r\n    td{\r\n        border: solid 1px black;\r\n    }\r\n</style>\r\n<table><tr>\r\n        <td>\r\n            <div>Заказ&nbsp;{{id}}</div>\r\n            <div>{{date|strftime("%d %B %Y")}}</div>\r\n        </td>\r\n        <td>\r\n            <div>Лицензиат: {{licencee}}</div>\r\n            <div>Плательщик: {{payer}}</div>\r\n        </td>\r\n        <td>\r\n            {% if paid %}\r\n                <span class="icon-licence_paid"></span> {{price|money(0)}}&nbsp;&#x20B7;\r\n                <div>Оплачен ({{paymentType}})</div>\r\n            {% else %}\r\n                <span class="icon-licence_notpaid"></span> {{price|money(0)}}\r\n                <div>Не оплачен ({{paymentType}})</div>\r\n            {% endif %}\r\n        </td>\r\n        <td>\r\n            <a href="{{invoice}}">\r\n                <div class="icon-licence_pay"></div>\r\n                Счет\r\n            </a>\r\n        </td>\r\n</tr></table>\r\n\r\n<div class="archiveScrollHolder">\r\n<div class="archiveContent">\r\n\r\n</div>\r\n</div>\r\n'}),define("app/views/archive/ArchiveItemView",["backbone","app/models/AppModel","app/models/BucketModel","app/views/archive/ArchiveFontSetView","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/archive/ArchiveItemView.html"],function(e,t,n,i,s,o){var r=e.View.extend({tagName:"div",className:"BucketView",_views:[],events:{"click .back":"onTop","click .selector":"onClickSelector","click .priceButton":"onSubmit"},initialize:function(){_.bindAll(this,"render","onCloseSelector","invalidate"),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(o,this.model.toJSON())),_.each(this._views,function(e){e.remove()}),this._views=[];var e=document.createDocumentFragment();return this.model.fonts.each(function(t){t.set("paid",this.model.get("paid"));var n=new i({model:t});e.appendChild(n.el),this._views.push(n),this.listenTo(n,"delete",this.onFontSetDelete)},this),this.$(".archiveContent").append(e),this.$(".archiveScrollHolder").mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$(".archiveScrollHolder").mCustomScrollbar("update"),this.delegateEvents()},onFontSetDelete:function(e){e.model.set("isInBucket",!1),this.render()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onSubmit:function(){this.trigger("payment")},onTop:function(){this.trigger("archive")}});return r}),define("bb.text!app/../../resources/tpl/rightpanel/RightPanel.html",[],function(){return'<div class="shadow">&nbsp;</div>\n<div class="VerticalTabs">\n    <div class="tab enter"><b class="icon-login"></b><span>Войти</span></div>\n    <div class="tab exit"><b class="icon-close"></b></div>\n    <div class="tab personal">RK</div>\n    <div class="tab favorite"><b class="icon-favorites"></b></div>\n    <div class="tab bucket"><b class="icon-cart"></b></div>\n    <div class="tab archive"><b class="icon-archive"></b></div>\n</div>\n<div class="content">\n</div>\n'}),define("app/views/rightpanel/RightPanelView",["backbone","app/models/AppModel","app/collections/FavoritesCollection","app/views/bucket/BucketView","app/views/bucket/PaymentView","app/views/profile/ProfileView","app/views/favorites/FavoritesView","app/views/favorites/FavoritesListView","app/views/archive/ArchiveView","app/views/archive/ArchiveItemView","app/collections/FontSetCollection","app/models/BucketModel","app/models/FontSetModel","bb.text!app/../../resources/tpl/rightpanel/RightPanel.html"],function(e,t,n,i,s,o,r,a,l,c,d,u,h,p){var f=e.View.extend({tagName:"div",className:"RightPanelView",_bucketView:null,_paymentView:null,_profileView:null,_favoritesView:null,_favoritesListView:null,_archiveView:null,_archiveItemView:null,events:{"click .selector":"onClickSelector","click .tab.exit":"onExit","click .tab.bucket":"onOpenBucket","click .tab.personal":"onOpenProfile","click .tab.favorite":"onOpenFavorites","click .tab.archive":"onOpenArchive"},initialize:function(){_.bindAll(this,"render","onCloseSelector","onExit","onOpenBucket","onOpenProfile","destroyContent"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(p)),this.delegateEvents(this.events),this},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onExit:function(){this.$el.removeClass("opened"),this.$(".tab").removeClass("active"),this.destroyContent()},onOpenFavorites:function(){e.trigger("close:promo"),this.$el.addClass("opened"),this.makeFavorites()},onOpenArchive:function(){e.trigger("close:promo"),this.$el.addClass("opened"),this.makeArchive()},onOpenFavoritesList:function(t){e.trigger("close:promo"),this.$el.addClass("opened"),this.makeFavoritesList(t)},onOpenArchiveItem:function(t){e.trigger("close:promo"),this.$el.addClass("opened"),this.makeArchiveItem(t)},onOpenProfile:function(){e.trigger("close:promo"),this.$el.addClass("opened"),this.makeProfile()},onOpenBucket:function(){e.trigger("close:promo"),this.$el.addClass("opened"),this.makeBucket()},destroyContent:function(){this.$(".content").first().empty()},makeFavorites:function(){this.$(".tab").removeClass("active"),this.$(".tab.favorite").addClass("active"),this._favoritesView||(this._favoritesView=new r({}),this.listenTo(this._favoritesView,"favorite",this.makeFavoritesList)),this.$(".content").first().empty(),this.$(".content").append(this._favoritesView.el),this._favoritesView.invalidate()},makeArchive:function(){this.$(".tab").removeClass("active"),this.$(".tab.archive").addClass("active"),this._archiveView||(this._archiveView=new l({}),this.listenTo(this._archiveView,"archive",this.makeArchiveItem)),this.$(".content").first().empty(),this.$(".content").append(this._archiveView.el),this._archiveView.invalidate()},makeProfile:function(){this.$(".tab").removeClass("active"),this.$(".tab.personal").addClass("active"),this._profileView||(this._profileView=new o({})),this.$(".content").first().empty(),this.$(".content").append(this._profileView.el),this._profileView.invalidate()},makeBucket:function(){this.$(".tab").removeClass("active"),this.$(".tab.bucket").addClass("active"),this._bucketView||(this._bucketView=new i({model:t.getBucketModel()}),this.listenTo(this._bucketView,"payment",this.makePayment)),this.$(".content").first().empty(),this.$(".content").append(this._bucketView.el),this._bucketView.invalidate()},makePayment:function(){this.$(".tab").removeClass("active"),this.$(".tab.bucket").addClass("active"),this._paymentView||(this._paymentView=new s({model:t.getBucketModel()}),this.listenTo(this._paymentView,"bucket",this.makeBucket)),this.$(".content").first().empty(),this.$(".content").append(this._paymentView.el),this._paymentView.invalidate()},makeFavoritesList:function(e){this.$(".tab").removeClass("active"),this.$(".tab.favorite").addClass("active"),this._favoritesListView=new a({model:e}),this.listenTo(this._favoritesListView,"favorites",this.makeFavorites),this.$(".content").first().empty(),this.$(".content").append(this._favoritesListView.el),this._favoritesListView.invalidate()
},makeArchiveItem:function(e){this.$(".tab").removeClass("active"),this.$(".tab.archive").addClass("active"),this._archiveItemView=new c({model:e}),this.listenTo(this._archiveItemView,"archive",this.makeArchive),this.$(".content").first().empty(),this.$(".content").append(this._archiveItemView.el),this._archiveItemView.invalidate()}});return f}),define("bb.text!app/../../resources/tpl/tagpanel/TagPanel.html",[],function(){return'<div class="tr">\n\n    <div class="td tags">\n        <div class="tag webfont">\n            <div class="toggler">\n                <div class="toggle"></div>\n            </div>\n            <div class="label">Только веб-шрифты</div>\n        </div>\n        {% for filter in filters %}\n        {% if filter.label %}\n        <div class="tag" id="{{filter.name}}"> {% if filter.type == "number" or filter.type == "range" %}<span class="icon icon-interval"></span>{% endif %}{{filter.label}}<div id="{{filter.name}}" class="icon-delete_tag cross">&nbsp;</div></div>\n        {% endif %}\n        {% endfor %}\n        {% if filters.length > 0 %}<div id="::delete::" class="button icon-delete_all_tags tag delete"></div>{% endif %}\n    </div>\n\n    <div class="td copy">\n        <div  class="counter"><span class="icon icon-fontpack"></span>{{ total }}&nbsp;{{ total|decline ("шрифтов", "шрифт", "шрифта") }}</div>\n        <div class="button tri tag copy"><div class="icon icon-link_to_list"></div><span class="label">Ссылка на эту подборку</span></div>\n    </div>\n\n</div>\n'}),define("app/views/tagpanel/TagPanelView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/tagpanel/TagPanel.html","app/events/FilterEvent","ZeroClipboard"],function(e,t,n,i,s){var o="Ссылка на эту подборку",r="Ссылка скопирована",a=e.View.extend({tagName:"div",className:"TagPanelView",_buttonCopy:null,_filters:null,_allCount:0,events:{"click .tag:not(.webfont)":"onClickTag","click .webfont":"onClickWebfont"},_webFont:null,initialize:function(){_.bindAll(this,"render","onFilterEvent","onClickTag","onClickWebfont"),this.listenTo(e,i.ADD,this.onFilterEvent),this.listenTo(e,i.DEL,this.onFilterEvent),this._filters=t.getFilters(),this._filters.on("change",this.render),this.render()},render:function(){if(this.$el.attr("id",this.cid),0===this._filters.reject(function(e){return"typefaces"===e.get("name")||"webfonts"===e.get("name")}).length)return e.trigger("close:tagpanel"),void this.$el.hide();e.trigger("open:tagpanel"),this.$el.show();var i=this._filters.toJSON(),a=_.findWhere(i,{name:"webfonts"});this.$el.html(t.nunjucks.renderString(n,{filters:i,total:this._allCount})),this._buttonCopy=this.$(".button.copy"),s.config({moviePath:"resources/images/ZeroClipboard.swf",hoverClass:"hover"});var l=new s(this._buttonCopy);l.on("dataRequested",function(e){e.setText(document.location.href)});var c=this;return l.on("load",function(e){e.on("complete",function(){c._buttonCopy.find(".label").text(r),setTimeout(function(){c._buttonCopy.find(".label").text(o)},2e3)})}),this._webFont=this.$(".webfont"),a&&(this._webFont.addClass("selected"),i=_.without(i,a)),this},setAllCount:function(e){this._allCount=e,this.render()},onClickWebfont:function(){this._webFont.hasClass("selected")?(this._webFont.removeClass("selected"),e.trigger(i.DEL,"webfonts")):(this._webFont.addClass("selected"),e.trigger(i.ADD,{name:"webfonts"}))},onClickTag:function(t){"::delete::"===t.target.id||"::delete::"===t.target.parentNode.id?e.trigger(i.DEL):e.trigger(i.DEL,t.target.id)},onFilterEvent:function(){this.render()}});return a}),define("bb.text!app/../../resources/tpl/typetester/TextBlock.html",[],function(){return'<div class="top" style="background-color:{{color}}">\n    <div class="moveBtn icon-move_block" data-hover="#FF0000"></div>\n    <div class="deleteBtn icon-delete_block" data-hover="#FF0000"></div>\n</div>\n<div class="resize" style="background-color:{{color}}"></div>\n<div class="text">{{text|safe}}</div>\n<div class="submitBtn"></div>\n<textarea spellcheck="false">{{text|safe}}</textarea>\n'}),define("app/views/typetester/TextblockView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/typetester/TextBlock.html"],function(e,t,n){function i(e){return e=e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}),"-"==e.charAt(0)?e.substr(1):e}function s(e){var t={},n=[];_.each(e.attributes,function(e,s){switch(s){case"text":case"height":case"backgroundColor":break;case"font":e&&(t["font-family"]=e.get("fontFace"));break;case"liga":case"dlig":case"calt":case"smcp":case"onum":n.push('"'+s+'"='+(e?"1":"0"));break;case"top":case"left":case"width":t[s]=String(Math.floor(e))+"px";break;case"fontSize":case"letterSpacing":case"lineHeight":t[i(s)]=String(Math.floor(e))+"px";break;case"textAlign":t[i(s)]=e;break;case"columnCount":t["-webkit-column-count"]=String(e),t["-moz-column-count"]=String(e),t["--ms-column-count"]=String(e),t["-o-column-count"]=String(e),t["column-count"]=String(e);break;case"columnGap":t["-webkit-column-gap"]=String(Math.floor(e))+"px",t["-moz-column-gap"]=String(Math.floor(e))+"px",t["--ms-column-gap"]=String(Math.floor(e))+"px",t["-o-column-gap"]=String(Math.floor(e))+"px",t["column-gap"]=String(Math.floor(e))+"px";break;default:t[s]=String(e)}});var s=n.join(","),o=s.split("=").join(" ");return s=s.split('"').join(""),n.length>0&&(t["-webkit-font-feature-settings"]=o,t["-moz-font-feature-settings"]=s,t["-ms-font-feature-settings"]=o,t["-o-font-feature-settings"]=o,t["font-feature-settings"]=o),t}function o(e){e&&e.get("css")&&$("head link#tester_"+e.get("fontFace").split(" ").join("_")).remove()}function r(e){if(e&&e.get("css")){var t=$("head link#tester_"+e.get("fontFace"));0===t.length&&$("head").append(["<link id='tester_",e.get("fontFace").split(" ").join("_"),"' type='text/css' rel='stylesheet' href='",e.get("css"),"' />"].join(""))}}var a=e.View.extend({tagName:"div",className:"TextBlock",style:null,_isActive:!1,_isEditing:!1,_isMoving:!1,events:{mouseup:"onSelect","mousedown .moveBtn":"onStartDrag","mousedown .resize":"onStartResize","click .deleteBtn":"onRemove","blur textarea":"onEdited"},initialize:function(e){_.bindAll(this,"render","invalidate","onSelect","onStartDrag","onDrag","onStopDrag","onResize","onStopResize","onRemove","onDeselect","updateText","onEdited"),this.style=e.style,this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(n,{text:this.model.get("text"),color:this.model.get("color")})),r(this.model.get("font")),this.$el.css(s(this.model)),this.$("textarea").css(s(this.model)),this.$el.css("border-color",this.model.get("color")),this.delegateEvents(),this.$(".top").css("color",this.model.get("backgroundColor")),this},remove:function(){o(this.model.get("font")),e.View.prototype.remove.call(this)},invalidate:function(){this.model.set("height",this.$el.height(),{silent:!0})},onDeselect:function(){this._isActive&&(this._isActive=!1,this.onEdited(),this.$el.removeClass("active"))},onSelect:function(e){this._isMoving||($(e.target).hasClass("text")&&this.$el.hasClass("active")?(this._isEditing=!0,this.$("textarea").val(this.$(".text").text()),this.$el.addClass("edit"),this.$("textarea").focus()):this._isActive||(this._isActive=!0,this.$(".resize").css({top:Math.floor(this.$el.height()+23),left:Math.floor(this.$el.width()+32)}),this.$el.addClass("active"),this.trigger("TextblockView:select",this)),this._isActive&&e.stopPropagation())},onEdited:function(){this._isEditing=!1,this.updateText(),this.$el.removeClass("edit")},onStartDrag:function(e){this._isMoving=!0,this._drgH=this.$el.outerHeight(),this._drgW=this.$el.outerWidth(),this._posY=this.$el.offset().top-e.pageY,this._posX=this.$el.offset().left-e.pageX,$("body").on("mousemove",this.onDrag),$("body").on("mouseup",this.onStopDrag),e.preventDefault()},onDrag:function(e){this.$el.offset({top:Math.floor(e.pageY+this._posY),left:Math.floor(e.pageX+this._posX)})},onStopDrag:function(){this._isMoving=!1,this.model.set({left:parseInt(this.$el.css("left"),10),top:parseInt(this.$el.css("top"),10)},{silent:!0}),$("body").off("mousemove",this.onDrag),$("body").off("mouseup",this.onStopDrag)},onStartResize:function(e){this._isMoving=!0,$("body").on("mousemove",this.onResize),$("body").on("mouseup",this.onStopResize),e.preventDefault()},onResize:function(e){this.$el.css({width:Math.max(200,Math.floor(e.pageX-this.$el.offset().left)+7)}),this.$(".resize").css({top:Math.floor(this.$el.height()+23),left:Math.floor(this.$el.width()+32)})},onStopResize:function(){this._isMoving=!1,$("body").off("mousemove",this.onResize),$("body").off("mouseup",this.onSropResize),this.model.set({width:parseInt(this.$el.css("width"),10),height:this.$el.height()},{silent:!0})},onRemove:function(){this.trigger("TextblockView:remove",this)},updateText:function(){this.model.set("text",this.$("textarea").val())}});return a}),define("app/views/typetester/TextblockModel",["backbone"],function(e){var t=e.Model.extend({defaults:{fontSize:16,lineHeight:16,letterSpacing:0,textAlign:"left",color:"#000000",backgroundColor:"#FFFFFF",columnCount:1,columnGap:50,liga:!1,dlig:!1,calt:!1,smcp:!1,onum:!1,ss:1,text:"",font:null},initialize:function(){this.font&&this.listenTo(this.font,"change",function(){this.trigger("font:change")})},set:function(t,n){t.font&&this.listenTo(t.font,"change",function(){this.trigger("change")}),e.Model.prototype.set.call(this,t,n)}});return t}),define("bb.text!app/../../resources/tpl/typetester/FontUsed.html",[],function(){return'<div class="fontsUsed">\n    <div class="title">\n        на странице использованы шрифты\n    </div>\n    <ul>\n        {% for font in fonts %}\n        <li data-id="{{font.id}}">\n            <div class="btns">\n                <div class="buyBtn {% if font.isInBucket %}active{% endif %}"><b></b></div>\n                <div class="favBtn {% if font.isFavorite %}active{% endif %}"><b></b></div>\n            </div>\n            {{ font.fullName }}\n        </li>\n        {% endfor %}\n    </ul>\n</div>\n'}),define("app/views/typetester/FontListView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/typetester/FontUsed.html"],function(e,t,n){var i=e.View.extend({tagName:"div",className:"FontListView",events:{"click .buyBtn":"toBucket","click .favBtn":"toFavorites"},initialize:function(){_.bindAll(this,"render","toFavorites","toBucket"),this.listenTo(this.model,"add",this.render),this.listenTo(this.model,"remove",this.render),this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(n,{fonts:this.model.toJSON()}))},toFavorites:function(t){var n=$(t.target).closest("li").attr("data-id"),i=this.model.findWhere({id:n});e.trigger("open:favoritesMenu",i,{x:t.pageX,y:t.pageY})},toBucket:function(e){var t=$(e.target).closest("li").attr("data-id"),n=this.model.findWhere({id:t});n.set("isInBucket",!n.get("isInBucket"))}});return i}),define("bb.text!app/../../resources/tpl/typetester/FontSelected.html",[],function(){return'<div class="control">\n    <div class="widget textOptions">\n        <div class="sliderBox" id="typetster:fontSize" data-from="10" data-to="99">\n            <div class="icon fontSize icon-fontsize"></div>\n            <input type="text" value="{{ fontSize }}" maxlength="2"/>\n            <div class="slider"></div>\n        </div>\n        <div class="sliderBox" id="typetster:lineHeight" data-from="10" data-to="99">\n            <div class="icon lineHeight icon-line_height"></div>\n            <input type="text" value="{{ lineHeight }}" maxlength="2"/>\n            <div class="slider"></div>\n        </div>\n        <div class="sliderBox" id="typetster:letterSpacing" data-from="0" data-to="9">\n            <div class="icon letterSpacing icon-tracking"></div>\n            <input type="text" value="{{ letterSpacing }}" maxlength="1"/>\n            <div class="slider"></div>\n        </div>\n    </div>\n\n    <div class="widget textAlign">\n        <div class="left icon-align_left {% if textAlign == \'left\' %} active{% endif %}"></div>\n        <div class="center icon-aligh_center {% if textAlign == \'center\' %} active{% endif %}"></div>\n        <div class="right icon-align_right {% if textAlign == \'right\' %} active{% endif %}"></div>\n        <div class="justify icon-align_just {% if textAlign == \'justify\' %} active{% endif %}"></div>\n    </div>\n\n    <div>\n        <div class="widget columnCount">\n            <div class="icon icon-column_count"></div>\n            <div class="clicker">\n                <input  id="typetster:columnCount" type="text" value="{{columnCount}}" min="1" max="5" maxlength="1"/>\n                <div class="clickerUp icon-littlearrow_up"></div>\n                <div class="clickerDown icon-littlearrow_down"></div>\n            </div>\n        </div>\n        <div class="widget columnGap">\n            <div class="sliderBox" id="typetster:columnGap" data-from="0" data-to="99">\n            <div class="icon icon-column_gutter"></div>\n            <input type="text" value="{{ columnGap }}"  maxlength="2"/>\n            <div class="slider"></div>\n        </div>\n    </div>\n\n    <!-- добавляется класс opened -->\n    <div class="widget types">\n        <div class="typesMain">\n            <div class="liga icon-opentype_ligutures {% if liga %} active{% endif %}"></div>\n            <div class="dlig icon-opentype_ligatures2 {% if dlig %} active{% endif %}"></div>\n            <div class="calt icon-opentype_alternates {% if calt %} active{% endif %}"></div>\n            <div class="smcp icon-opentype_caps {% if smcp %} active{% endif %}"></div>\n            <div class="onum icon-opentype_lowercase {% if onum %} active{% endif %}"></div>\n            <div class="ss icon-ss"></div>\n        </div>\n        <div class="typesAlerts">\n            <div class="ligaAlert icon-opentype_alert_tip"></div>\n            <div class="dligAlert icon-opentype_alert_tip"></div>\n            <div class="caltAlert icon-opentype_alert_tip"></div>\n            <div class="smcpAlert icon-opentype_alert_tip"></div>\n            <div class="onumAlert icon-opentype_alert_tip"></div>\n            <div class="ssAlert icon-opentype_alert_tip"></div>\n        </div>\n        <div class="typesSub">\n            <div class="ss1 icon-ss1"></div>\n            <div class="ss2 icon-ss2"></div>\n            <div class="ss3 icon-ss3"></div>\n            <div class="ss4 icon-ss4"></div>\n            <div class="ss5 icon-ss5"></div>\n            <b></b>\n        </div>\n    </div>\n    <div class="colors">\n        <div class="colorPicker">\n            <div class="colorSaturation"><div></div><b></b></div>\n            <div class="colorRange"><div></div><b></b></div>\n            <div class="hex">\n                #<input type="text" maxlength="6" value="224560"/>\n            </div>\n            <div class="rgb">\n                R<input type="text" maxlength="3" value="197"/>\n                G<input type="text" maxlength="3" value="155"/>\n                B<input type="text" maxlength="3" value="155"/>\n            </div>\n            <div class="colorSelected"><div></div></div>\n        </div>\n        <div class="bgColor" style="background-color:{{bgColor}}"></div>\n        <div class="fontColor" style="background-color:{{color}}"></div>\n    </div>\n</div>\n'}),define("lib/amd.colorpicker",[],function(){function e(e){if(window.event&&void 0!==window.event.contentOverflow)return{x:window.event.offsetX,y:window.event.offsetY};if(void 0!==e.offsetX&&void 0!==e.offsetY)return{x:e.offsetX,y:e.offsetY};var t=e.target.parentNode.parentNode;return{x:e.layerX-t.offsetLeft,y:e.layerY-t.offsetTop}}function t(e,t,n){e=document.createElementNS(f,e);for(var i in t)e.setAttribute(i,t[i]);"[object Array]"!=Object.prototype.toString.call(n)&&(n=[n]);for(var s=0,o=n[0]&&n.length||0;o>s;s++)e.appendChild(n[s]);return e}function n(e){var t,n,i,s,o,r=e.h%360/60;o=e.v*e.s,s=o*(1-Math.abs(r%2-1)),t=n=i=e.v-o,r=~~r,t+=[o,s,0,0,s,o][r],n+=[s,o,o,s,0,0][r],i+=[0,0,s,o,o,s][r];var a=Math.floor(255*t),l=Math.floor(255*n),c=Math.floor(255*i);return{r:a,g:l,b:c,hex:"#"+(16777216|c|l<<8|a<<16).toString(16).slice(1)}}function i(e){var t=e.r,n=e.g,i=e.b;(e.r>1||e.g>1||e.b>1)&&(t/=255,n/=255,i/=255);var s,o,r,a;return r=Math.max(t,n,i),a=r-Math.min(t,n,i),s=0==a?null:r==t?(n-i)/a+(i>n?6:0):r==n?(i-t)/a+2:(t-n)/a+4,s=s%6*60,o=0==a?0:a/r,{h:s,s:o,v:r}}function s(t,i,s){return function(o){o=o||window.event;var r=e(o);t.h=r.y/i.offsetHeight*360+p;var a=n({h:t.h,s:1,v:1}),l=n({h:t.h,s:t.s,v:t.v});s.style.backgroundColor=a.hex,t.callback&&t.callback(l.hex,{h:t.h-p,s:t.s,v:t.v},{r:l.r,g:l.g,b:l.b},void 0,r)}}function o(t,i){return function(s){s=s||window.event;var o=e(s),r=i.offsetWidth,a=i.offsetHeight;t.s=o.x/r,t.v=(a-o.y)/a;var l=n(t);t.callback&&t.callback(l.hex,{h:t.h-p,s:t.s,v:t.v},{r:l.r,g:l.g,b:l.b},o)}}function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);if(this.h=0,this.s=1,this.v=1,n)this.callback=n,this.pickerElement=t,this.slideElement=e;else{var i=e;i.innerHTML=v,this.slideElement=i.getElementsByClassName("slide")[0],this.pickerElement=i.getElementsByClassName("picker")[0];var c=i.getElementsByClassName("slide-indicator")[0],p=i.getElementsByClassName("picker-indicator")[0];r.fixIndicators(c,p),this.callback=function(e,n,i,s,o){r.positionIndicators(c,p,o,s),t(e,n,i)}}if("SVG"==h){var f=u.cloneNode(!0),g=d.cloneNode(!0),b=f.getElementById("gradient-hsv"),y=f.getElementsByTagName("rect")[0];b.id="gradient-hsv-"+m,y.setAttribute("fill","url(#"+b.id+")");var w=[g.getElementById("gradient-black"),g.getElementById("gradient-white")],_=g.getElementsByTagName("rect");w[0].id="gradient-black-"+m,w[1].id="gradient-white-"+m,_[0].setAttribute("fill","url(#"+w[1].id+")"),_[1].setAttribute("fill","url(#"+w[0].id+")"),this.slideElement.appendChild(f),this.pickerElement.appendChild(g),m++}else this.slideElement.innerHTML=u,this.pickerElement.innerHTML=d;a(this.slideElement,"click",s(this,this.slideElement,this.pickerElement)),a(this.pickerElement,"click",o(this,this.pickerElement)),l(this,this.slideElement,s(this,this.slideElement,this.pickerElement)),l(this,this.pickerElement,o(this,this.pickerElement))}function a(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,!1)}function l(e,t,n){var i=!1;a(t,"mousedown",function(){i=!0}),a(t,"mouseup",function(){i=!1}),a(t,"mouseout",function(){i=!1}),a(t,"mousemove",function(e){i&&n(e)})}function c(e,t,i,s){e.h=t.h%360,e.s=t.s,e.v=t.v;var o=n(e),r={y:e.h*e.slideElement.offsetHeight/360,x:0},a=e.pickerElement.offsetHeight,l={x:e.s*e.pickerElement.offsetWidth,y:a-e.v*a};return e.pickerElement.style.backgroundColor=n({h:e.h,s:1,v:1}).hex,e.callback&&e.callback(s||o.hex,{h:e.h,s:e.s,v:e.v},i||{r:o.r,g:o.g,b:o.b},l,r),e}var d,u,h=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",p=15,f="http://www.w3.org/2000/svg",v=['<div class="picker-wrapper">','<div class="picker"></div>','<div class="picker-indicator"></div>',"</div>",'<div class="slide-wrapper">','<div class="slide"></div>','<div class="slide-indicator"></div>',"</div>"].join("");"SVG"==h?(u=t("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[t("defs",{},t("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[t("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),t("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),t("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),t("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),t("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),t("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),t("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),t("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),t("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),t("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),d=t("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[t("defs",{},[t("linearGradient",{id:"gradient-black",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[t("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),t("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),t("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[t("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),t("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),t("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),t("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-black)"})])):"VML"==h&&(u=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>',"</v:rect>","</DIV>"].join(""),d=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>',"</v:rect>",'<v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>',"</v:rect>","</DIV>"].join(""),document.namespaces.v||document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"));var m=0;return r.hsv2rgb=function(e){var t=n(e);return delete t.hex,t},r.hsv2hex=function(e){return n(e).hex},r.rgb2hsv=i,r.rgb2hex=function(e){return n(i(e)).hex},r.hex2hsv=function(e){return i(r.hex2rgb(e))},r.hex2rgb=function(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16)}},r.prototype.setHsv=function(e){return c(this,e)},r.prototype.setRgb=function(e){return c(this,i(e),e)},r.prototype.setHex=function(e){return c(this,r.hex2hsv(e),void 0,e)},r.positionIndicators=function(e,t,n,i){n&&(e.style.top=n.y-e.offsetHeight/2+"px"),i&&(t.style.top=i.y-t.offsetHeight/2+"px",t.style.left=i.x-t.offsetWidth/2+"px")},r.fixIndicators=function(e,t){t.style.pointerEvents="none",e.style.pointerEvents="none"},r}),function(e){function t(t){t=e.extend({},d,t||{});for(var i=e(this),s=0,o=i.length;o>s;s++)n(i.eq(s),t);return i}function n(t,n){if(!t.hasClass("stepper-input")){n=e.extend({},n,t.data("stepper-options")),t.numeric();var s=parseFloat(t.attr("min")),o=parseFloat(t.attr("max")),r=parseFloat(t.attr("step"))||1,a=e.extend({$input:t,min:void 0===typeof s||isNaN(s)?!1:s,max:void 0===typeof o||isNaN(o)?!1:o,step:void 0===typeof r||isNaN(r)?1:r,timer:null},n);a.digits=l(a.step),n.up.on("touchstart.stepper mousedown.stepper",a,i).data("stepper",a),n.down.on("touchstart.stepper mousedown.stepper",a,i).data("stepper",a)}}function i(t){t.preventDefault(),t.stopPropagation(),s(t);var n=t.data;if(!n.$input.is(":disabled")){var i=n.up[0]===t.target?n.step:-n.step;n.timer=r(n.timer,125,function(){o(n,i,!1)}),o(n,i),e("body").on("touchend.stepper mouseup.stepper",n,s)}}function s(t){t.preventDefault(),t.stopPropagation();var n=t.data;a(n.timer),e("body").off(".stepper")}function o(e,t){var n=parseFloat(e.$input.val()),i=t;void 0===typeof n||isNaN(n)?i=e.min!==!1?e.min:0:e.min!==!1&&n<e.min?i=e.min:i+=n;var s=(i-e.min)%e.step;0!==s&&(i-=s),e.up.removeClass("disabled"),e.down.removeClass("disabled"),e.min!==!1&&i<=e.min&&(i=e.min,e.down.addClass("disabled")),e.max!==!1&&i>=e.max&&(i-=e.step,e.up.addClass("disabled")),i!==n&&(i=c(i,e.digits),e.$input.val(i).trigger("change"))}function r(e,t,n){return a(e),setInterval(n,t)}function a(e){e&&(clearInterval(e),e=null)}function l(e){var t=String(e);return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}function c(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var d={customClass:""},u={defaults:function(t){return d=e.extend(d,t||{}),e(this)},destroy:function(){return e(this).each(function(){this.data.$stepper.off(".stepper")})},disable:function(){return e(this).each(function(){data.$input.attr("disabled","disabled")})},enable:function(){return e(this).each(function(){data.$input.attr("disabled",null)})}};e.fn.stepper=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?this:t.apply(this,arguments)},e.stepper=function(e){"defaults"===e&&u.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery,this),define("jq.stepper",["jQuery"],function(e){return function(){var t;return t||e.$.fn.stepper}}(this)),define("app/views/typetester/FontPropertiesEditorView",["backbone","app/models/AppModel","jq.noUiSlider","bb.text!app/../../resources/tpl/typetester/FontSelected.html","lib/amd.colorpicker","jq.numeric","jq.stepper"],function(e,t,n,i,s){function o(e){return function(){var t=Math.floor(this.value);e.model.set(this.id.split(":")[1],t)}}function r(e){return function(){var t=Math.floor(this.val());e.model.set(this.parent()[0].id.split(":")[1],t),this.parent().find("input").val(t)}}function a(e){return function(t){var n=$(t.target),i=n.closest(".sliderBox"),s=parseInt(t.target.value,10);e.model.set(i.attr("id").split(":")[1],s),i.find(".slider").val(s)}}var l=e.View.extend({tagName:"div",className:"LeftPanelSelectedView",_bgColor:"#FFFFFF",_isFgColorMode:!0,_colorOpened:!1,events:{"click .widget.textAlign div":"switchAlign","click .widget.types .typesMain div":"switchFeature","click .widget.types .typesSub div":"switchFeature","click .fontColor":"onOpenColor","click .bgColor":"onOpenBgColor","change .colorPicker .rgb input":"onChangeRGBColor","change .colorPicker .hex input":"onChangeHEXColor","change .sliderBox input":"onChangeInput","keyup .sliderBox input":"onChangeInput"},initialize:function(){_.bindAll(this,"render","onCloseSelector","switchAlign","onUpdateColor","switchFeature","onChangeRGBColor","onChangeHEXColor","onClickOutside"),this._setTo=r(this),this._slideTo=a(this),this._stepTo=o(this),this.render()},onChangeInput:function(e){var t=$(e.target).closest(".sliderBox").find(".slider"),n=parseInt($(e.target).val(),10);isNaN(n)||($(t).val(n),this.model.set($(e.target).closest(".sliderBox").attr("id").split(":")[1],n))},render:function(){this.$el.html(t.nunjucks.renderString(i,_.extend(this.model.toJSON(),{bgColor:this.model.get("backgroundColor"),color:this.model.get("color")}))),_.each(this.$(".slider"),function(e){var t=e.parentNode,n=t.id.split(":")[1];t=$(t),$(e).noUiSlider({handles:1,step:1,range:[parseInt(t.attr("data-from"),10),parseInt(t.attr("data-to"),10)],start:this.model.get(n),connect:"lower",slide:this._setTo,set:this._setTo})},this),_.each(this.$(".clicker"),function(e){e=$(e),e.find("input").stepper({up:e.find(".clickerUp"),down:e.find(".clickerDown")}).on("change",this._stepTo)},this),this.initColorPicker()},initColorPicker:function(){this.$colorHex=this.$(".colorPicker .hex input"),this.$colorR=this.$(".colorPicker .rgb input:eq(0)"),this.$colorG=this.$(".colorPicker .rgb input:eq(1)"),this.$colorB=this.$(".colorPicker .rgb input:eq(2)"),this.$color=this.$(".colorPicker .colorSelected div"),this.$colorR.numeric(),this.$colorG.numeric(),this.$colorB.numeric(),s.fixIndicators(this.$(".colorPicker .colorRange b")[0],this.$(".colorPicker .colorSaturation b")[0]),this.colorPicker=new s(this.$(".colorPicker .colorRange div")[0],this.$(".colorPicker .colorSaturation div")[0],this.onUpdateColor)},onChangeRGBColor:function(){this.colorPicker.setRgb({r:this.$colorR.val(),g:this.$colorG.val(),b:this.$colorB.val()})},onChangeHEXColor:function(){this.colorPicker.setHex("#"+this.$colorHex.val())},onOpenColor:function(){this._colorOpened&&this.onClickOutside(),this._colorOpened=!0,this._isFgColorMode=!0,this.colorPicker.setHex(this.model.get("color")),this.$(".colors").removeClass("selectBgColor").addClass("selectFontColor");var e=this;setTimeout(function(){$("body").bind("click",e.onClickOutside)},300)},onOpenBgColor:function(){this._colorOpened&&this.onClickOutside(),this._colorOpened=!0,this._isFgColorMode=!1,this.colorPicker.setHex(this.model.get("backgroundColor")),this.$(".colors").removeClass("selectFontColor").addClass("selectBgColor");var e=this;setTimeout(function(){$("body").bind("click",e.onClickOutside)},300)},onClickOutside:function(e){this._colorOpened=!1,e&&0!==$(e.target).closest(".colorPicker").length||(this.$(".colors").removeClass("selectFontColor selectBgColor"),$("body").unbind("click",this.onClickOutside))},onUpdateColor:function(e,t,n,i,o){s.positionIndicators($(".colorRange b")[0],$(".colorSaturation b")[0],o,i),this.$colorHex.val(e.substring(1)),this.$colorR.val(n.r),this.$colorG.val(n.g),this.$colorB.val(n.b),this.$color.css("background",e),this._isFgColorMode?(this.model.set("color",e),this.$(".fontColor").css("background-color",e)):(this.model.set("backgroundColor",e),this.$(".bgColor").css("background-color",e))},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},switchFeature:function(e){var t=$(e.target);if(t.toggleClass("active"),this.$(".widget.types .ss").hasClass("active")?this.$(".widget.types").addClass("opened"):this.$(".widget.types").removeClass("opened"),!t.hasClass("ss")){var n={};n.liga=this.$(".widget.types .liga").hasClass("active"),n.dlig=this.$(".widget.types .dlig").hasClass("active"),n.calt=this.$(".widget.types .calt").hasClass("active"),n.smcp=this.$(".widget.types .smcp").hasClass("active"),n.onum=this.$(".widget.types .onum").hasClass("active"),n.ss01=this.$(".widget.types .ss1").hasClass("active"),n.ss02=this.$(".widget.types .ss2").hasClass("active"),n.ss03=this.$(".widget.types .ss3").hasClass("active"),n.ss04=this.$(".widget.types .ss4").hasClass("active"),n.ss05=this.$(".widget.types .ss5").hasClass("active"),_.each(n,function(e,t){e?this.$("."+t+"Alert").addClass("active"):this.$("."+t+"Alert").removeClass("active")},this),this.model.set(n)}},switchAlign:function(e){var t=$(e.target);this.$(".widget.textAlign div").removeClass("active"),t.addClass("active"),t.hasClass("left")?this.model.set("textAlign","left"):t.hasClass("right")?this.model.set("textAlign","right"):t.hasClass("center")?this.model.set("textAlign","center"):this.model.set("textAlign","justify")}});return l}),define("bb.text!app/../../resources/tpl/typetester/Scrollable.html",[],function(){return'<div class="holder">\n{% for sub in fonts %}\n    <div data-id="{{sub.id}}" class="option {% if loop.index0 == 0 %} selected {% endif %}">{{sub.setName}}</div>\n{% endfor %}\n</div>\n'}),define("app/views/typetester/ScrollableFontListView",["backbone","app/models/AppModel","app/models/FontSetModel","app/collections/FontSetCollection","bb.text!app/../../resources/tpl/typetester/Scrollable.html","jq.mCustomScrollbar"],function(e,t,n,i,s){var o=e.View.extend({tagName:"div",className:"ScrollableFontListView",_searchString:null,events:{"click .option":"onOption"},initialize:function(t){_.bindAll(this,"render","appendRender","prependRender"),this._fontSetCollection=new i,this._fontSetCollection.startID=t.startID,this._fontSetCollection.comparator="sortOrder",this._fontSetCollection.appendSet=function(t,n){for(var i=_.max(this.pluck("sortOrder"))+1,s=0,o=t.fonts.length;o>s;s++)t.fonts[s].sortOrder=i+s;e.Collection.prototype.set.call(this,t,n)},this._fontSetCollection.prependSet=function(t,n){for(var i=_.min(this.pluck("sortOrder"))+1,s=t.fonts.length-1;s>0;s--)t.fonts[s].sortOrder=i-s;e.Collection.prototype.set.call(this,t,n)};for(var n=0,s=this._fontSetCollection.length;s>n;n++)this._fontSetCollection.at(n).set("sortOrder",n);
this.search(null)},render:function(){this.$el.attr("id",this.cid);var e=t.nunjucks.renderString(s,{startID:this.startID,fonts:this._fontSetCollection.toJSON()});return this.$el.html(e),this.makeScrollable(),this},invalidate:function(){this.$el.mCustomScrollbar("update"),this.$(".mCSB_container").css({top:"-30px"}),this.$el.mCustomScrollbar("scrollTo",".holder")},makeScrollable:function(){this.infiniScroll=new e.InfiniScroll(this._fontSetCollection,{forwardSuccess:this.appendRender,backwardSuccess:this.prependRender,error:this.appendRender}),this.$el.mCustomScrollbar({theme:"light",setTop:"-100px",callbacks:{onTotalScroll:this.infiniScroll.fetchForward,onTotalScrollBack:this.infiniScroll.fetchBackward}})},prependRender:function(e,n){for(var i=document.createDocumentFragment(),s=n.fonts.length-1;s>0;s--){var o=n.fonts[s].id,r=e.findWhere({id:o}),a=t.nunjucks.renderString('<div data-id="{{sub.id}}" class="option {% if startID == sub.id %} selected {% endif %}">{{sub.setName}}</div>',{sub:r.toJSON()});i.appendChild($(a)[0])}var l=$(".holder div:first");this.$(".holder").prepend(i),this.$el.mCustomScrollbar("update"),this.$el.mCustomScrollbar("scrollTo",l.position().top,{scrollInertia:0})},appendRender:function(e,n){for(var i=document.createDocumentFragment(),s=0,o=n.fonts.length;o>s;s++){var r=n.fonts[s].id,a=e.findWhere({id:r}),l=t.nunjucks.renderString('<div data-id="{{sub.id}}" class="option {% if startID == sub.id %} selected {% endif %}">{{sub.setName}}</div>',{sub:a.toJSON()});i.appendChild($(l)[0])}this.$(".holder").append(i),this.$el.mCustomScrollbar("update")},onOption:function(e){var t=$(e.target).closest(".option").attr("data-id");this.trigger("selected",this._fontSetCollection.findWhere({id:t}))},search:function(e){this._searchString=e,e?(this._fontSetCollection.url=function(){return"/jsonFonts/query/"+e+"/asc/"+this.length+"/limit/10"},this._fontSetCollection.forwardURL=this._fontSetCollection.url,this._fontSetCollection.backwardURL=null,this._fontSetCollection.fetch({reset:!0,success:this.render})):(this._fontSetCollection.forwardURL=function(){return"/jsonFonts/font/"+this.at(this.length-1).get("id")+"/asc/0/limit/10"},this._fontSetCollection.backwardURL=function(){return"/jsonFonts/font/"+this.at(0).get("id")+"/dsc/0/limit/10"},this._fontSetCollection.fetch(this._fontSetCollection.startID?{url:"/jsonFonts/font/"+this._fontSetCollection.startID+"/asc/0/limit/10",reset:!0,success:this.render}:{url:"/jsonFonts/asc/0/limit/10",reset:!0,success:this.render}))}});return o}),define("bb.text!app/../../resources/tpl/typetester/Static.html",[],function(){return'<div class="holder">\n{% for sub in fonts %}\n    <div data-id="{{sub.id}}" class="option {% if loop.index0 == 0 %} selected {% endif %}">{{sub.setName}}</div>\n{% endfor %}\n</div>\n'}),define("app/views/typetester/StaticFontListView",["backbone","app/models/AppModel","app/models/FontSetModel","app/collections/FontSetCollection","bb.text!app/../../resources/tpl/typetester/Static.html","jq.mCustomScrollbar"],function(e,t,n,i,s){var o=e.View.extend({tagName:"div",className:"ScrollableFontListView",events:{"click .option":"onOption"},initialize:function(e){_.bindAll(this,"render"),this._fontSetCollection=e.collection,this.render()},render:function(){this.$el.attr("id",this.cid);var e=t.nunjucks.renderString(s,{startID:this.startID,fonts:this.filtered()});return this.$el.html(e),this.makeScrollable(),this},invalidate:function(){this.$el.mCustomScrollbar("update")},makeScrollable:function(){this.$el.mCustomScrollbar({theme:"light"})},onOption:function(e){var t=$(e.target).closest(".option").attr("data-id");this.trigger("selected",this._fontSetCollection.findWhere({id:t}))},filtered:function(){var e=this._fontSetCollection.toJSON();if(this._searchString){for(var t=[],n=0,i=e.length;i>n;n++)e[n].fullName.toLowerCase().indexOf(this._searchString)>=0&&t.push(e[n]);return t}return e},search:function(e){this._searchString=e?e.toLowerCase():null,this.render()}});return o}),define("bb.text!app/../../resources/tpl/typetester/FontSelector.html",[],function(){return'<div class="fontSelector">\n    <div class="tabs">\n        <ul>\n            <li class="tab all {% if mode == \'all\' %}active{% endif %}">\n                <div>\n                    <div class="tabText">Все шрифты</div>\n                    <div class="tabIcon icon-typetester_all"></div>\n                </div>\n            </li>\n            <li class="tab tester {% if mode == \'tester\' %}active{% endif %}">\n                <div>\n                    <div class="tabText">тест-драйв</div>\n                    <div class="tabIcon icon-typetester_typetester"></div>\n                </div>\n            </li>\n            <li class="tab fav {% if mode == \'favorite\' %}active{% endif %}">\n                <div>\n                    <div class="tabText">избранное</div>\n                    <div class="tabIcon icon-typetester_favorites"></div>\n                </div>\n            </li>\n        </ul>\n    </div>\n    <div class="content">\n        <div class="searchBlock">\n            <div class="icon search icon-typetester_search"></div>\n            <div class="icon close icon-delete_tag"></div>\n            <input type="text" value="Найти шрифт"/>\n        </div>\n        <div class="selector sets">\n            <div class="value">\n                {% if setName %} {{ setName }} {%else%} Выбрать шрифт {% endif %}\n                <div class="tri"></div>\n            </div>\n            <div class="select">\n            </div>\n        </div>\n        {% if subSets.length > 1 %}\n        <div class="selector fonts">\n            <div class="value">\n                {{ selectedSubFont.name }}\n                <div class="tri"></div>\n            </div>\n            <div class="select">\n                {% for sub in subSets %}\n                <div data-id="{{sub.id}}" class="option {% if fontName == sub.name %} selected {% endif %}">{{sub.name}}</div>\n                {% endfor %}\n            </div>\n        </div>\n        {% endif %}\n    </div>\n    <div class="footer">\n        <div class="table">\n            <span class="button buy {% if isInBucket  %} selected {% endif %}"><b class="icon-typetester_cart_filled"></b>Купить</span>\n            <span class="button favorits {% if isFavorite  %} selected {% endif %}"><b class="icon-typetester_favorites"></b>В избранное</span>\n        </div>\n    </div>\n</div>\n'}),define("app/views/typetester/FontSelectorView",["backbone","app/models/AppModel","app/models/FontSetModel","app/collections/FontSetCollection","jq.mCustomScrollbar","app/views/typetester/ScrollableFontListView","app/views/typetester/StaticFontListView","bb.text!app/../../resources/tpl/typetester/FontSelector.html"],function(e,t,n,i,s,o,r,a){var l=e.View.extend({_viewMode:"all",tagName:"div",className:"FontSelectorView",_selectedSubFont:null,_fontSetCollection:null,_defaultSearchValue:null,events:{"click .tab":"switchMode","click .selector:not(.opened)":"openSelector","click .selector.fonts .option":"onOption","click .button.favorits":"onFavorites","focus .searchBlock input":"onSearchFocus","blur .searchBlock input":"onSearchBlur","change .searchBlock input":"onSearch","keyup .searchBlock input":"onSearch","click .searchBlock .close":"clearSearch"},initialize:function(){var e=this.model.get("subSets");this.model&&!this.model.get("selectedSubFont")&&this.model.set("selectedSubFont",e&&e.length>0?e:null),_.bindAll(this,"render","openSelector","closeSelector","onOption","switchMode"),this.render()},render:function(){var e,n,i;if(this.$el.attr("id",this.cid),"favorite"===this._viewMode){var s=t.getFavoritesCollection().getPlainCollection();e=s.at(0),e&&(i=e.get("subSets"),n=i&&i.length>0?e.get("subSets")[0]:null,this.$el.html(t.nunjucks.renderString(a,this.model?_.extend(e.toJSON(),{mode:this._viewMode,selectedSubFont:n}):null)),this._fontSetView=new r({el:this.$(".selector.sets .select"),startID:s.at(0).get("id"),collection:s}),this.$(".selector.sets .value").html(s.at(0).get("setName")))}else if("tester"===this._viewMode){var l=t.getTypetesterModel().get("typetestedCollection");if(0===l.length)return void this.$(".tab.tester").addClass("disabled");e=l.at(0),n=e&&e.get("subSets")?e.get("subSets")[0]:null,this.$el.html(t.nunjucks.renderString(a,this.model?_.extend(e?e.toJSON():{},{mode:this._viewMode,selectedSubFont:n}):null)),this._fontSetView=new r({el:this.$(".selector.sets .select"),startID:this.model.get("id"),collection:l})}else this.$el.html(t.nunjucks.renderString(a,this.model?_.extend(this.model.toJSON(),{mode:this._viewMode}):null)),this._fontSetView=new o({el:this.$(".selector.sets .select"),startID:this.model?this.model.get("id"):"0"});0===t.getTypetesterModel().get("typetestedCollection").length&&this.$(".tab.tester").addClass("disabled"),0===t.getFavoritesCollection().getPlainCollection().length&&this.$(".tab.fav").addClass("disabled"),this.listenTo(this._fontSetView,"selected",this.onSetSelect,this),this.$(".selector.fonts .select").mCustomScrollbar(),this._defaultSearchValue=this.$(".searchBlock input").val()},switchMode:function(e){var t=$(e.target).closest(".tab");t.hasClass("all")&&"all"!==this._viewMode?(this._viewMode="all",this.render()):t.hasClass("tester")&&"tester"!==this._viewMode?(this._viewMode="tester",this.render()):t.hasClass("fav")&&"favorite"!==this._viewMode&&(this._viewMode="favorite",this.render())},openSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),t.find(".select").mCustomScrollbar("update");var n=this.closeSelector;setTimeout(function(){$("body").bind("click",n)},300),t.hasClass("sets")&&(this._fontSetView.invalidate(),this.$(".searchBlock").show())},closeSelector:function(e){1!=$(e.target).closest(".selector").length&&1!=$(e.target).closest(".searchBlock").length&&($("body").unbind("click"),this.$(".selector").removeClass("opened"),this.$(".searchBlock").hide())},onOption:function(e){var t=$(e.target).closest(".option").attr("data-id");this.model.set("selectedSubFont",_.findWhere(this.model.get("subSets"),{id:t}));var i=new n;i.set("id",t),i.fetch(),this.model.set({css:i.get("css"),fontFace:i.get("fontFace"),defaultSubSet:i.get("id")}),this.render()},onSetSelect:function(e){this.model.set(e.toJSON());var t=this.model.get("subSets");this.model.set("selectedSubFont",t&&t.length>0?t[0]:null),this.render()},onFavorites:function(t){e.trigger("open:favoritesMenu",this.model,{x:t.pageX,y:t.pageY})},onSearchFocus:function(){this.$(".searchBlock input").val("")},onSearchBlur:function(){this.$(".searchBlock input").val()||(this.$(".searchBlock input").val(this._defaultSearchValue),this.$(".searchBlock").removeClass("active"))},onSearch:function(){var e=this.$(".searchBlock input").val();e&&this.$(".searchBlock").addClass("active"),this._fontSetView.search(e)},clearSearch:function(){this.$(".searchBlock").removeClass("active"),this.$(".searchBlock input").val(this._defaultSearchValue),this._fontSetView.search(null)}});return l}),define("bb.text!app/../../resources/tpl/typetester/Typetester.html",[],function(){return'<div class="typetesterContent">\n    <div class="contentTop">\n        <div class="close"><b></b></div>\n        <div class="simpleButton dumpPDF"><b class="icon-go_down"></b>скачать PDF</div>\n    </div>\n\n    <div class="holder">\n        <div class="holderContent">\n        <!-- insert here text blocks -->\n        </div>\n    </div>\n\n    <div class="contentBottom">\n        <div class="simpleButton addBlock"><b class="icon-addblock"></b>добавить блок</div>\n    </div>\n</div>\n\n'}),define("app/views/typetester/TypetesterView",["backbone","app/models/AppModel","app/models/FontSetModel","app/models/TypetesterModel","jq.noUiSlider","jq.mCustomScrollbar","app/views/typetester/TextblockView","app/views/typetester/TextblockModel","app/views/typetester/FontListView","app/views/typetester/FontPropertiesEditorView","app/views/typetester/FontSelectorView","bb.text!app/../../resources/tpl/typetester/Typetester.html"],function(e,t,n,i,s,o,r,a,l,c,d,u){function h(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16)}}function p(e){var t=e.r,n=e.g,i=e.b;(e.r>1||e.g>1||e.b>1)&&(t/=255,n/=255,i/=255);var s,o,r,a;return r=Math.max(t,n,i),a=r-Math.min(t,n,i),s=0===a?null:r===t?(n-i)/a+(i>n?6:0):r===n?(i-t)/a+2:(t-n)/a+4,s=s%6*60,o=0===a?0:a/r,{h:s,s:o,v:r}}function f(e,t,n){var i=h(t),s=""+i.r+","+i.g+","+i.b;$(e).css("background",t),$(e).css("background","linear-gradient(to "+(n?"top":"bottom")+", rgba("+s+", 0.95) 60%, rgba("+s+",0) 100% )")}function v(e){for(var t=0,n=0,i=e.length;i>n;n++){var s=e[n].model.get("top")+e[n].model.get("height");t=Math.max(t,s)}return t}function m(e){for(var t=e[0].model.get("top"),n=0,i=e.length;i>n;n++){e[n].$el.css("top",t);var s=e[n].$el.height();e[n].model.set({top:t,height:s},{silent:!0}),t+=s+50}}var g=e.View.extend({tagName:"div",className:"Typetester",_fontListView:null,_fontPropertiesView:null,_fontSelectorView:null,_textBlocks:[],_selectedBlock:null,_lastRenderedBlock:null,_bgColor:"#FFFFFF",_isFgColorMode:!0,_slideTo:null,_setTo:null,_stepTo:null,_isChanged:!1,_isScrollBuilt:!1,_panelHolder:null,_leftPanel:null,_forced:!0,events:{"mousedown .typetesterContent":"onDeselect","click .dumpPDF":"dump","click .addBlock":"addBlock","click .close":"onClose"},initialize:function(e){console.log("XXXXX",this.model.get("typetestedCollection"));var t=this.model.get("typetestedCollection");_.bindAll(this,"render","addBlock","invalidate","dump","onClose","recalculateHeight"),this._panelHolder=e.panelHolder,this._textBlocks.push(new r({model:new a({font:t.length>0?t.at(0):new n,fontSize:60,lineHeight:60,height:155,width:840,textAlign:"center",top:50,text:"О&nbsp;различии между чистым и&nbsp;эмпирическим познанием"})})),this._textBlocks.push(new r({model:new a({font:t.length>1?t.at(1):new n,fontSize:22,lineHeight:22,height:155,width:840,textAlign:"left",top:200,text:"Без сомнения, всякое наше познание начинается с&nbsp;опыта; в&nbsp;самом деле, чем&nbsp;же пробуждалась&nbsp;бы к&nbsp;деятельности познавательная способность, если не&nbsp;предметами, которые действуют на&nbsp;наши чувства и&nbsp;отчасти сами производят представления, отчасти побуждают наш рассудок сравнивать их, связывать или разделять."})})),this._textBlocks.push(new r({model:new a({font:t.length>2?t.at(2):new n,fontSize:16,lineHeight:16,height:300,width:840,textAlign:"left",columnGap:25,top:335,columnCount:2,text:"Однако термин а&nbsp;priori еще недостаточно определен, чтобы надлежащим образом обозначить весь смысл поставленного вопроса. В&nbsp;самом деле, обычно относительно некоторых знаний, выведенных из&nbsp;эмпирических источников, говорят, что мы&nbsp;способны или причастны к&nbsp;ним а&nbsp;priori потому, что мы&nbsp;выводим их&nbsp;не&nbsp;непосредственно из&nbsp;опыта, а&nbsp;из&nbsp;общего правила, которое, однако, само заимствовано нами из&nbsp;опыта. Так, о&nbsp;человеке, который подрыл фундамент своего дома, говорят: он&nbsp;мог а&nbsp;priori знать, что дом обвалится, иными словами, ему незачем было ждать опыта, т.е. когда дом действительно обвалится. Но&nbsp;хотя всякое наше познание и&nbsp;начинается с&nbsp;опыта, отсюда вовсе не&nbsp;следует, что оно целиком происходит из&nbsp;опыта. Вполне возможно, что даже наше опытное знание складывается из&nbsp;того, что мы&nbsp;воспринимаем посредством впечатлений, и&nbsp;из&nbsp;того, что наша собственная познавательная способность (только побуждаемая чувственными впечатлениями) дает от&nbsp;себя самой, причем это добавление мы&nbsp;отличаем от&nbsp;основного чувственного материала лишь тогда, когда продолжительное упражнение обращает на&nbsp;него наше внимание и&nbsp;делает нас способными к&nbsp;обособлению его."})})),this._fontListView=new l({model:this.model.get("typetestedCollection")}),this.render()},render:function(){this.$el.attr("id",this.cid),this.$el.empty(),this.$el.html(t.nunjucks.renderString(u)),this.renderLeftPanel(),_.each(this._textBlocks,function(e){e.$el.remove()});var e=document.createDocumentFragment();return _.each(this._textBlocks,function(t){t.render(),e.appendChild(t.el),this.listenTo(t,"TextblockView:select",this.onSelectBlock),this.listenTo(t,"TextblockView:remove",this.onRemoveBlock)},this),this.$(".typetesterContent .holderContent").append(e),f(this.$(".contentTop"),"#ffffff",!1),f(this.$(".contentBottom"),"#ffffff",!0),this},invalidate:function(){var e=0,t=this.model.get("typetestedCollection");_.each(this._textBlocks,function(n){if(!n.model.get("font")&&e<t.length){var i=t.at(e);n.model.set({font:i}),this.model.get("selectCollection").add(i)}e++},this),this._isChanged||m(this._textBlocks),!this._isScrollBuilt&&this.$el.parent().length>0&&(this.$(".holder").mCustomScrollbar({theme:"dark"}),this._isScrollBuilt=!0),this.recalculateHeight(),this.renderLeftPanel()},recalculateHeight:function(){var e=0;_.each(this._textBlocks,function(t){var n=t.model.get("top")+t.model.get("height");e=Math.max(e,n)},this),this.$(".holderContent").css("height",e+70),this.$(".holder").mCustomScrollbar("update")},delegateEvents:function(){this._fontListView.delegateEvents(),this._fontPropertiesView&&this._fontPropertiesView.delegateEvents(),_.each(this._textBlocks,function(e){e.delegateEvents()},this),e.View.prototype.delegateEvents.call(this)},dump:function(){var e,t=[];_.each(this._textBlocks,function(n){e=n.model.toJSON(),e.font=e.font?e.font.defaultSubSet?e.font.defaultSubSet:e.font.id:"",t.push(e)},this),console.log(JSON.stringify(t))},addBlock:function(){var e=v(this._textBlocks),t=_.difference(_.toArray(this.model.get("typetestedCollection").models),_.toArray(this.model.get("selectCollection").models)),i=new r({model:new a({font:t.length>0?t[0]:new n,fontSize:16,lineHeight:16,height:300,width:840,textAlign:"left",top:e+50,columnCount:1,text:"Без сомнения, всякое наше познание начинается с&nbsp;опыта; в&nbsp;самом деле, чем&nbsp;же пробуждалась&nbsp;бы к&nbsp;деятельности познавательная способность, если не&nbsp;предметами, которые действуют на&nbsp;наши чувства и&nbsp;отчасти сами производят представления, отчасти побуждают наш рассудок сравнивать их, связывать или разделять."})});t.length>0&&this.model.get("selectCollection").add(t[0]),this._textBlocks.push(i),this.listenTo(i,"TextblockView:select",this.onSelectBlock),this.listenTo(i,"TextblockView:remove",this.onRemoveBlock),i.render(),this.$(".typetesterContent .holderContent").append(i.el),i.invalidate(),this.recalculateHeight(),this.$(".typetesterContent .mCustomScrollbar").mCustomScrollbar("scrollTo","bottom")},renderLeftPanel:function(){(this._forced||this._lastRenderedBlock!=this._selectedBlock)&&(0===this._panelHolder.$("."+this.className).length?(this._panelHolder.$el.prepend("<div class='"+this.className+"'>"),this._leftPanel=this._panelHolder.$("."+this.className)):this._leftPanel.empty(),this._selectedBlock?(this._fontSelectorView=new d({model:this._selectedBlock.model.get("font")}),this._leftPanel.append(this._fontSelectorView.el),this._fontPropertiesView=new c({model:this._selectedBlock.model}),this._leftPanel.append(this._fontPropertiesView.el)):(this._fontPropertiesView&&this._fontPropertiesView.remove(),this._fontPropertiesView=null,this._leftPanel.append(this._fontListView.el),this._fontListView.delegateEvents())),this._forced=!1,this._lastRenderedBlock=this._selectedBlock,this.delegateEvents()},onUpdateColor:function(){this._bgColor=this._fontPropertiesView.model.get("backgroundColor");var e=p(h(this._bgColor));this.$(".typetesterContent").css("background-color",this._bgColor),_.each(this._textBlocks,function(e){e.model.set("backgroundColor",this._bgColor,{silent:!0})},this),this.$(".simpleButton, .close").removeClass("inverted"),e.v<.6?(this.$(".simpleButton, .close").addClass("inverted"),this.$(".mCS-dark").addClass("mCS-light"),this.$(".mCS-dark").removeClass("mCS-dark")):(this.$(".mCS-light").addClass("mCS-dark"),this.$(".mCS-light").removeClass("mCS-light")),f(this.$(".contentTop"),this._bgColor,!1),f(this.$(".contentBottom"),this._bgColor,!0)},onDeselect:function(e){var t=$(e.target).closest(".TextBlock").length>0;this._selectedBlock&&!t&&(this.stopListening(this._selectedBlock.model),this._selectedBlock=null,_.each(this._textBlocks,function(e){e.onDeselect()}),this.renderLeftPanel())},onSelectedBlockFontChanged:function(){var e=this._selectedBlock.model.get("font");if(e){var t=this.model.get("selectCollection").get(e);t&&this.model.get("selectCollection").add(e)}},onSelectBlock:function(e){this._selectedBlock=e,this.listenTo(this._selectedBlock.model,"change:font",this.onSelectedBlockFontChanged),this.listenTo(this._selectedBlock.model,"change:backgroundColor",this.onUpdateColor),_.each(this._textBlocks,function(t){t!==e&&t.onDeselect()}),this.renderLeftPanel()},onRemoveBlock:function(e){this._selectedBlock=null,e.remove(),this._textBlocks=_.without(this._textBlocks,e),this.renderLeftPanel()},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector)},100)},onClose:function(){e.trigger("close:typetester")},close:function(){this._leftPanel&&(this._leftPanel.empty(),this._leftPanel=null,this._selectedBlock=null,this._forced=!0)}});return g}),define("bb.text!app/../../resources/tpl/popups/FavoritesMenu.html",[],function(){return'<div class="addToFavorites {% if down %} down {% endif %}">\n    <div class="top">\n        <div class="addCollection">\n            Добавить в новую коллекцию\n            <b class="icon-licence_plus"></b>\n        </div>\n        <div class="editCollection">\n            <input type="text" value=""/>\n            <b class="button add icon-licence_plus"></b>\n        </div>\n    </div>\n    <div class="favCollections">\n        {% for favorite in favorites %}\n            {% if favorite.checked %}\n                <div class="collection selected" id="fav_{{ favorite.id }}">{{ favorite.title }}<b class="check icon-check"></b><b class="icon-licence_delete"></b></div>\n            {% else %}\n                <div class="collection" id="fav_{{ favorite.id }}">{{ favorite.title }}<b class="icon-licence_plus"></b></div>\n            {% endif %}\n        {% endfor %}\n    </div>\n    <div class="bottom"></div>\n    <div class="tri"></div>\n</div>\n'}),define("app/views/popups/FavoritesMenuView",["backbone","app/models/AppModel","app/models/FavoriteModel","bb.text!app/../../resources/tpl/popups/FavoritesMenu.html"],function(e,t,n,i){var s=e.View.extend({tagName:"div",className:"FavoritesMenuView",_down:!1,events:{"click .collection":"addToCollection","click .addCollection":"newCollection","blur .editCollection input":"noNewCollection","click .editCollection .add":"saveNewCollection"},initialize:function(e){_.bindAll(this,"render","close"),this._down=e.down,this.render()},render:function(){this.$el.attr("id",this.cid);var e=t.getFavoritesCollection().toJSON(),n=this.model.id;return e=_.map(e,function(e){return{id:e.id,title:e.title,checked:!!_.findWhere(e.fonts,{id:n})}}),this.$el.html(t.nunjucks.renderString(i,{favorites:e,font:this.model,down:this._down})),this},invalidate:function(){var e=this.close;$("body").unbind("click",e),setTimeout(function(){$("body").bind("click",e)},300)},close:function(e){$("body").unbind("click",close);var n=$(e.target).closest(".FavoritesMenuView").length>0;n||this.remove(),t.lockeInterface(!1)},addToCollection:function(e){var n=$(e.target).closest(".collection"),i=n.attr("id").substr(4),s=t.getFavoritesCollection().findWhere({id:i});n.hasClass("selected")?s.fonts.remove(this.model):s.fonts.add(this.model),s.save(),this.render(),this.trigger("close")},noNewCollection:function(){var e=this;setTimeout(function(){e.$(".addCollection").show(),e.$(".editCollection").hide()},500)},newCollection:function(){this.$(".addCollection").hide(),this.$(".editCollection").show(),this.$(".editCollection input").focus()},saveNewCollection:function(){var e=new n({title:this.$(".editCollection input").val()});e.fonts.add(this.model),t.getFavoritesCollection().add(e),this.listenToOnce(e,"change",this.render),e.save(),this.trigger("close")}});return s}),define("app/views/popups/PopupView",["backbone","app/models/AppModel"],function(e,t){var n=e.View.extend({tagName:"div",className:"Popupiew",_down:!1,events:{"click .button.close":"close"},initialize:function(){_.bindAll(this,"render","close")},render:function(e,n){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(e,n)),this},invalidate:function(){},close:function(){this.remove(),t.lockeInterface(!1)}});return n}),define("bb.text!app/../../resources/tpl/popups/CartPopup.html",[],function(){return'{% macro licenceRow(licence, bought=false) %}\n    <div class="tr licence" data-id="{{licence.id}}">\n        <div class="td left name">\n            {{licence.title}}\n        </div>\n        <div class="td right">\n            {% if bought %}\n                <div class="button bought">\n                    <div class="x">Убрать X</div>\n                    <div class="v">В корзине V</div>\n                </div>\n            {% else %}\n                <div class="button buy">{{licence.price|money(0)}}&nbsp;&#x20B7;</div>\n            {% endif %}\n        </div>\n    </div>\n{% endmacro %}\n\n\n\n{% macro expandable(licence) %}\n    <div class="extendedLicences">\n        <div class="extendee"><b></b>{{licence.expands}}</div>\n        <div class="list tb">\n        {% for sublicence in licenceList %}\n            {% if sublicence.extends and sublicence.extends == licence.id and not licences[sublicence.id] %}\n                {{ licenceRow(sublicence, false) }}\n            {% endif %}\n        {% endfor %}\n        </div>\n    </div>\n{% endmacro %}\n\n\n\n\n\n\n\n\n<div class="popupBg"></div>\n<div class="popup">\n    Выберите нужные вам лицензии<br/>\n    <a href="#">Не разбираетесь в лицензиях?</a><br/>\n\n    <div class="button close cross">X</div>\n\n<div class="FontSetView">\n    <div class="topLine">\n        {% if subSets %}<div class="icon icon-fontpack">&nbsp;</div>{% endif %}\n        <div class="fullName">{{fullName}}</div>\n    </div>\n\n    <div class="licences">\n        {% for id, licence in licences %}\n            {{ licenceRow(licence, true) }}\n        {% endfor %}\n    </div>\n\n    <div class="licenceList">\n        {% for licence in licenceList %}\n            {% if not licence.extends and not licences[licence.id] %}\n                {{ licenceRow(licence, false) }}\n            {% endif %}\n        {% endfor %}\n    </div>\n\n\n    {% for licence in licenceList %}\n        {% if licence.expands %}\n            {{ expandable(licence) }}\n        {% endif %}\n    {% endfor %}\n\n\n\n</div>\n\n    <div class="bottomline">\n        <div class="button close back">back</div>\n        <div class="button cart">cart</div>\n    </div>\n\n</div>\n'}),define("app/views/popups/CartPopupView",["backbone","app/models/AppModel","app/views/popups/PopupView","bb.text!app/../../resources/tpl/popups/CartPopup.html"],function(e,t,n,i){var s=n.extend({tagName:"div",className:"PopupView CartPopupView",template:i,events:{"click .button.close":"close","click .licence .buy":"onAddLicence","click .licence .bought":"onDeleteLicence","click .extendedLicences":"onOpenExtended"},initialize:function(){_.bindAll(this,"render","close"),this.render()},render:function(){var e=_.extend(this.model.toJSON(),{licenceList:t.getLicenceList()});n.prototype.render.call(this,i,e)},onAddLicence:function(e){var n=_.findWhere(t.getLicenceList(),{id:$(e.target).closest(".licence").attr("data-id")});if(n){if(n.extends&&!this.model.get("licences")[n.extends]){var i=_.findWhere(t.getLicenceList(),{id:n.extends});this.model.get("licences")[n.extends]=_.clone(i)}this.model.get("licences")[n.id]=_.clone(n),this.render()}this.model.checkBucket(),this.model.save()},onDeleteLicence:function(e){var t=$(e.target).closest(".licence").attr("data-id"),n=_.where(this.model.get("licences"),{"extends":t});_.each(n,function(e){delete this.model.get("licences")[e.id]},this),delete this.model.get("licences")[t],this.model.checkBucket(),this.model.save(),this.render()},onOpenExtended:function(e){$(e.target).closest(".extendedLicences").toggleClass("opened")}});return s}),define("bb.text!app/../../resources/tpl/fontpanel/FontSet.html",[],function(){return'<div class="pangrammeCrop">\r\n    {% if css %}\r\n    <div class="pangramme" {% if fontFace %} style="font-family:\'{{fontFace}}\',\'Arial Black\';" {% endif %} >{{pangramme|safe}}</div>\r\n    {% else %}\r\n        <img class="pangramme" />\r\n    {% endif %}\r\n</div>\r\n<div class="gradient"></div>\r\n\r\n<div class="hr"><div></div></div>\r\n\r\n<div class="topLine">\r\n    <span class="fullName">{{fullName}}</span>\r\n    {% if fontFace %}<span class="icon-webfont"></span>{% endif %}\r\n</div>\r\n<div class="buttonLine">\r\n    <div class="toFavorites icon-in_favorites {% if isFavorite %} selected {% endif %}"></div>\r\n    <div class="toTypeTester icon-in_typetester {% if isInTypeTester %} selected {% endif %}"></div>\r\n    {% if isInBucket %}\r\n        <div class="toBucket selected"><span class="icon-check_big"></span>В корзине</div>\r\n    {% else %}\r\n        <div class="toBucket"><span class="icon-in_cart"></span>{{price}}&nbsp;<span class=\'rouble\'>P</span></div>\r\n    {% endif %}\r\n</div>\r\n'}),define("app/views/fontpanel/FontSetView",["backbone","app/models/AppModel","app/views/fontlist/FontSetView","app/events/FaceModeEvent","bb.text!app/../../resources/tpl/fontpanel/FontSet.html"],function(e,t,n,i,s){var o=n.extend({events:{"click .toTypeTester":"toTypeTester","click .toFavorites":"toFavorites","click .toBucket":"toBucket","click .pangrammeCrop":"select"},initialize:function(){this._template=s,n.prototype.initialize.call(this),this._nightMode=!1},setNightMode:function(){this._nightMode=!1},render:function(){this._nightMode=!1,n.prototype.render.call(this)},toFavorites:function(n){t.isInterfaceLocked()||e.trigger("open:favoritesMenu",this.model,{x:n.pageX,y:n.pageY})},select:function(){t.isInterfaceLocked()||this.trigger("select",this.model)},toBucket:function(){return t.isInterfaceLocked()?void 0:(e.trigger("open:cartPopup",this.model),!1)}});return o}),define("bb.text!app/../../resources/tpl/fontpanel/PromoSet.html",[],function(){return'<span class="icon-fontpack"></span>\r\n<span class="fullName">{{fullName}}</span>\r\n    <div class="buttonLine">\r\n        <div class="oldPrice">{{price}}<b></b></div>\r\n        <!--<div class="price">{{ price }}</div>-->\r\n        {% if isInBucket %}\r\n        <div class="toBucket selected"><span class="icon-check_big"></span>В корзине</div>\r\n        {% else %}\r\n        <div class="toBucket"><span class="icon-in_cart"></span>{{price}}&nbsp;<span class=\'rouble\'>P</span></div>\r\n        {% endif %}\r\n    </div>\r\n<span class="subsets">\r\n    {{subSets|length}}&nbsp;{{ subSets|length|decline ("начертаний", "начертание", "начертания") }}:&nbsp;\r\n    {% for subSet in subSets %}\r\n        <span class="subset">{{subSet.name}}</span>\r\n        {% if not loop.last %},{% endif %}\r\n    {% endfor %}\r\n</span>\r\n<div class="hr"></div>\r\n'}),define("app/views/fontpanel/PromoSetView",["backbone","app/models/AppModel","app/views/fontlist/FontSetView","bb.text!app/../../resources/tpl/fontpanel/PromoSet.html"],function(e,t,n,i){var s=n.extend({className:"FontPromoView",events:{"click .toBucket":"toBucket","click .pangrammeCrop":"select"},initialize:function(){this._template=i,n.prototype.initialize.call(this),this._nightMode=!1},setNightMode:function(){this._nightMode=!1},render:function(){this._nightMode=!1,n.prototype.render.call(this)},toFavorites:function(n){t.isInterfaceLocked()||e.trigger("open:favoritesMenu",this.model,{x:n.pageX,y:n.pageY})},select:function(){t.isInterfaceLocked()||this.trigger("select",this.model)}});return s}),define("bb.text!app/../../resources/tpl/fontpanel/FontFamily.html",[],function(){return'<div class="fontName">{{ setName }}</div>\r\n\r\n<div class="fontstyleBtns">\r\n    <div class="btn toTypeTester {% if isInTypeTester %} active {% endif %}">\r\n        <b class="icon-in_typetester"></b>Попробовать\r\n    </div>\r\n    <div class="btn">\r\n        <b class="icon-try-on-site"></b>Поставить на сайт\r\n    </div>\r\n    <div class="btn">\r\n        <b class="icon-in_cart"></b>Купить гарнитуру\r\n    </div>\r\n    <div class="btn btnFav">\r\n        <b class="icon-in_favorites"></b>\r\n    </div>\r\n</div>\r\n\r\n<div class="fontstyleContentInner">\r\n\r\n    <div class="fontstyleTags">\r\n        {% for tag in tags %}<div>{{ tag }}</div>{% endfor %}\r\n        <div class="more"></div>\r\n    </div>\r\n\r\n    <div class="description">\r\n        {{ description }}\r\n        <div class="more"></div>\r\n    </div>\r\n\r\n    <div class="bigTabs">\r\n        <div class="gallery">\r\n            <b class="icon-gallery"></b>\r\n            <span>Галерея примеров</span>\r\n        </div>\r\n        <div class="pdf">\r\n            <b class="icon-download_pdf"></b>\r\n            <span>Скачать PDF</span>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="SwitchersPanelView bgWhite">\r\n        <div id="SwitcherPangrammeView"></div>\r\n        <div id="SwitcherSizeView"></div>\r\n    </div>\r\n    <div class="fontsHolder"></div>\r\n\r\n</div>\r\n'
}),define("app/views/fontpanel/FontFamilyView",["app/models/AppModel","backbone","app/models/FontSetModel","app/views/fontpanel/FontSetView","app/views/fontpanel/PromoSetView","app/views/switchers/SwitcherPangrammeView","app/views/switchers/SwitcherSizeView","jq.mCustomScrollbar","bb.text!app/../../resources/tpl/fontpanel/FontFamily.html"],function(e,t,n,i,s,o,r,a,l){var c=t.View.extend({tagName:"div",className:"FontFamilyView",_views:[],events:{"click .btnFav":"toFavorites","click .btn.toTypeTester":"toTypeTester","click .tab.exit":"onClose","click .description .more":"onDescriptionMore","click .fontstyleTags .more":"onTagsMore"},initialize:function(){_.bindAll(this,"render"),this.swPangramme=new o,this.swSize=new r,this.render()},render:function(){this.$el.attr("id",this.cid),this.$el.html(e.nunjucks.renderString(l,this.model.toJSON())),this.$("#SwitcherPangrammeView").append(this.swPangramme.el),this.$("#SwitcherSizeView").append(this.swSize.el),_.each(this._views,function(e){e.remove()}),this._views=[];var t=document.createDocumentFragment();return _.each(this.model.get("subSets"),function(e){var s=new n({id:e.id});s.fetch();var o=new i({model:s});t.appendChild(o.el),this.listenTo(o,"select",this.onFontSelect),this._views.push(o)},this),_.each(this.model.get("promoSets"),function(e){var i=new n({id:e.id});i.fetch();var o=new s({model:i});t.appendChild(o.el),this.listenTo(o,"select",this.onFontSelect),this._views.push(o)},this),this.$(".fontsHolder").append(t),this.$(".fontstyleContentInner").mCustomScrollbar({theme:"dark"}),this},invalidate:function(){this.$(".fontstyleContentInner").mCustomScrollbar("update"),this.delegateEvents(),this.swPangramme.invalidate(),this.swSize.invalidate()},onClickSelector:function(e){var t=$(e.target).closest(".selector");t.addClass("opened"),$("body").bind("mousedown",this.onCloseSelector)},onCloseSelector:function(){setTimeout(function(){$("body").unbind("mousedown",this.onCloseSelector),$(".selector").removeClass("opened")},100)},onClose:function(){t.trigger("close:fontstyle")},onFontSelect:function(t){e.isInterfaceLocked()||this.trigger("select",t)},toFavorites:function(n){e.isInterfaceLocked()||t.trigger("open:favoritesMenu",this.model,{x:n.pageX,y:n.pageY})},toTypeTester:function(){e.isInterfaceLocked()||(this.$(".btn.toTypeTester").toggleClass("active"),this.model.set("isInTypeTester",!this.model.get("isInTypeTester")))},goToBargains:function(){e.isInterfaceLocked()||this.$(".fontstyleContentInner").mCustomScrollbar("scrollTo",".FontPromoView:first")},onDescriptionMore:function(){this.$(".description").toggleClass("oppened")},onTagsMore:function(){this.$(".fontstyleTags").toggleClass("oppened")}});return c}),define("bb.text!app/../../resources/tpl/fontpanel/Glyphs.html",[],function(){return'<div class="top">\r\n    <div class="codes on">\r\n        <span class="on">Выключить коды</span>\r\n        <span class="off">Включить коды</span>\r\n    </div>\r\n\r\n    {% for set in sets %}\r\n        <div id="glyphSet_{{set.id}}" class="codeSet {{set.icon}} {% if set.id == selectedSet.id %}active{% endif %}"></div>\r\n    {% endfor %}\r\n</div>\r\n<div class="symbols">\r\n    {% for code in selectedSet.codes %}\r\n    <div class="codeSet {{set.icon}}"><span>{{code}}</span>&#x{{code}}</div>\r\n    {% endfor %}\r\n</div>\r\n\r\n'}),define("app/views/fontpanel/GlyphsView",["app/models/AppModel","backbone","bb.text!app/../../resources/tpl/fontpanel/Glyphs.html"],function(e,t,n){var i=t.Model.extend({url:function(){return"/jsonGlyphs/"+this.get("id")},parse:function(e){return{id:this.get("id"),sets:e}}}),s=t.View.extend({tagName:"div",className:"GlyphsView",_selectedId:null,_fontModel:null,events:{"click .codeSet":"onSet","click .codes":"onCodes"},initialize:function(){_.bindAll(this,"render","glypshRender"),this._fontModel=this.model,this.model=new i({id:this.model.id}),this.listenTo(this.model,"change",this.glypshRender),this.model.fetch()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(e.nunjucks.renderString(n,this.model.toJSON())),this},glypshRender:function(){var t=this.model.toJSON().sets;this._selectedId=this._selectedId?this._selectedId:t[0].id;var i=_.findWhere(t,{id:this._selectedId});return this.$el.html(e.nunjucks.renderString(n,{sets:t,selectedSet:i})),this},invalidate:function(){},onSet:function(e){var t=e.target.id.substr(9);t!==this._selectedId&&(this._selectedId=t,this.glypshRender(),this.trigger("change"))},onCodes:function(){this.$(".codes").toggleClass("on"),this.$(".symbols").toggleClass("nocodes")}});return s}),define("bb.text!app/../../resources/tpl/fontpanel/Font.html",[],function(){return'{% macro textBlock(fontsize=16, lineheight=16, class="", text="") %}\r\n<div class="TextBlock {{class}}" style="font-size:{{fontsize}}px; line-height:{{lineheight}}px">\r\n    <div class="top">\r\n        <b class="icon-fontsize"></b>\r\n        <div class="clicker fontsize">\r\n            <input type="text" value="{{fontsize}}" min="10" max="99" maxlength="2">\r\n            <div class="clickerUp icon-littlearrow_up"></div>\r\n            <div class="clickerDown icon-littlearrow_down"></div>\r\n        </div>\r\n        <b class="icon-line_height"></b>\r\n        <div class="clicker lineheight">\r\n            <input type="text" value="{{lineheight}}" min="10" max="99" maxlength="2">\r\n            <div class="clickerUp icon-littlearrow_up"></div>\r\n            <div class="clickerDown icon-littlearrow_down"></div>\r\n        </div>\r\n    </div>\r\n    <div class="text">{{text}}</div>\r\n    <textarea>{{text}}</textarea>\r\n</div>\r\n{% endmacro %}\r\n\r\n\r\n\r\n<div class="fontName">\r\n    {{fullName}}\r\n</div>\r\n\r\n<div class="fontstyleBtns">\r\n    <div class="btn  toTypeTester {% if isInTypeTester %} active {% endif %}">\r\n        <b class="icon-in_typetester"></b>Попробовать\r\n    </div>\r\n    <div class="btn">\r\n        <b class="icon-try-on-site"></b>Поставить на сайт\r\n    </div>\r\n    <div class="btn">\r\n        <b class="icon-in_cart"></b>Купить гарнитуру\r\n    </div>\r\n    <div class="btn btnFav">\r\n        <b class="icon-in_favorites"></b>\r\n    </div>\r\n</div>\r\n\r\n<div class="fontstyleContentInner">\r\n\r\n    <div class="contentInner">\r\n\r\n        <div class="contentPreview">\r\n            <div class="preview">\r\n                {{ textBlock(36, 36, "", "О различии между чистым и эмпирическим познанием") }}\r\n\r\n                {{ textBlock(24, 24, "", "Без сомнения, всякое наше познание начинается с опыта; в самом деле, чем же пробуждалась бы к деятельности познавательная способность, если не предметами, которые действуют на наши чувства и отчасти сами производят представления, отчасти побуждают наш рассудок сравнивать их, связывать или разделять.") }}\r\n\r\n                {{ textBlock(class="left", text="Без сомнения, всякое наше познание начинается с опыта; в самом деле, чем же пробуждалась бы к деятельности познавательная способность, если не предметами, которые действуют на наши чувства и отчасти сами производят представления, отчасти побуждают наш рассудок сравнивать их, связывать или разделять.") }}\r\n\r\n                {{ textBlock(class="right", text="Но хотя всякое наше познание и начинается с опыта, отсюда вовсе не следует, что оно целиком происходит из опыта. Вполне возможно, что даже наше опытное знание складывается из того, что мы воспринимаем посредством впечатлений, и из того, что наша собственная познавательная способность (только побуждаемая чувственными впечатлениями) дает от себя самой, причем это добавление мы отличаем от основного чувственного материала лишь тогда, когда продолжительное упражнение обращает на него наше внимание и делает нас способными к обособлению его.") }}\r\n\r\n            </div>\r\n        </div>\r\n        <div class="contentGlyphs">\r\n            <div class="glyphs"></div>\r\n        </div>\r\n        <div class="contentLanguages">\r\n            <div class="languages">\r\n                <div class="languagesTitle">\r\n                    Набор символов начертания поддерживает следующие языки:\r\n                </div>\r\n                <div class="languagesContent">\r\n                    {% for lang in languages %}\r\n                        <div>{{lang.label}} <span>({{lang.script|truncate(3, True, ".")}})</span></div>\r\n                    {% endfor %}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n'}),define("app/views/fontpanel/FontView",["app/models/AppModel","backbone","app/models/FontSetModel","jq.mCustomScrollbar","app/views/fontpanel/GlyphsView","bb.text!app/../../resources/tpl/fontpanel/Font.html","gs.TweenLite","jq.stepper"],function(e,t,n,i,s,o,r){function a(e){e&&e.get("css")&&$("head link#fontpanel_"+e.get("fontFace").split(" ").join("_")).remove()}function l(e){if(e&&e.get("css")){var t=$("head link#fontpanel_"+e.get("fontFace"));0===t.length&&$("head").append(["<link id='fontpanel_",e.get("fontFace").split(" ").join("_"),"' type='text/css' rel='stylesheet' href='",e.get("css"),"' />"].join(""))}}var c=t.View.extend({events:{"change .fontsize input":"onChange","change .lineheight input":"onChange"},initialize:function(){_.bindAll(this,"onChange"),this.delegateEvents()},onChange:function(){var e=this.$(".fontsize input").val(),t=this.$(".lineheight input").val();this.$el.css({"font-size":e+"px","line-height":t+"px"})}}),d=t.View.extend({tagName:"div",className:"FontView",_glyphsView:null,_tbView:null,events:{"click .btnFav":"toFavorites","click .btn.toTypeTester":"toTypeTester","click .tab.exit":"onClose","click .TextBlock":"activeTextBlock"},initialize:function(){_.bindAll(this,"render","inactiveTextBlock"),l(this.model),this._glyphsView=new s({model:this.model}),this.listenTo(this._glyphsView,"change",this.invalidate),this.render(),_.each(this.$(".clicker"),function(e){e=$(e),e.find("input").stepper({up:e.find(".clickerUp"),down:e.find(".clickerDown")}).on("change",this._stepTo)},this)},remove:function(){a(this.model),$("body").unbind("click",this.activeTextBlock),t.View.prototype.remove.call(this),t.View.prototype.remove()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(e.nunjucks.renderString(o,this.model.toJSON())),this.$(".glyphs").html(this._glyphsView.el),this._glyphsView.invalidate(),this.$(".contentPreview").mCustomScrollbar({theme:"dark"}),this.$(".contentGlyphs").mCustomScrollbar({theme:"dark"}),this.$(".contentLanguages").mCustomScrollbar({theme:"dark"}),this.$(".contentPreview .TextBlock .text").css("font-family",this.model.get("fontFace")),this.$(".contentGlyphs").css("font-family",this.model.get("fontFace")),this},invalidate:function(){this.$(".contentPreview").mCustomScrollbar("update"),this.$(".contentGlyphs").mCustomScrollbar("update"),this.$(".contentLanguages").mCustomScrollbar("update"),$("body").bind("mousedown",this.inactiveTextBlock),this.delegateEvents()},onClose:function(){e.isInterfaceLocked()||t.trigger("close:fontstyle")},toTypeTester:function(){e.isInterfaceLocked()||(this.$(".btn.toTypeTester").toggleClass("active"),this.model.set("isInTypeTester",!this.model.get("isInTypeTester")))},toFavorites:function(n){e.isInterfaceLocked()||t.trigger("open:favoritesMenu",this.model,{x:n.pageX,y:n.pageY})},goTop:function(){e.isInterfaceLocked()||r.to(this.$(".contentInner"),.3,{top:0})},goToGlyphs:function(){e.isInterfaceLocked()||r.to(this.$(".contentInner"),.3,{top:"-100%"})},goToLanguages:function(){e.isInterfaceLocked()||r.to(this.$(".contentInner"),.3,{top:"-200%"})},inactiveTextBlock:function(e){var t=$(e.target).closest(".TextBlock");t.length>0?(t=t[0],this.$(".TextBlock").each(function(e,n){n!=t&&$(n).removeClass("selected")})):($("body").unbind("click",this.activeTextBlock),this.$(".TextBlock").removeClass("selected"))},activeTextBlock:function(e){var t=$(e.target).closest(".TextBlock");t.addClass("selected"),this._tbView=new c({el:t}),$("body").bind("mousedown",this.inactiveTextBlock)}});return d}),define("bb.text!app/../../resources/tpl/fontpanel/FontPanel.html",[],function(){return'<div class="leftSide">\r\n    <div class="list">\r\n        <ul>\r\n            <li><div>Palladium</div></li>\r\n            <li><div class="selected">Perfo</div></li>\r\n            <li><div>Petersburg</div></li>\r\n            <li><div>Pollock</div></li>\r\n            <li><div>Popular Script</div></li>\r\n            <li><div>Poster Bodoni</div></li>\r\n            <li><div>Pragmatica</div></li>\r\n            <li><div>Pravda</div></li>\r\n            <li><div>Priamoj</div></li>\r\n            <li><div>Probel</div></li>\r\n            <li><div>PT Sans Pro</div></li>\r\n            <li><div>Pt Serif Pro</div></li>\r\n            <li><div>Palladium</div></li>\r\n            <li><div>Perfo</div></li>\r\n            <li><div>Petersburg</div></li>\r\n            <li><div>Pollock</div></li>\r\n            <li><div>Popular Script</div></li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n\r\n<div class="mainSide">\r\n\r\n    <div class="VerticalTabs">\r\n        <div class="tab exit noBorder"><b class="icon-close"></b></div>\r\n        <div></div>\r\n        <div class="tab kit"><b class="icon-page"></b><span>Набор</span></div>\r\n        <div class="tab glyphs"><b class="icon-glyphs"></b><span>Глифы</span></div>\r\n        <div class="tab lang"><b class="icon-languages"></b><span>Языки</span></div>\r\n\r\n        <div class="tab bargains"><b class="icon-go_down"></b><span>Выгодные варианты покупки</span></div>\r\n    </div>\r\n\r\n    <div class="content fontstyleContent">\r\n        <div class="pair">\r\n            <div class="leftTab"></div>\r\n            <div class="rightTab"></div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n\r\n'}),define("app/views/fontpanel/FontPanelView",["backbone","app/models/AppModel","app/models/FontSetModel","app/views/fontpanel/FontFamilyView","app/views/fontpanel/FontView","gs.TweenLite","bb.text!app/../../resources/tpl/fontpanel/FontPanel.html"],function(e,t,n,i,s,o,r){var a=e.View.extend({tagName:"div",className:"FontPanelView",_familyView:null,_fontView:null,_isDeep:!1,events:{"click .selector":"onClickSelector","click .tab.exit":"onExit","click .tab.kit":"onGoTop","click .tab.glyphs":"onGoGlyphs","click .tab.lang":"onGoLanguages","click .tab.bargains":"onGoBargains"},initialize:function(){_.bindAll(this,"render","destroyContent"),this.render(),this.onOpenFamily()},reset:function(e){this.model=e,this._familyView&&(this._familyView.remove(),this._familyView=null),this.render(),this.onOpenFamily()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(r)),this.invalidate(),this},onExit:function(){this._isDeep?(this.onOpenFamily(),this.invalidate()):e.trigger("close:fontstyle")},onOpenFamily:function(){this.makeFamily()},onOpenFont:function(e){this.$el.addClass("opened"),this.makeFontView(e)},destroyContent:function(){this.$(".content").empty()},makeFamily:function(){this._isDeep=!1,this._fontView=null,this.$(".VerticalTabs").addClass("fontfamily");var e=this.model.get("promoSets");e&&e.length>0?this.$(".VerticalTabs .bargains").css("display","block"):this.$(".VerticalTabs .bargains").css("display","none"),this._familyView=new i({model:this.model}),this.listenTo(this._familyView,"select",this.onOpenFont),this.$(".content .leftTab").html(this._familyView.el),o.to(this.$(".content .pair"),.3,{"margin-left":"0%",onComplete:function(e){e.$(".content .rightTab").empty(),e._familyView.invalidate()},onCompleteParams:[this]})},makeFontView:function(e){this._isDeep=!0,this._familyView=null,this.$(".VerticalTabs").removeClass("fontfamily"),this.$(".VerticalTabs .bargains").css("display","none"),this._fontView=new s({model:e}),this.$(".content .rightTab").html(this._fontView.el),o.to(this.$(".content .pair"),.3,{"margin-left":"-100%",onComplete:function(e){e.$(".content .leftTab").empty(),e._fontView.invalidate()},onCompleteParams:[this]}),this.onGoTop()},invalidate:function(){this._familyView&&this._familyView.invalidate(),this._fontView&&this._fontView.invalidate(),this.delegateEvents()},onGoTop:function(){t.isInterfaceLocked()||(this.$(".tab").removeClass("active"),this.$(".tab.kit").addClass("active"),this._fontView.goTop())},onGoGlyphs:function(){t.isInterfaceLocked()||(this.$(".tab").removeClass("active"),this.$(".tab.glyphs").addClass("active"),this._fontView.goToGlyphs())},onGoLanguages:function(){t.isInterfaceLocked()||(this.$(".tab").removeClass("active"),this.$(".tab.lang").addClass("active"),this._fontView.goToLanguages())},onGoBargains:function(){t.isInterfaceLocked()||this._familyView.goToBargains()}});return a}),define("bb.text!app/../../resources/tpl/promo/promoBanner.html",[],function(){return'<!--\n    для блоков item и itemImg анимируется параметр top\n-->\n<div class="items">\n    {% for item in slides %}\n        <div class="item"  data-id="{{loop.index0}}" style="font-family:\'{{item.fontFace}}\';">\n            <div class="itemImg" style="background-image: url(\'{{item.image}}\');"></div>\n            <div class="itemText">{{item.text|safe}}</div>\n        </div>\n    {% endfor %}\n        <div class="item" data-id="0" style="font-family:\'{{slides[0].fontFace}}\';">\n            <div class="itemImg" style="background-image: url(\'{{slides[0].image}}\');"></div>\n            <div class="itemText">{{slides[0].text|safe}}</div>\n        </div>\n</div>\n<ul class="nav">\n    {% for item in slides %}\n    <li {% if loop.first %}class="selected"{% endif %}></li>\n    {% endfor %}\n</ul>\n'}),define("app/views/promo/PromoBannerView",["backbone","app/models/AppModel","gs.TweenLite","bb.text!app/../../resources/tpl/promo/promoBanner.html"],function(e,t,n,i){var s=e.View.extend({tagName:"div",className:"promoBanner",template:i,_length:0,_firtsItem:null,_items:null,_interval:null,events:{"click .item":"onSelect"},initialize:function(){_.bindAll(this,"render","invalidate","slideTo","remove","slideInside"),this.render(),"promoBanner"===this.className&&(this._length=this.model.slides.length,this._currentSlide=0,this._interval=setInterval(this.slideTo,8e3),this.slideInside(0))},render:function(){return this.$el.attr("id",this.cid),_.each(this.model.slides,function(e){e.font&&(e.fontFace=e.font.get("fontFace"))}),this.$el.html(t.nunjucks.renderString(this.template,this.model)),this._firtsItem=this.$(".item:first"),this._items=this.$(".items"),this},invalidate:function(){},remove:function(){clearInterval(this._interval),e.View.prototype.remove.call(this)},slideInside:function(e){var t=this.$(".items .item:eq("+e+") .itemImg");t.css({top:0}),n.to(t,8,{top:"-10%"})},slideTo:function(){var e=this._items.height();this._firtsItem.css("margin-top",-(e*this._currentSlide)),this._currentSlide++,n.to(this._firtsItem,.6,{"margin-top":-(e*this._currentSlide)}),this.slideInside(this._currentSlide),this._currentSlide=this._currentSlide==this._length?0:this._currentSlide,this.$(".nav li").removeClass("selected"),this.$(".nav li:eq("+this._currentSlide+")").addClass("selected")},onSelect:function(t){var n=parseInt($(t.target).closest(".item").attr("data-id"),10);e.trigger("open:news",this.model.slides[n])}});return s}),define("bb.text!app/../../resources/tpl/promo/promoCompilation.html",[],function(){return'<div class="items">\n    {% for item in slides %}\n        <div class="item" data-id="{{loop.index0}}">\n            <div class="itemImg" style="background-image: url(\'{{item.image}}\');"></div>\n            <div class="itemText">{{item.text|safe}}</div>\n        </div>\n    {% endfor %}\n</div>\n'}),define("app/views/promo/PromoCompilationView",["backbone","app/events/FilterEvent","app/views/promo/PromoBannerView","bb.text!app/../../resources/tpl/promo/promoCompilation.html"],function(e,t,n,i){var s=n.extend({template:i,className:"promoCompilations",slideTo:function(){},onSelect:function(n){var i=parseInt($(n.target).closest(".item").attr("data-id"),10);e.trigger(t.ADD,{type:"promo",name:this.model.slides[i].name,label:this.model.slides[i].label}),e.trigger("open:infoBlock",this.model.slides[i])}});return s}),define("bb.text!app/../../resources/tpl/promo/promoFeatured.html",[],function(){return'<div class="items">\n    {% for item in slides %}\n        {% if item.font %}\n            <div data-id="{{loop.index0}}" class="item {% if loop.index % 2 == 0 %}black{%endif%}" style="font-family:\'{{item.fontFace}}\';" >\n                <div class="itemLetters"><b></b><span>Aa</span></div>\n                <div class="itemInfo">\n                    <div class="itemTitle">{{item.font.fontName}}</div>\n                    <div class="itemText">\n                        AaBbCcDdEeFfGgHhIiJjKkLl<br>\n                        АаБбВвГгДдЕеЖжЗзИиЙйКк\n                    </div>\n                </div>\n                <div class="itemHover">\n                    <div>\n                        <div class="center">\n                            <div class="itemAbout">{{item.text|safe}}</div>\n                            <div class="btn"><div>\n                                <span class="match">{{item.font.match}}&nbsp;\n                                    {{ item.font.match|decline ("начертаний", "начертание", "начертания") }}\n                                    &nbsp;из&nbsp;{{item.font.subSets.length}}\n                                </span>\n                                <span class="price">от&nbsp;{{item.font.price}}&nbsp;&#x20B7;</span>\n                            </div></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        {% else %}\n            <div data-id="{{loop.index0}}" class="item">\n                <div class="itemImg">\n                    <img src="resources/images/img06.jpg" alt=""/>\n                </div>\n                <div class="itemTitle bold">{{item.title|safe}}</div>\n                <div class="itemHover">\n                    <div>\n                        <div class="center">\n                            <div class="itemCount">{{item.text|safe}}</div>\n                            <div class="btn"><div>{{item.button}}</div></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        {% endif %}\n    {% endfor %}\n</div>\n'}),define("app/views/promo/PromoFeaturedView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/promo/promoFeatured.html"],function(e,t,n){var i=e.View.extend({tagName:"div",className:"promoFeatured",events:{"click .btn":"onBuyButton"},initialize:function(){_.bindAll(this,"render","invalidate"),$(window).bind("resize",this.invalidate),setTimeout(this.invalidate,1e3),this.render()},render:function(){return this.$el.attr("id",this.cid),_.each(this.model.slides,function(e){e.font&&(e.fontFace=e.font.get("fontFace"))}),this.$el.html(t.nunjucks.renderString(n,this.model)),this},remove:function(){$(window).unbind("resize",this.invalidate),e.View.prototype.remove.call(this)},invalidate:function(){var e=this.$(".itemLetters").first().width();this.$(".itemLetters>span").each(function(t,n){n=$(n);for(var i=200;e<=n.width();)i-=2,n.css("font-size",i)})},onBuyButton:function(t){var n=parseInt($(t.target).closest(".item").attr("data-id"),10);this.model.slides[n].link?document.location.href=this.model.slides[n].link:this.model.slides[n].font?(e.trigger("open:fontstyle",this.model.slides[n].font),e.trigger("close:promo")):e.trigger("open:infoBlock",this.model.slides[n])}});return i}),define("bb.text!app/../../resources/tpl/promo/promo.html",[],function(){return'<!--\n<div class="promoBanner">\n    <div class="items">\n        <div class="item">\n            <div class="itemImg" style="background-image: url(\'resources/images/img01.jpg\');"></div>\n            <div class="itemText">\n                <span>Bodoni —</span><br>\n                изящная<br> статическая антиква<br> для акцидентного<br> набора\n            </div>\n        </div>\n        <div class="item">\n            <div class="itemImg" style="background-image: url(\'resources/images/img02.jpg\');"></div>\n            <div class="itemText">\n                <span>Circus Didot —</span><br>\n                конструктивистская<br> переработка модели<br> классицистической<br> антиквы\n            </div>\n        </div>\n        <div class="item">\n            <div class="itemImg" style="background-image: url(\'resources/images/img03.jpg\');"></div>\n            <div class="itemText">\n                <span>Pragmatica —</span><br>\n                рационалистический<br> гротеск с памятью<br>о швейцарских<br> корнях\n            </div>\n        </div>\n    </div>\n    <ul class="nav">\n        <li></li>\n        <li></li>\n        <li></li>\n    </ul>\n</div>\n\n<div class="promoFeatured">\n    <div class="items">\n        <div class="item">\n            <div class="itemLetters">\n                <b></b>Aa\n            </div>\n            <div class="itemTitle">\n                Journal Sans\n            </div>\n            <div class="itemText">\n                AaBbCcDdEeFfGgHhIiJjKkLl\n                АаБбВвГгДдЕеЖжЗзИиЙйКк\n            </div>\n            <div class="itemHover">\n                <div>\n                    <div class="center">\n                        <div class="itemAbout">\n                            Геометрический гротеск с выраженным характером первой половины XX века\n                        </div>\n                        <div class="btn"><div>6 начертаний от 950</div></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="item black">\n            <div class="itemLetters">\n                <b></b>Aa\n            </div>\n            <div class="itemTitle">\n                PT Serif\n            </div>\n            <div class="itemText">\n                AaBbCcDdEeFfGgHhIiJjKkLl\n                АаБбВвГгДдЕеЖжЗзИиЙйКк\n            </div>\n            <div class="itemHover">\n                <div>\n                    <div class="center">\n                        <div class="itemAbout">\n                            Универсальная антиквенная гарнитура для совместного применения с гротеском PT Sans Pro\n                        </div>\n                        <div class="btn"><div>6 начертаний от 950</div></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="item">\n            <div class="itemImg">\n                <img src="resources/images/img06.jpg" alt=""/>\n            </div>\n            <div class="itemTitle bold">\n                БиблиотекаParaType Originals 2012\n            </div>\n            <div class="itemHover">\n                <div>\n                    <div class="center">\n                        <div class="itemCount">\n                            <span>150</span>\n                            кириллических<br>шрифтов\n                        </div>\n                        <div class="btn"><div>Состав коллекции</div></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="item black">\n            <div class="itemLetters">\n                <b></b>Aa\n            </div>\n            <div class="itemTitle">\n                PT Serif\n            </div>\n            <div class="itemText">\n                AaBbCcDdEeFfGgHhIiJjKkLl\n                АаБбВвГгДдЕеЖжЗзИиЙйКк\n            </div>\n            <div class="itemHover">\n                <div>\n                    <div class="center">\n                        <div class="itemAbout">\n                            Универсальная антиквенная гарнитура для совместного применения с гротеском PT Sans Pro\n                        </div>\n                        <div class="btn"><div>6 начертаний от 950</div></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="promoCompilations">\n    <div class="items">\n        <div class="item">\n            <div class="itemImg" style="background-image: url(\'resources/images/img04.jpg\');"></div>\n            <div class="itemText">\n                10 шрифтовдля журналов\n            </div>\n        </div>\n        <div class="item">\n            <div class="itemImg" style="background-image: url(\'resources/images/img05.jpg\');"></div>\n            <div class="itemText">\n                Любимые шрифтыДимы Барбанеля\n            </div>\n        </div>\n        <div class="item">\n            <div class="itemImg" style="background-image: url(\'resources/images/img04.jpg\');"></div>\n            <div class="itemText">\n                10 шрифтовдля журналов\n            </div>\n        </div>\n    </div>\n</div>\n-->\n'}),define("app/views/promo/PromoView",["backbone","app/models/AppModel","app/models/FontSetModel","app/views/promo/PromoBannerView","app/views/promo/PromoCompilationView","app/views/promo/PromoFeaturedView","bb.text!app/../../resources/tpl/promo/promo.html"],function(e,t,n,i,s,o){function r(){$("head link[id^='promo']").remove()}function a(e){if(e&&e.css){var t=$("head link#tester_"+e.fontFace);0===t.length&&$("head").append(["<link id='promo_",e.fontFace.split(" ").join("_"),"' type='text/css' rel='stylesheet' href='",e.css,"' />"].join(""))}}var l={name:"promo_something",label:"promo_something",slides:[{font:new n(window.fonts[1]),text:"<span>Pragmatica —</span><br/>рационалистический<br/>гротеск с памятью<br/>о швейцарских<br/>корнях",image:"resources/images/img01.jpg"},{font:new n(window.fonts[2]),text:"<span>Circus Didot —</span><br/>конструктивисткая<br/>переработка модели<br/>классицистической<br/>антиквы",image:"resources/images/img02.jpg"},{font:new n(window.fonts[0]),text:"<span>Bododni —</span><br/>изящная<br/>статическая антиква<br/>для акцидентного<br/>набора",image:"resources/images/img03.jpg"}]},c={slides:[{font:new n(window.fonts[0]),text:"Геометрический гротеск с выраженным характером первой половины XX века"},{font:new n(window.fonts[1]),text:"Универсальная антиквенная гарнитура для совместного применения с гротеском PT Sans Pro"},{type:"fontSet",title:"Библиотека ParaType Originals 2012",text:"<span>150</span>кириллических<br>шрифтов",description:"Новая библиотека ParaType Originals 2012 включает 150 начертаний кириллических шрифтов, созданных в компании ПараТайп в 2011 и 2012 годах. В комплект входят: антиквы — 108 начертаний, гротески — 20 начертаний, декоративные шрифты — 14 начертаний, рукописные шрифты — 6 начертаний, символьные — 2 начертания. Библиотека поставляется вместе с книгой «Цифровые шрифты» — каталогом шрифтов компании ПараТайп.",button:"Состав коллекции",image:"resources/images/img03.jpg",price:99,buy:"Open Type:",collections:[{id:"1",name:"ParaType Originals 1998"},{id:"1",name:"ParaType Originals 2002"},{id:"1",name:"ParaType Originals 2004"},{id:"1",name:"ParaType Originals 2006"},{id:"1",name:"ParaType Originals 2008"},{id:"1",name:"ParaType Originals 2010"},{id:"1",name:"ParaType Addendum"},{id:"1",name:"ParaType Goodwill"},{id:"1",name:"ParaType Vintage"},{id:"1",name:"Parangon"}]}]},d={slides:[{name:"promo_10fonts",label:"10 шрифтов для журналов",text:"10 шрифтов для журналов",image:"resources/images/img04.jpg",description:"«Нам важно показать, что наше дело неотделимо от явления жизни в целом, мы не занимаемся дизайном с 9 до 17, мы просто живём. Работа над образом не прекращается, и всё, что мы ощущаем и делаем, идёт в один огромный проект жизни, которая, условно, бадяжится на множестве маленьких проектов и заказов. Мы специально убрали ребят из города, чтобы их отпустила суетность того шумного пространства, которое не даёт осознать, что жизнь — это сейчас. Только осознавая это, ты можешь быть включённым в процесс, просто потому что ты не ищешь что-то на Behance и FFFOUND. Нужно искать образы в своей жизни, тогда получается честно и точно, потому что ты и есть то мерило, которым всё мерится. Наша методика выстроена на простых штуках, мы часто просто говорим себе «Почему нет?», и это на самом деле наш основной принцип. Мы хотим показать, что часто самое странное решение оказывается для рынка самым эффективным, главное, допустить такую возможность — это очень сложная психологическая задача»."},{name:"promo_dima",label:"Дима Барбанель",text:"Любимые шрифты Димы Барбанеля",image:"resources/images/img05.jpg",description:"«Нам важно показать, что наше дело неотделимо от явления жизни в целом, мы не занимаемся дизайном с 9 до 17, мы просто живём. Работа над образом не прекращается, и всё, что мы ощущаем и делаем, идёт в один огромный проект жизни, которая, условно, бадяжится на множестве маленьких проектов и заказов. Мы специально убрали ребят из города, чтобы их отпустила суетность того шумного пространства, которое не даёт осознать, что жизнь — это сейчас. Только осознавая это, ты можешь быть включённым в процесс, просто потому что ты не ищешь что-то на Behance и FFFOUND. Нужно искать образы в своей жизни, тогда получается честно и точно, потому что ты и есть то мерило, которым всё мерится. Наша методика выстроена на простых штуках, мы часто просто говорим себе «Почему нет?», и это на самом деле наш основной принцип. Мы хотим показать, что часто самое странное решение оказывается для рынка самым эффективным, главное, допустить такую возможность — это очень сложная психологическая задача»."}]},u=e.View.extend({tagName:"div",className:"PromoView",_bannerView:null,_compilationView:null,_featuredView:null,events:{},initialize:function(){_.bindAll(this,"render","close");
var e=_.pluck(l.slides,"font");e=e.concat(_.pluck(d.slides,"font")),e=e.concat(_.pluck(c.slides,"font")),e=_.compact(e),_.each(e,function(e){a(e)}),this._bannerView=new i({model:l}),this._compilationView=new s({model:d}),this._featuredView=new o({model:c}),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.append(this._bannerView.el),this.$el.append(this._featuredView.el),this.$el.append(this._compilationView.el),this},remove:function(){r(),this._bannerView.remove(),this._compilationView.remove(),this._featuredView.remove(),e.View.prototype.remove.call(this)},invalidate:function(){this._featuredView.invalidate()},close:function(){}});return u}),define("bb.text!app/../../resources/tpl/infoblock/infoBlock.html",[],function(){return'<div class="itemImg" style="background-image: url(\'{{image}}\');">\n    <div class="infoTitle">\n        <div class="itemText">{{text|safe}}</div>\n        <div class="share">\n            <div class="shareOpen icon-share"></div>\n            <div class="shareContent">\n                <div class="msg">\n                    <div class="shareFolder">Поделиться папкой</div>\n                </div>\n                <div class="shareBtn fb icon-share_fb"></div>\n                <div class="shareBtn tw icon-share_twitter"></div>\n                <div class="shareBtn vk icon-share_vk"></div>\n                <div class="shareBtn link icon-share_link"></div>\n                <div class="shareBtn ok icon-share_complete"></div>\n                <div class="shareClose icon-share_close"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="newsBlock">\n    <div class="itemDescription">{{description|safe}}</div>\n</div>\n\n'}),define("app/views/infoblock/InfoBlockView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/infoblock/infoBlock.html","ZeroClipboard"],function(e,t,n,i){var s=e.View.extend({template:n,tagName:"div",className:"InfoBlockView",events:{"click .shareOpen":"shareOpen","click .shareClose":"shareClose","click .shareBtn":"onShare"},initialize:function(){_.bindAll(this,"render"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(this.template,this.model)),this},remove:function(){e.View.prototype.remove.call(this)},invalidate:function(){this.delegateEvents()},shareOpen:function(){var e=this.$(".share");e.addClass("opened");var n=t.baseUrl+"/info/"+this.model.name,s=this.$(".shareBtn.link");this.clipBoardClient=new i(s),this.clipBoardClient.on("dataRequested",function(e){e.setText(n)}),this.clipBoardClient.on("load",function(t){t.on("complete",function(){e.addClass("copied"),setTimeout(function(){e.removeClass("copied")},2e3)})})},shareClose:function(){this.clipBoardClient&&(this.clipBoardClient.destroy(),this.clipBoardClient=null),this.$(".share").removeClass("opened")},onShare:function(t){var n=$(t.target).closest(".shareBtn");n.hasClass("fb")?e.trigger("share:info","facebook",this.model):n.hasClass("tw")?e.trigger("share:info","twitter",this.model):n.hasClass("vk")&&e.trigger("share:info","vkontakte",this.model)}});return s}),define("bb.text!app/../../resources/tpl/infoblock/fontsetBlock.html",[],function(){return'<div class="other">\n    <div class="otherClose">X</div>\n    {% for collection in collections %}\n        <div class="item">{{collection.name}}</div>\n    {% endfor %}\n</div>\n\n<div class="otherOpen">другие коллекции</div>\n<img src="resources/images/img06.jpg" alt=""/>\n<div class="itemText">{{title}}</div>\n<div class="description">{{description}}</div>\n<div class="toBucket"><span class="icon-in_cart">{{buy}}</span>{{price}}&nbsp;&#x20B7;</div>\n'}),define("app/views/infoblock/FontsetBlockView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/infoblock/fontsetBlock.html"],function(e,t,n){var i=e.View.extend({template:n,tagName:"div",className:"FontsetBlockView",events:{"click .otherOpen":"otherOpen","click .otherClose":"otherClose","click .toBucket":"toBucket"},initialize:function(){_.bindAll(this,"render"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(this.template,this.model)),this},remove:function(){e.View.prototype.remove.call(this)},invalidate:function(){this.delegateEvents()},otherOpen:function(){this.$(".other").addClass("opened"),this.$(".otherOpen").hide()},otherClose:function(){this.$(".other").removeClass("opened"),this.$(".otherOpen").show()},toBucket:function(){return t.isInterfaceLocked()?void 0:!1}});return i}),define("bb.text!app/../../resources/tpl/adviser/adviserTop.html",[],function(){return'<div class="question" data-id="{{question.id}}">{{question}}</div>\n{%for answer in answers %}\n<div class="answer {% if answer.selected %} selected {% endif %}" data-id="{{loop.index0}}">{{answer.label}}</div>\n{% endfor %}\n<div class="all">all</div>\n<div class="help">?</div>\n'}),define("app/views/promo/AdviserTopView",["backbone","app/models/AppModel","bb.text!app/../../resources/tpl/adviser/adviserTop.html"],function(e,t,n){var i=e.View.extend({tagName:"div",className:"AdviserTopView",events:{"click .answer":"onAnswer","click .all":"onAll","click .help":"onHelp"},initialize:function(){_.bindAll(this,"render"),this.render()},render:function(){return this.$el.attr("id",this.cid),this.$el.html(t.nunjucks.renderString(n,t.getCachedAdviser()[0])),this},remove:function(){e.View.prototype.remove.call(this)},invalidate:function(){},onAnswer:function(n){var i=t.getCachedAdviser()[0].answers[parseInt($(n.target).closest(".answer").data("id"),10)];e.trigger("open:adviser",[i])},onAll:function(){e.trigger("open:adviser",t.getCachedAdviser()[0].answers)},onHelp:function(){}});return i}),define("bb.text!app/../../resources/tpl/news/news.html",[],function(){return'<div class="itemImg" style="background-image: url(\'{{image}}\');">\n    <div class="overlay"></div>\n    <div class="infoTitle">\n        <div class="itemDate">{{date|strftime("%d %B")}}</div>\n        <div class="itemText">{{text|safe}}</div>\n        <div class="share">\n            <div class="shareOpen icon-share"></div>\n            <div class="shareContent">\n                <div class="msg">\n                    <div class="shareFolder">Поделиться новостью</div>\n                </div>\n                <div class="shareBtn fb icon-share_fb"></div>\n                <div class="shareBtn tw icon-share_twitter"></div>\n                <div class="shareBtn vk icon-share_vk"></div>\n                <div class="shareBtn link icon-share_link"></div>\n                <div class="shareBtn ok icon-share_complete"></div>\n                <div class="shareClose icon-share_close"></div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="newsBlock">\n    <div class="itemDescription">{{description|safe}}</div>\n    <div class="shareBottomContent">\n        <div class="shareBlock">\n            <div class="msg">\n                <div class="shareFolder">Поделиться новостью</div>\n            </div>\n            <div class="shareBtn fb icon-share_fb"></div>\n            <div class="shareBtn tw icon-share_twitter"></div>\n            <div class="shareBtn vk icon-share_vk"></div>\n        </div>\n        {% if font %}<div class="button fontPage">Перейти на страницу шрифта</div>{% endif %}\n    </div>\n</div>\n\n<div class="closeNewsWrapper"><div class="closeNews">Перейти в библиотеку шрифттов fonts.ru</div></div>\n\n\n'}),define("app/views/news/NewsView",["backbone","app/models/AppModel","app/models/FontSetModel","app/views/infoblock/InfoBlockView","bb.text!app/../../resources/tpl/news/news.html"],function(e,t,n,i,s){var o=i.extend({tagName:"div",className:"NewsView",template:s,events:{"click .shareOpen":"shareOpen","click .shareClose":"shareClose","click .shareBtn":"onShare","click .closeNews":"onCloseNews","click .button.fontPage":"onFontPage"},initialize:function(){_.bindAll(this,"render"),this.model.description=["<p>Гарнитура Журнальная Рубленая была разработана в Отделе наборных шрифтов НПО Полиграфмаш коллективом дизайнеров под руководством Анатолия Щукина в 1940–1956 годах. В основе шрифта лежат Erbar Grotesk Якоба Эрбара и Metro Уильяма Эддисона Двиггинса — геометрические гротески 1920-х годов с выраженным индустриальным характером. Наряду с «просто» Рубленой и Букварной, Журнальная Рубленая — один из трёх основных текстовых гротесков, применявшихся в СССР. Неудивительно, что шрифт был оцифрован на заре существования шрифтового отдела компании ParaGraph и вплоть до последнего времени сохранялся в таком состоянии — с неточностями в контурах, с межбуквенными расстояниями, прямо заимствованными из металлического набора, и в составе трёх начертаний.</p>","<img src='stubs/newss.jpg' width='880' height='440'/>","<p>2013–2014 годы, с их модой на «неправильные» геометрические гротески, не могли не повлиять на судьбу Журнальной Рубленой. В старой версии Jornal Sans усилиями Олексы Волочая были скорректированы контура и расширен состав знаков. В новой версии, помимо косметических правок, была проведена существенная работа, с тем чтобы приблизить шрифт к современному читателю, к требованиям и вкусам цифровой типографики начала XXI века.</p>","<p>Дизайнер Мария Селезенева заметно переработала рисунок части знаков шрифта, расширила знаковый состав, добавила альтернативы для некоторых неоднозначных букв, полностью изменила межбуквенные расстояния и кернинг. Кроме того, в Журнальной Рубленой Новой появились новые начертания: настоящий курсив (до сих пор Journal Sans Italic был просто наклонным), встречавшееся в советских каталогах начертание Inline на основе жирного, а также заголовочное начертание с пропорциями знаков, максимально приближенными к шрифту Erbar Grotesk.</p>","<p>Новая версия Журнальной Рубленой, сохраняя в себе все особенности, некоторые странности и дух индустриализации 1920-х–1950-х, полностью приспособлена к современной цифровой реальности и может быть интересна как для материалов с историческим характером, так и для современной модной типографики на бумаге и экране.</p>"].join("\n"),this.model.date=new Date,this.model.font=new n(window.fonts[0]),this.render()},onCloseNews:function(){e.trigger("close:news")},onFontPage:function(){e.trigger("open:fontstyle",this.model.font),e.trigger("close:news")}});return o}),function(e){"function"==typeof define&&define.amd?define("jq.scrollTo",["jquery"],e):e(jQuery)}(function(e){function t(t){return e.isFunction(t)||"object"==typeof t?t:{top:t,left:t}}var n=e.scrollTo=function(t,n,i){return e(window).scrollTo(t,n,i)};return n.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},n.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!n)return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(i,s,o){return"object"==typeof s&&(o=s,s=0),"function"==typeof o&&(o={onAfter:o}),"max"==i&&(i=9e9),o=e.extend({},n.defaults,o),s=s||o.duration,o.queue=o.queue&&o.axis.length>1,o.queue&&(s/=2),o.offset=t(o.offset),o.over=t(o.over),this._scrollable().each(function(){function r(e){c.animate(u,s,o.easing,e&&function(){e.call(this,d,o)})}if(null!=i){var a,l=this,c=e(l),d=i,u={},h=c.is("html,body");switch(typeof d){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(d)){d=t(d);break}if(d=h?e(d):e(d,this),!d.length)return;case"object":(d.is||d.style)&&(a=(d=e(d)).offset())}var p=e.isFunction(o.offset)&&o.offset(l,d)||o.offset;e.each(o.axis.split(""),function(e,t){var i="x"==t?"Left":"Top",s=i.toLowerCase(),f="scroll"+i,v=l[f],m=n.max(l,t);if(a)u[f]=a[s]+(h?0:v-c.offset()[s]),o.margin&&(u[f]-=parseInt(d.css("margin"+i))||0,u[f]-=parseInt(d.css("border"+i+"Width"))||0),u[f]+=p[s]||0,o.over[s]&&(u[f]+=d["x"==t?"width":"height"]()*o.over[s]);else{var g=d[s];u[f]=g.slice&&"%"==g.slice(-1)?parseFloat(g)/100*m:g}o.limit&&/^\d+$/.test(u[f])&&(u[f]=u[f]<=0?0:Math.min(u[f],m)),!e&&o.queue&&(v!=u[f]&&r(o.onAfterFirst),delete u[f])}),r(o.onAfter)}}).end()},n.max=function(t,n){var i="x"==n?"Width":"Height",s="scroll"+i;if(!e(t).is("html,body"))return t[s]-e(t)[i.toLowerCase()]();var o="client"+i,r=t.ownerDocument.documentElement,a=t.ownerDocument.body;return Math.max(r[s],a[s])-Math.min(r[o],a[o])},n}),define("app/views/MainView",["backbone","app/models/AppModel","app/routers/MainRouter","app/models/FontSetModel","app/collections/FontSetCollection","app/views/fontlist/FontSetListView","app/views/switchers/SwitchersPanelView","app/views/leftpanel/LeftPanelView","app/views/rightpanel/RightPanelView","app/views/tagpanel/TagPanelView","app/views/typetester/TypetesterView","app/models/TypetesterModel","gs.TweenLite","app/views/popups/FavoritesMenuView","app/views/popups/CartPopupView","app/views/fontpanel/FontPanelView","app/views/promo/PromoView","app/views/infoblock/InfoBlockView","app/views/infoblock/FontsetBlockView","app/views/promo/AdviserTopView","app/views/news/NewsView","jq.scrollTo"],function(e,t,n,i,s,o,r,a,l,c,d,u,h,p,f,v,m,g,b,y,w){var x=e.View.extend({router:null,typeTester:null,leftPanel:null,rightPanel:null,fontPanel:null,tagPanel:null,fontSwitchers:null,fontList:null,fontCollection:null,promoBlock:null,infoBlock:null,advicerBlock:null,newsBlock:null,$verticalSlide:null,$horisontalSlide:null,initialize:function(){_.bindAll(this,"render","navigate","startApp","onFontCollectionChanged"),e.bind("navigate",this.navigate,this),e.bind("startApp",this.startApp,this),$(window).bind("orientationchange",this.triggerResize),this.router=new n({filterCollection:t.getFilters(),filters:t.getPlainFilters()}),e.history.start({pushState:!1,root:"localhost"===document.location.host?"/paratype.src/":""}),this.promoBlock=new m,this.advicerBlock=new y,this.leftPanel=new a,this.rightPanel=new l,this.tagPanel=new c,this.fontSwitchers=new r,this.fontCollection=new s(t.getCachedFonts(),{filters:t.getFilters()}),this.listenTo(this.fontCollection,"sync",this.onFontCollectionChanged),this.fontList=new o({collection:this.fontCollection}),this.listenTo(e,"open:typetester",this.onOpenTypetester),this.listenTo(e,"close:typetester",this.onCloseTypetester),this.listenTo(e,"open:leftpanel",this.onOpenLeftPanel),this.listenTo(e,"close:leftpanel",this.onCloseLeftPanel),this.listenTo(e,"open:tagpanel",this.onOpenTagPanel),this.listenTo(e,"close:tagpanel",this.onCloseTagPanel),this.listenTo(e,"open:favoritesMenu",this.onOpenFavoritesMenu),this.listenTo(e,"open:cartPopup",this.onOpenCartPopup),this.listenTo(e,"open:fontstyle",this.onOpenFontPanel),this.listenTo(e,"close:fontstyle",this.onCloseFontPanel),this.listenTo(e,"close:promo",this.onClosePromo),this.listenTo(e,"open:infoBlock",this.onOpenInfoBlock),this.listenTo(e,"open:news",this.onOpenNewsBlock),this.listenTo(e,"close:news",this.onCloseNews),this.render()},navigate:function(){},triggerResize:function(){$(window).trigger("resize")},startApp:function(){this.initialised=!0},render:function(){this.$("#fontlistView").prepend(this.advicerBlock.$el),this.$("#fontlistView").prepend(this.promoBlock.$el),this.$("#leftPanel").append(this.leftPanel.$el),this.$("#rightPanel").append(this.rightPanel.$el),this.$("#mainPanel #SwitchersPanelView").append(this.tagPanel.$el),this.$("#mainPanel #SwitchersPanelView").append(this.fontSwitchers.$el),this.$("#mainPanel #FontSetListView").append(this.fontList.$el),this.$verticalSlide=this.$("#mainPanel .verticalSlide"),this.$horisontalSlide=this.$("#mainPanel .horisontalSlide"),this.fontList.makeScrollable(),this.promoBlock.invalidate(),this.advicerBlock.invalidate()},onFontCollectionChanged:function(){this.tagPanel.setAllCount(this.fontCollection.allCount)},onOpenTypetester:function(){this.onClosePromo(),this.onCloseFontPanel(),this.typeTester||(this.typeTester=new d({model:t.getTypetesterModel(),panelHolder:this.leftPanel})),this.$("#mainPanel #typetesterView").html(this.typeTester.$el),this.typeTester.delegateEvents(),this.typeTester.invalidate(),h.to(this.$verticalSlide,.4,{top:"-100%"})},onCloseTypetester:function(){h.to(this.$verticalSlide,.4,{top:"0",onComplete:function(e){e.typeTester&&(e.typeTester.close(),e.$("#mainPanel #typetesterView").empty())},onCompleteParams:[this]})},onOpenLeftPanel:function(){this.onClosePromo(),this.onCloseFontPanel(),this.$("#content").addClass("leftPanelOpened")},onCloseLeftPanel:function(){this.$("#content").removeClass("leftPanelOpened")},onOpenTagPanel:function(){this.$("#content").addClass("tagPanelOpened")},onCloseTagPanel:function(){this.$("#content").removeClass("tagPanelOpened")},onOpenFavoritesMenu:function(e,n){if(!t.isInterfaceLocked()){t.lockeInterface(!0);var i=n.y<this.$el.height()/2,s=new p({model:e,down:i});this.$el.append(s.$el),s.$el.css(i?{position:"absolute",left:n.x,top:n.y}:{position:"absolute",left:n.x,top:Math.floor(n.y-s.$el.height()-20)}),s.invalidate()}},onOpenCartPopup:function(e){this.onOpenPopup(new f({model:e}))},onOpenPopup:function(e){t.isInterfaceLocked()||(t.lockeInterface(!0),this.$el.append(e.$el),e.invalidate())},onOpenFontPanel:function(e){this.onClosePromo(),this.onCloseLeftPanel(),this.fontPanel?this.fontPanel.reset(e):(this.fontPanel=new v({model:e}),this.$("#fontstyleView").html(this.fontPanel.$el)),this.$("#fontstyleView").addClass("opened"),this.fontPanel.invalidate()},onCloseFontPanel:function(){this.$("#fontstyleView").removeClass("opened")},onClosePromo:function(){if(this.promoBlock||this.infoBlock||this.newsBlock){var e=this;this.$("#fontlistView .table").show(),this.$("#fontlistView").scrollTo($("#fontlistView .table"),{duration:"slow",onAfter:function(){e.promoBlock&&(e.promoBlock.remove(),e.promoBlock=null),e.infoBlock&&(e.infoBlock.remove(),e.infoBlock=null),e.advicerBlock&&(e.advicerBlock.remove(),e.advicerBlock=null),e.newsBlock&&(e.newsBlock.remove(),e.newsBlock=null)}})}},onOpenInfoBlock:function(e){if(this.infoBlock="fontSet"===e.type?new b({model:e}):new g({model:e}),this.promoBlock){this.infoBlock.$el.insertAfter(this.promoBlock.$el);var t=this;this.$("#fontlistView .table").show(),this.$("#fontlistView").scrollTo(this.infoBlock.$el,{duration:"slow",onAfter:function(){t.promoBlock&&(t.promoBlock.remove(),t.promoBlock=null),t.advicerBlock&&(t.advicerBlock.remove(),t.advicerBlock=null),t.$("#fontlistView").scrollTop(0)}})}else this.$("#fontlistView").prepend(this.infoBlock.$el);this.infoBlock.invalidate()},onOpenNewsBlock:function(e){if(this.$("#fontlistView .table").hide(),this.newsBlock=new w({model:e}),this.promoBlock){this.newsBlock.$el.insertAfter(this.promoBlock.$el);var t=this;this.$("#fontlistView").scrollTo(this.newsBlock.$el,{duration:"slow",onAfter:function(){t.promoBlock&&(t.promoBlock.remove(),t.promoBlock=null),t.advicerBlock&&(t.advicerBlock.remove(),t.advicerBlock=null),t.$("#fontlistView").scrollTop(0)}})}else this.$("#fontlistView").prepend(this.newsBlock.$el);this.newsBlock.invalidate()},onCloseNews:function(){this.newsBlock&&(this.newsBlock.remove(),this.newsBlock=null),this.$("#fontlistView .table").show()}});return x}),function(e,t){var n=function(){return"object"==typeof exports?"CommonJS":"function"==typeof define&&define.amd?"AMD":"browser"}(),i=null;switch("CommonJS"===n&&(e=global),n){case"CommonJS":t(e.setTimeout,exports,require("underscore"),require("backbone"));break;case"AMD":define("lib/backbone-faux-server",["underscore","backbone","exports"],function(n,i,s){return t(e.setTimeout,s,n,i)});break;case"browser":i=t(e.setTimeout,{},_,Backbone),i.noConflict=function(){var t=e.fauxServer;return function(){return e.fauxServer=t,i.noConflict=function(){return i},i}}(),e.fauxServer=i}}(this,function(e,t,n,i){var s=function(e){for(var t=[],i=e.length-1;i>=0;i--)n.isUndefined(e[i])||(t[i]=e[i]);return t},o=i.sync,r=!0,a=null,l=function(){var e=/[\-{}\[\]+?.,\\\^$|#\s]/g,t=/\((.*?)\)/g,n=/(\(\?)?:[A-Za-z_](?:\w)+/g,i=/\*\w+/g,s=function(e,t){return t?e:"([^/]+)"};return function(o){return o=o.replace(e,"\\$&").replace(t,"(?:$1)?").replace(n,s).replace(i,"(.*?)"),new RegExp("^"+o+"$")}}(),c=function(){},d=0,u={create:"POST",read:"GET",update:"PUT","delete":"DELETE",patch:"PATCH"},h=[],p=function(e,t){var i,s,o;for(i=h.length-1;i>=0;--i)if(s=h[i],s.urlExp.test(e)){if(s.httpMethod===t)return s=n.clone(s),s.handlerParams=s.urlExp.exec(e).slice(1),s;"*"===s.httpMethod&&(o=s)}return o?(s=n.clone(o),s.handlerParams=s.urlExp.exec(e).slice(1),s):null},f=function(e,t,n){if(n.data)return n.data;if(t)return"PATCH"===e?n.attrs||t.toJSON():"POST"===e||"PUT"===e?t.toJSON():void 0},v=function(e){if(i.$&&n.isFunction(i.$.Deferred))try{var t=i.$.Deferred();return t.then(e.success,e.error),t}catch(s){}return{promise:c,resolve:function(t){e.success(t)},reject:function(t){e.error(t)}}};return i.sync=function(t,s,l){if(!r)return o.call(s,t,s,l);n.defaults(l||(l={}),{emulateHTTP:i.emulateHTTP,emulateJSON:i.emulateJSON});var c={data:null,url:null,httpMethod:u[t],route:null},h=null,m=null;if(l.emulateHTTP&&"GET"!==c.httpMethod&&(c.httpMethodOverride=c.httpMethod,c.httpMethod="POST"),!(c.url=l.url||n.result(s,"url")))throw new Error("sync: Undefined 'url' property or function of Model / Collection");return(c.route=p(c.url,c.httpMethod)||a)?(c.data=f(c.httpMethod,s,l),m=v(l,c),h=function(){var e=c.route.handler.apply(null,[c].concat(c.route.handlerParams));m[n.isString(e)?"reject":"resolve"](e)},s.trigger("request",s,null,l),d?e(h,n.isFunction(d)?d():d):h(),m.promise()):o.call(s,t,s,l)},n.extend(t,{addRoute:function(e,t,i,o){var r=h.length,a=function(s){switch(s.length){case 3:n.isFunction(s[2])?(o=s[2],"*"===s[1]||n.contains(u,s[1])?(t=s[0],i=s[1],e=null):i="*"):o=c;break;case 2:n.isFunction(s[1])?(t=s[0],o=s[1],i="*",e=null):(o=c,"*"===s[1]||n.contains(u,s[1])?(t=s[0],i=s[1],e=null):i="*");break;case 1:t=s[0],i="*",o=c,e=null;break;case 0:throw new Error("addRoute: Missing mandatory 'urlExp' argument")}return i=i.toUpperCase(),t=n.isRegExp(t)?t:l(t),{name:e||n.uniqueId(i+"_"+t+"_"),urlExp:t,httpMethod:i,handler:o}}(s(n.toArray(arguments)));return n.any(h,function(e,t){return e.name===a.name?(r=t,!0):void 0}),h[r]=a,this},addRoutes:function(e){var t=n.isArray(e);return n.each(e,function(e,n){this.addRoute(t?e.name:n,e.urlExp,e.httpMethod,e.handler)},this),this},removeRoute:function(e){return h=n.reject(h,function(t){return t.name===e}),this},removeRoutes:function(){return h=[],this},getRoute:function(e){var t=n.find(h,function(t){return t.name===e});return t?n.clone(t):null},getRouteAt:function(e){return h[e]?n.clone(h[e]):null},getMatchingRoute:p,setDefaultHandler:function(e){return a=e?{name:"",urlExp:"",handler:e,handlerParams:[]}:null,this},setLatency:function(e,t){return d=t?function(){return e+Math.random()*(t-e)}:e||0,this},setTransportFactory:function(e){return v=e,this},enable:function(e){return r=n.isUndefined(e)||e,this},getVersion:function(){return"0.10.3"}}),n.each(n.values(u),function(e){var i="DELETE"===e?"del":e.toLowerCase();t[i]=function(){var o=s(n.toArray(arguments));if(!o.length)throw new Error(i+": Missing mandatory 'urlExp' argument");return n.isFunction(o[o.length-1])?o.splice(o.length-1,0,e):o.push(e),t.addRoute.apply(this,o)}}),t}),define("server",["backbone","lib/backbone-faux-server"],function(e,t){function n(){var e=[{fontFace:"Bad Script",css:"http://fonts.googleapis.com/css?family=Bad+Script&subset=latin,cyrillic"},{fontFace:"Revalia",css:"http://fonts.googleapis.com/css?family=Revalia"},{fontFace:"Prosto One",css:"http://fonts.googleapis.com/css?family=Prosto+One&subset=latin,cyrillic"},{fontFace:"Stalinist One",css:"http://fonts.googleapis.com/css?family=Stalinist+One&subset=latin,cyrillic"},{fontFace:"Poiret One",css:"http://fonts.googleapis.com/css?family=Poiret+One&subset=latin,cyrillic"},{fontFace:"Noto Serif",css:"http://fonts.googleapis.com/css?family=Noto+Serif&subset=latin,cyrillic"},{fontFace:"Scada",css:"http://fonts.googleapis.com/css?family=Scada&subset=latin,cyrillic"},{fontFace:"Forum",css:"http://fonts.googleapis.com/css?family=Forum&subset=latin,cyrillic"},{fontFace:"Playfair Display",css:"http://fonts.googleapis.com/css?family=Playfair+Display&subset=latin,cyrillic"},{fontFace:"Marck Script",css:"http://fonts.googleapis.com/css?family=Marck+Script&subset=latin,cyrillic"},{fontFace:"Cuprum",css:"http://fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic"},{fontFace:"Tinos",css:"http://fonts.googleapis.com/css?family=Tinos&subset=latin,cyrillic"},{fontFace:"Bad Script",css:"http://fonts.googleapis.com/css?family=Bad+Script&subset=latin,cyrillic"},{fontFace:"Poiret One",css:"http://fonts.googleapis.com/css?family=Poiret+One&subset=latin,cyrillic"},{fontFace:"Noto Serif",css:"http://fonts.googleapis.com/css?family=Noto+Serif&subset=latin,cyrillic"}],t=Math.floor(Math.random()*e.length);return e[t]}t.addRoute("saveFont","/jsonFonts/font/*params","PUT",function(e){return console.log("/jsonFonts/","PUT",e),e.data}),t.addRoute("deleteFavorite","/jsonFavorite/*params","DELETE",function(e){return console.log("/jsonFavorite/","DELETE",e),e.data});var i=99;t.addRoute("createFavorite","/jsonFavorite/*params","POST",function(e){return console.log("/jsonFavorite/","POST",e.data),i+=1,e.data.id=String(i),e.data}),t.addRoute("saveFavorite","/jsonFavorite/*params","PUT",function(e){return console.log("/jsonFavorite/","PUT",e.data),e.data});var s=100;return t.addRoute("getFonts","/jsonFonts/*params","GET",function(e){var t;console.log("/jsonFonts/"+e.route.handlerParams[0]);var i=e.route.handlerParams[0].split("/");if("fullfont"===i[0])return t=n(),{id:String(++s),description:"N:"+s+" ПТ Санс Про — это развитая гарнитура широкого применения, состоящая из 32 начертаний: 12 (6 прямых + 6 курсивов) обычных пропорций; 6 узких, 6 сжатых, 6 сверхсжатых и 2 начертания расширенных пропорций. Дизайн шрифта сочетает умеренный консерватизм с современными тенденциями гуманистического гротеска и имеет улучшенный уровень удобочитаемости, особенно в расширенных начертаниях. Указанные особенности, помимо традиционного использования для деловой документации и печатных изданий различного профиля, делают его применимым для указателей, табличек, схем, экранов информационных киосков и прочих навигационных объектов городской среды. Шрифты имеют расширенный комплект кириллических и латинских знаков, что покрывает все титульные языки Российской Федерации, а также практически ",tags:["Журналы","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги"],languages:[{name:"en",label:"english",script:"latin"},{name:"ru",label:"russian",script:"cyrillic"},{name:"cn",label:"chinise",script:"ieroglific"},{name:"mg",label:"mongolian",script:"cyrillic"}],fontName:"Random font N:"+s,setName:"Random font N:"+s,fontFace:t.fontFace,css:t.css,subSets:[{id:"8485738945",name:"Black N:"+s},{id:"8485738946",name:"Bold N:"+s},{id:"8485738947",name:"Normal N:"+s}]};if("font"===i[0]&&i.length>3){for(var o="asc"===i[2]?1:-1,r=parseInt(i[3],10)*o,a=parseInt(i[1],10),l=parseInt(i[5],10),c=[],d=a+r;d!=a+o*l;d+=o)t=n(),c.push({id:String(d),description:"N:"+d+" ПТ Санс Про — это развитая гарнитура широкого применения, состоящая из 32 начертаний: 12 (6 прямых + 6 курсивов) обычных пропорций; 6 узких, 6 сжатых, 6 сверхсжатых и 2 начертания расширенных пропорций. Дизайн шрифта сочетает умеренный консерватизм с современными тенденциями гуманистического гротеска и имеет улучшенный уровень удобочитаемости, особенно в расширенных начертаниях. Указанные особенности, помимо традиционного использования для деловой документации и печатных изданий различного профиля, делают его применимым для указателей, табличек, схем, экранов информационных киосков и прочих навигационных объектов городской среды. Шрифты имеют расширенный комплект кириллических и латинских знаков, что покрывает все титульные языки Российской Федерации, а также практически ",tags:["Журналы","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги"],languages:[{name:"en",label:"english",script:"latin"},{name:"ru",label:"russian",script:"cyrillic"},{name:"cn",label:"chinise",script:"ieroglific"},{name:"mg",label:"mongolian",script:"cyrillic"}],fontName:"Random font N:"+d,setName:"Random font N:"+d,fontFace:t.fontFace,css:t.css,subSets:[{id:"8485738945",name:"Black N:"+d},{id:"8485738946",name:"Bold N:"+d},{id:"8485738947",name:"Normal N:"+d}]});return{allCount:340,fonts:c}}if("font"===i[0]){t=n();var c={id:String(++s),description:"N:"+s+" ПТ Санс Про — это развитая гарнитура широкого применения, состоящая из 32 начертаний: 12 (6 прямых + 6 курсивов) обычных пропорций; 6 узких, 6 сжатых, 6 сверхсжатых и 2 начертания расширенных пропорций. Дизайн шрифта сочетает умеренный консерватизм с современными тенденциями гуманистического гротеска и имеет улучшенный уровень удобочитаемости, особенно в расширенных начертаниях. Указанные особенности, помимо традиционного использования для деловой документации и печатных изданий различного профиля, делают его применимым для указателей, табличек, схем, экранов информационных киосков и прочих навигационных объектов городской среды. Шрифты имеют расширенный комплект кириллических и латинских знаков, что покрывает все титульные языки Российской Федерации, а также практически ",tags:["Журналы","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги"],languages:[{name:"en",label:"english",script:"latin"},{name:"ru",label:"russian",script:"cyrillic"},{name:"cn",label:"chinise",script:"ieroglific"},{name:"mg",label:"mongolian",script:"cyrillic"}],fontName:"Random font N:"+s,setName:"Random font N:"+s,fontFace:t.fontFace,css:t.css,subSets:[{id:"8485738945",name:"Black N:"+s},{id:"8485738946",name:"Bold N:"+s},{id:"8485738947",name:"Normal N:"+s}]};return c}for(var c=[],d=0;10>d;d++)t=n(),c.push({id:String(s++),description:"N:"+s+" ПТ Санс Про — это развитая гарнитура широкого применения, состоящая из 32 начертаний: 12 (6 прямых + 6 курсивов) обычных пропорций; 6 узких, 6 сжатых, 6 сверхсжатых и 2 начертания расширенных пропорций. Дизайн шрифта сочетает умеренный консерватизм с современными тенденциями гуманистического гротеска и имеет улучшенный уровень удобочитаемости, особенно в расширенных начертаниях. Указанные особенности, помимо традиционного использования для деловой документации и печатных изданий различного профиля, делают его применимым для указателей, табличек, схем, экранов информационных киосков и прочих навигационных объектов городской среды. Шрифты имеют расширенный комплект кириллических и латинских знаков, что покрывает все титульные языки Российской Федерации, а также практически ",tags:["Журналы","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги","Техдокументация","Книги"],languages:[{name:"en",label:"english",script:"latin"},{name:"ru",label:"russian",script:"cyrillic"},{name:"cn",label:"chinise",script:"ieroglific"},{name:"mg",label:"mongolian",script:"cyrillic"}],fontName:"Random font N:"+s,setName:"Random font N:"+s,fontFace:t.fontFace,css:t.css,subSets:[{id:"8485738945",name:"Black N:"+s},{id:"8485738946",name:"Bold N:"+s},{id:"8485738947",name:"Normal N:"+s}]});
return{allCount:340,fonts:c}}),t.addRoute("getGlyphs","/jsonGlyphs/*params","GET",function(e){return console.log("/jsonGlyphs/","DELETE",e),[{id:"1",title:"Basic Latin",icon:"icon-opentype_caps",codes:["0041","0042","0043","0044","0045","0046","0047","0048","0049","004A","004B","004C","004D","004E","004F","0050","0051","0052","0053","0054","0055","0056","0057","0058","0059","005A","0061","0062","0063","0064","0065","0066","0067","0068","0069","006A","006B","006C","006D","006E","006F","0070","0071","0072","0073","0074","0075","0076","0077","0078","0079","007A"]},{id:"2",title:"Cyrilic",icon:"icon-opentype_alternates",codes:["0410","0411","0412","0413","0414","0415","0416","0417","0418","0419","041A","041B","041C","041D","041E","041F","0420","0421","0422","0423","0424","0425","0426","0427","0428","0429","042A","042B","042C","042D","042E","042F"]}]}),t}),requirejs.config({baseUrl:"js",paths:{app:"./app",jasmineJQuery:"./lib/jasmine/jasmine-jquery",underscore:"./lib/underscore",nunjucks:"./lib/nunjucks",NunjucksFilters:"./lib/NunjucksFilters",backbone:"./lib/backbone/backbone","bb.domReady":"./lib/backbone/domReady","bb.text":"./lib/backbone/text","bb.InfiniScroll":"./lib/backbone/infiniScroll",jQuery:"./lib/jquery/jquery-1.11.0.min","jq.mCustomScrollbar":"./lib/jquery/jquery.mCustomScrollbar","jq.mousewheel":"./lib/jquery/jquery.mousewheel","jq.dragable":"./lib/jquery/jquery.dragable","jq.noUiSlider":"./lib/jquery/jquery.nouislider","jq.numeric":"./lib/jquery/jquery.numeric","jq.stepper":"./lib/jquery/jquery.stepper","jq.scrollTo":"./lib/jquery/jquery.scrollTo.min","gs.TweenLite":"./lib/greensock/TweenLite.min","gs.TimelineLite":"./lib/greensock/TimelineLite.min","gs.EasePack":"./lib/greensock/easing/EasePack.min","gs.CSSPlugin":"./lib/greensock/plugins/CSSPlugin.min",ZeroClipboard:"./lib/0clipboard/ZeroClipboard",tpl:"../resources/tpl"},shim:{json2:{exports:"json2"},"gs.TweenLite":{exports:"TweenLite"},"gs.CSSPlugin":{deps:["gs.TweenLite"]},jQuery:{exports:"$"},"jq.mousewheel":{deps:["jQuery"]},"jq.noUiSlider":{deps:["jQuery"]},"jq.mCustomScrollbar":{deps:["jQuery","jq.mousewheel"],exports:"$.fn.mCustomScrollbar"},"jq.dragable":{deps:["jQuery"],exports:"$.fn.dragable"},"jq.numeric":{deps:["jQuery"],exports:"$.fn.numeric"},"jq.stepper":{deps:["jQuery"],exports:"$.fn.stepper"},"jq.scrollTo":{deps:["jQuery"],exports:"$.fn.scrollTo"}}}),require(["backbone","bb.domReady","app/views/MainView","server"],function(e,t,n){t(function(){new n({el:document.getElementById("root")})})}),define("main",function(){});
//# sourceMappingURL=main.js.map